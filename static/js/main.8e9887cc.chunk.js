(window["webpackJsonpxc-live-viewer"]=window["webpackJsonpxc-live-viewer"]||[]).push([[0],{131:function(e,t,n){e.exports=n(194)},158:function(e,t,n){},189:function(e,t,n){},194:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),o=n.n(i),l=n(7),s=n(256),c=n(97),u=n.n(c),f=n(253),h=n(254),p=n(116),d=n.n(p),g=n(115),m=n.n(g),b=n(114),v=n.n(b),y=(n(158),null);var O=function(){var e=Object(a.useState)({ready:!1,error:!1}),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){null===y&&(y=new Promise((function(e,t){console.log("Loading Google Maps API ...");var n=document.createElement("script");n.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBCrP5uoEJXfEvz8f_y1HgzQnqUGHz0Aak",n.async=!0,n.addEventListener("load",(function(){return e(!0)})),n.addEventListener("error",(function(){return e(!1)})),document.body.appendChild(n)}))),y.then((function(e){e?(console.log("Google Maps API loaded."),r({ready:!0,error:!1})):(console.log("Error: Cannot load Google Maps API."),r({ready:!1,error:!0}))}))}),[]),[n.ready,n.error,n.ready?window.google:null]},E=n(228),k=n(43),w=n(231),S=n(98),P=n.n(S),_=Object(E.a)((function(e){return{progress:{margin:e.spacing(2)}}})),j=function(e){var t=e.message,n=e.hideIf,a=e.subRef,i=_();return r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center",ref:a},r.a.createElement(s.a,{textAlign:"center"},r.a.createElement(w.a,{className:i.progress}),r.a.createElement(k.a,null,t)))},C=function(e){var t=e.message,n=e.hideIf,a=_();return r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center"},r.a.createElement(s.a,{textAlign:"center"},r.a.createElement(P.a,{fontSize:"large",color:"error",className:a.progress}),r.a.createElement(k.a,{color:"error"},t)))},A=n(99),D=n(8),I=n(13),T=function e(t,n){var r=this;Object(D.a)(this,e),this.getValue=function(){var e=localStorage.getItem(r.key);r.locallyCachedJson!==e&&(r.locallyCachedJson=e,r.locallyCachedValue=JSON.parse(e));var t=r.locallyCachedValue;return null===t?r.initialValue:t},this._notifyAll=function(){var e=r.getValue(),t=!0,n=!1,a=void 0;try{for(var i,o=r.callbacks[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){(0,i.value)(e)}}catch(l){n=!0,a=l}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}},this.registerCallback=function(e){r.callbacks.includes(e)||r.callbacks.push(e)},this.unregisterCallback=function(e){var t=r.callbacks.indexOf(e);t>=0&&r.callbacks.splice(t,1)},this.setValue=function(e){null==e?localStorage.removeItem(r.key):localStorage.setItem(r.key,JSON.stringify(e)),r._notifyAll()},this.use=function(){var e=Object(a.useState)(r.getValue),t=Object(l.a)(e,2),n=t[0],i=t[1];return Object(a.useEffect)((function(){var e=function(e){i(e)};return r.registerCallback(e),function(){return r.unregisterCallback(e)}}),[]),[n,r.setValue]},this.key=t,this.initialValue=n,this.callbacks=[],this.locallyCachedJson=null,this.locallyCachedValue=null},L=function(e,t){return new T(e,t)},N={PATH_LENGTH:"PATH_LENGTH",LIMIT_PATHS:"LIMIT_PATHS",LOW_LATENCY:"LOW_LATENCY",ANIMATION_DELAY:"ANIMATION_DELAY",FPS_LIMIT:"FPS_LIMIT",FPS_RATE:"FPS_RATE",GPS_ENABLED:"GPS_ENABLED"},x=function(e,t){return L("SETTINGS_"+e,t)},F={PATH_LENGTH:x(N.PATH_LENGTH,15),LIMIT_PATHS:x(N.LIMIT_PATHS,!1),LOW_LATENCY:x(N.LOW_LATENCY,!1),ANIMATION_DELAY:x(N.ANIMATION_DELAY,80),FPS_LIMIT:x(N.FPS_LIMIT,!0),FPS_RATE:x(N.FPS_RATE,10),GPS_ENABLED:x(N.GPS_ENABLED,!0)},M=function(e){return F[e]},V=function(){function e(t,n,a,r){var i=this;Object(D.a)(this,e),this.formatSubscribedFlights=function(){return i.subscribedFlights.map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];return{flightUuid:n,start:null===a?null:new Date(1e3*a).toISOString()}}))},this.refreshSubscribedFlights=function(){if(i.sock.readyState===WebSocket.OPEN&&i.connected){var e=i.formatSubscribedFlights();i.sock.send(JSON.stringify({tag:"WebFollow",contents:e}))}},this.setSubscribedFlights=function(e){i.subscribedFlights=e,i.refreshSubscribedFlights()},this.onOpen=function(){i.handleReset(),console.debug("WebSocket: Open!"),i.setConnectionState(ue.ESTABLISHED),i.connected=!0,i.sock.send(JSON.stringify({tag:"WebFilterArea",area:[{lat:-90,lon:-180},{lat:90,lon:180}]})),i.sock.send(JSON.stringify({tag:"WebFilterContest",contents:"alpha9999"}));var e=i.formatSubscribedFlights();i.sock.send(JSON.stringify({tag:"WebFollow",contents:e}))},this.onMessage=function(e){console.debug("WebSocket: Message!"),i.setConnectionState(ue.ACTIVE);var t=JSON.parse(e.data);clearTimeout(i.watchdog),i.watchdog=setTimeout((function(){i.setConnectionState(ue.INACTIVE)}),7e4),i.processMessage(t)},this.onClose=function(e){i.connected=!1,console.debug("WebSocket: Close!"),i.setConnectionState(ue.NO_CONNECTION),setTimeout(i.connect.bind(i),1e3)},this.onError=function(e){i.connected=!1,console.debug("WebSocket: Error!")},this.handleReset=function(){console.log("TODO: handle reset!")},this.processMessage=function(e){if("tag"in e)switch(e.tag){case"LiveFlightInfos":i.dispatchInfoMessage(e.contents);break;case"LiveFlightChunk":i.dispatchTracklogMessage(e);break;case"LiveFlightLanded":i.dispatchFlightLandedMessage(e.flightUuid);break;default:console.warn("Warning: Unknown message tag '".concat(e.tag,"'!"),e)}else console.warn("Warning: Invalid message format!",e)},this.setConnectionState=t,this.dispatchInfoMessage=n,this.dispatchTracklogMessage=a,this.dispatchFlightLandedMessage=r,this.subscribedFlights=[],this.connect(),this.connected=!1,M(N.PATH_LENGTH).registerCallback(this.refreshSubscribedFlights),M(N.LIMIT_PATHS).registerCallback(this.refreshSubscribedFlights)}return Object(I.a)(e,[{key:"connect",value:function(){"WebSocket"in window?(this.connected=!1,this.setConnectionState(ue.CONNECTING),this.sock=new WebSocket("wss://live.xcontest.org/websock/webclient"),this.sock.onopen=this.onOpen,this.sock.onmessage=this.onMessage,this.sock.onclose=this.onClose,this.sock.onerror=this.onError):(this.setConnectionState(ue.ERROR),alert("WebSocket NOT supported by your Browser!"))}}]),e}(),R=n(9);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=L("chosen-pilots",{});function z(){return H.getValue()}function U(e){return console.log("Selected pilots updated: ",e),H.setValue(e)}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e&&(e=W({},z()));var t=pe().getPilotInfos(),n=!1;for(var a in e)if(a in t){var r=t[a].info.user.fullname;r!==e[a]&&(e[a]=r,n=!0)}n&&U(e)}var Y=function(e){var t=W({},z()),n=!1,a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;s in t||(t[s]=null,n=!0)}}catch(c){r=!0,i=c}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}n&&B(t)},J=function(e){var t=W({},z()),n=!1,a=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;s in t&&(delete t[s],n=!0)}}catch(c){r=!0,i=c}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}n&&U(t)};var q=function(e,t,n){return null===t?e:null===e?t:(1-n)*e+n*t},Z=function(e,t,n,a,r,i,o,l,s){i-=t,l-=t;var c=((n-e)*(s-=t)+e*(a-=t)-n*(t=0))/(a-t),u=((r-n)*s+n*i-r*a)/(i-a),f=((o-r)*s+r*l-o*i)/(l-i),h=((u-c)*s+c*i-u*t)/(i-t),p=((f-u)*s+u*l-f*a)/(l-a);return((p-h)*s+h*i-p*a)/(i-a)},X=function(e,t,n,a,r,i,o,l,s){i-=t,l-=t;var c=((n-e)*(s-=t)+e*(a-=t)-n*(t=0))/(a-t),u=((r-n)*s+n*i-r*a)/(i-a),f=((o-r)*s+r*l-o*i)/(l-i),h=(n-e)/(a-t),p=(r-n)/(i-a),d=(o-r)/(l-i),g=(p*s+u-h*s-c+h*i-p*t)/(i-t),m=(d*s+f-p*s-u+p*l-d*a)/(l-a);return(m*s+((f-u)*s+u*l-f*a)/(l-a)-g*s-((u-c)*s+c*i-u*t)/(i-t)+g*i-m*a)/(i-a)},K=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return t-e},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return null===e};Object(D.a)(this,e),this.computeDiff=n,this.isInvalid=a,this.old_val=null,this.old_t=null,this.running_avg=null,this.smoothingFactor=t}return Object(I.a)(e,[{key:"update",value:function(e,t){if(null===this.old_val||null===e||null===this.old_t||null===t||this.isInvalid(this.old_val)||this.isInvalid(e)||this.old_t===this.new_t)return this.old_val=e,this.old_t=t,null;var n=t-this.old_t,a=this.computeDiff(this.old_val,e)/n,r=Math.pow(this.smoothingFactor,n);return null===this.running_avg?this.running_avg=a:this.running_avg=r*this.running_avg+(1-r)*a,this.old_val=e,this.old_t=t,this.running_avg}},{key:"reset",value:function(){this.old_val=null,this.old_t=null,this.running_avg=null}}]),e}(),Q=n(34),$=function(e,t,n){if(t<1)return 0;for(var a=-1,r=t,i=0;a<r-1;)n(i=(a+r)/2|0)<e?a=i:r=i;return r},ee=function(e){return Math.round(Date.parse(e)/1e3)},te=function(){function e(){var t=this;Object(D.a)(this,e),this.at=function(e){return t.data[e]},this.findBisect=function(e){return $(e,t.data.length,(function(e){return t.data[e].t}))},this.findForwardSwipe=function(e,n){for(var a=n;a<t.data.length&&t.data[a].t<e;)a+=1;return a},this.getNewestTimestamp=function(){return t.data.length<1?null:t.data[t.data.length-1].t},this.data=[],this.counter_gpsVario=new K(.7),this.counter_baroVarion=new K(.7),this.counter_velocity=new K(.7,(function(e,t){return Object(Q.getDistance)(e,t,.01)}),(function(){return!1}))}return Object(I.a)(e,[{key:"clear",value:function(){this.data=[],this.counter_gpsVario=new K(.7),this.counter_baroVarion=new K(.7),this.counter_velocity=new K(.7,(function(e,t){return Object(Q.getDistance)(e,t,.01)}),(function(){return!1}))}},{key:"isAfterLastElement",value:function(e){return this.data.length<=0||this.data[this.data.length-1].t<e}},{key:"append",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,l=ee(o.timestamp),s={lat:o.lat,lng:o.lon},c=0===o.baroAlt?null:o.baroAlt,u=0===o.gpsAlt?null:o.gpsAlt,f=this.counter_gpsVario.update(u,l),h=this.counter_baroVarion.update(c,l),p=this.counter_velocity.update(s,l),d={baroAlt:c,gpsAlt:u,elevation:o.elevation,pos:s,gpsVario:f,baroVario:h,velocity:p,t:l};this.data.push(d)}}catch(g){n=!0,a=g}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}},{key:"replace",value:function(e){this.clear(),this.append(e)}},{key:"insert",value:function(e){var t=[],n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value,s=ee(l.timestamp),c={lat:l.lat,lng:l.lon},u={baroAlt:0===l.baroAlt?null:l.baroAlt,gpsAlt:0===l.gpsAlt?null:l.gpsAlt,elevation:l.elevation,pos:c,gpsVario:null,baroVario:null,velocity:null,t:s};t.push(u)}}catch(P){a=!0,r=P}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}var f=this.data;this.data=[];for(var h=0,p=0;!(h>=f.length&&p>=t.length);)if(h>=f.length)this.data.push(t[p]),p+=1;else if(p>=t.length)this.data.push(f[h]),h+=1;else{var d=f[h],g=t[p];g.t<d.t?(this.data.push(g),p+=1):d.t<g.t?(this.data.push(d),h+=1):(this.data.push(g),h+=1,p+=1)}this.counter_gpsVario.reset(),this.counter_baroVarion.reset(),this.counter_velocity.reset();var m=!0,b=!1,v=void 0;try{for(var y,O=this.data[Symbol.iterator]();!(m=(y=O.next()).done);m=!0){var E=y.value,k=this.counter_gpsVario.update(E.gpsAlt,E.t),w=this.counter_baroVarion.update(E.baroAlt,E.t),S=this.counter_velocity.update(E.pos,E.t);E.gpsVario=k,E.baroVario=w,E.velocity=S}}catch(P){b=!0,v=P}finally{try{m||null==O.return||O.return()}finally{if(b)throw v}}}},{key:"length",get:function(){return this.data.length}}]),e}();function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=function e(){var t=this;Object(D.a)(this,e),this.reset=function(){t.currentArrayPos=null,t.mapsPath=[],t.mapsPathNewestPos=0},this.currentArrayPos=null,this.mapsPath=[],this.mapsPathNewestPos=0},ie=function(){function e(){Object(D.a)(this,e)}return Object(I.a)(e,null,[{key:"takeData",value:function(e){return{baroAlt:e.baroAlt,gpsAlt:e.gpsAlt,elevation:e.elevation,pos:{lat:e.pos.lat,lng:e.pos.lng},gpsVario:e.gpsVario,baroVario:e.baroVario,velocity:e.velocity}}},{key:"blendData",value:function(e,t,n){var a=(n-e.t)/(t.t-e.t);return{baroAlt:q(e.baroAlt,t.baroAlt,a),gpsAlt:q(e.gpsAlt,t.gpsAlt,a),elevation:q(e.elevation,t.elevation,a),pos:{lat:q(e.pos.lat,t.pos.lat,a),lng:q(e.pos.lng,t.pos.lng,a)},gpsVario:q(e.gpsVario,t.gpsVario,a),baroVario:q(e.baroVario,t.baroVario,a),velocity:q(e.velocity,t.velocity,a)}}},{key:"blendDataSpline",value:function(e,t,n,a,r){var i=(r-t.t)/(n.t-t.t);return{baroAlt:q(t.baroAlt,n.baroAlt,i),gpsAlt:q(t.gpsAlt,n.gpsAlt,i),elevation:q(t.elevation,n.elevation,i),pos:{lat:Z(e.pos.lat,e.t,t.pos.lat,t.t,n.pos.lat,n.t,a.pos.lat,a.t,r),lng:Z(e.pos.lng,e.t,t.pos.lng,t.t,n.pos.lng,n.t,a.pos.lng,a.t,r)},gpsVario:q(t.gpsVario,n.gpsVario,i),baroVario:q(t.baroVario,n.baroVario,i),velocity:q(t.velocity,n.velocity,i)}}},{key:"computeLinearVelocity",value:function(e,t){var n=e.t,a=t.t;if(n===a)return null;var r=a-n,i=e.pos,o=t.pos;return{lat:(o.lat-i.lat)/r,lng:(o.lng-i.lng)/r}}},{key:"computeSplineVelocity",value:function(e,t,n,a,r){var i=e.t,o=t.t,l=n.t,s=a.t,c=e.pos,u=t.pos,f=n.pos,h=a.pos;return{lat:X(c.lat,i,u.lat,o,f.lat,l,h.lat,s,r),lng:X(c.lng,i,u.lng,o,f.lng,l,h.lng,s,r)}}}]),e}();ie.fallbackData=function(e){return{baroAlt:e.lastFix.baroAlt,gpsAlt:e.lastFix.gpsAlt,elevation:e.lastFix.elevation,pos:{lat:e.lastFix.lat,lng:e.lastFix.lon},gpsVario:null,baroVario:null,velocity:null}};var oe=function e(t){var n=this;Object(D.a)(this,e),this.destroy=function(){M(N.ANIMATION_DELAY).unregisterCallback(n.updateSettings),M(N.LOW_LATENCY).unregisterCallback(n.updateSettings),M(N.PATH_LENGTH).unregisterCallback(n.updateSettings),M(N.LIMIT_PATHS).unregisterCallback(n.updateSettings)},this.updateSettings=function(){n.settings={timeOffsetSeconds:M(N.ANIMATION_DELAY).getValue(),lowLatencyMode:M(N.LOW_LATENCY).getValue(),trackLengthMinutes:M(N.PATH_LENGTH).getValue(),limitTracks:M(N.LIMIT_PATHS).getValue()},n.liveDataCache.reset(),n.flightInfoDataCache.reset()},this.updateInfos=function(e){n.landed|=e.landed,n.flightInfos=e,n.flightInfoData.replace(e.track),n.flightInfoDataCache.reset()},this.updateData=function(e){if(!(e.length<1)){var t=ee(e[0].timestamp);n.liveData.isAfterLastElement(t)?n.liveData.append(e):(n.liveData.insert(e),n.liveDataCache.reset())}},this.updateLanded=function(){console.log("Received flight landed message!"),n.landed=!0},this.getInterpolatedData=function(e,t,n){if(e.length<1)return null;null===t.currentArrayPos?t.currentArrayPos=e.findBisect(n):t.currentArrayPos=e.findForwardSwipe(n,t.currentArrayPos);var a=null,r=!1,i=!1,o=null;if(t.currentArrayPos<=0)a=ie.takeData(e.at(0)),e.length>=2&&(o=ie.computeLinearVelocity(e.at(0),e.at(1))),i=!0;else if(t.currentArrayPos>=e.length)a=ie.takeData(e.at(e.length-1)),e.length>=2&&(o=ie.computeLinearVelocity(e.at(e.length-2),e.at(e.length-1))),r=!0;else{var l=e.at(t.currentArrayPos-1),s=e.at(t.currentArrayPos),c=t.currentArrayPos-2>=0?e.at(t.currentArrayPos-2):ae({},l,{t:l.t-1}),u=t.currentArrayPos+1<e.length?e.at(t.currentArrayPos+1):ae({},s,{t:s.t+1});a=ie.blendDataSpline(c,l,s,u,n),o=ie.computeSplineVelocity(c,l,s,u,n)}return[a,i,r,e.at(e.length-1).t,o]},this.getFallbackData=function(){return[ie.fallbackData(n.flightInfos),!1,n.flightInfos.landed,ee(n.flightInfos.lastFix.timestamp),null]},this.computeTrack=function(e,t,a){if(e.length<1)return null;for(var r=a-60*n.settings.trackLengthMinutes,i=t.mapsPath;t.mapsPathNewestPos<e.length&&e.at(t.mapsPathNewestPos).t<a;){var o=e.at(t.mapsPathNewestPos);i.push({lat:o.pos.lat,lng:o.pos.lng,timestamp:o.t,elevation:o.gpsAlt}),t.mapsPathNewestPos+=1}if(n.settings.limitTracks){for(var l=0;l+32-1<i.length&&i[l+32-1].timestamp<r;)l+=32;l>0&&(i=i.slice(l),t.mapsPath=i)}return i},this.updateAnimation=function(e){var t=n.settings.lowLatencyMode?e/1e3:e/1e3-n.settings.timeOffsetSeconds,a=n.getInterpolatedData(n.liveData,n.liveDataCache,t);a||(a=n.getInterpolatedData(n.flightInfoData,n.flightInfoDataCache,t)),a||(a=n.getFallbackData());var r=n.computeTrack(n.liveData,n.liveDataCache,t);r||(r=n.computeTrack(n.flightInfoData,n.flightInfoDataCache,t)),r||(r=[]);var i=a,o=Object(l.a)(i,5),s=o[0],c=o[1],u=o[2],f=o[3],h=o[4];return n.settings.lowLatencyMode&&(u=!!n.landed||f<t-80),ae({},s,{startOfTrack:c,endOfTrack:u,landed:n.landed,newestDataTimestamp:f,track:r,velocityVec:h})},this.getNewestTimestamp=function(){return n.liveData.getNewestTimestamp()},this.liveData=new te,this.liveDataCache=new re,this.flightInfos=null,this.flightInfoData=new te,this.flightInfoDataCache=new re,this.landed=t.landed,this.updateInfos(t),this.settings={},this.updateSettings(),M(N.ANIMATION_DELAY).registerCallback(this.updateSettings),M(N.LOW_LATENCY).registerCallback(this.updateSettings),M(N.PATH_LENGTH).registerCallback(this.updateSettings),M(N.LIMIT_PATHS).registerCallback(this.updateSettings)},le=function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;Object(D.a)(this,e),this.get=function(e,n){var a=e+t.offset,r=a-n;return(r>t.tolerance||r<-t.tolerance)&&(t.offset-=r,a=e+t.offset),a},this.offset=0,this.tolerance=n};var se=function e(t){var n=this;Object(D.a)(this,e),this._nextUpdate=Date.now(),this.animationLoop=function(){var e=Date.now(),t=1e3/n._setting_fps;if(!n._setting_limitFps||e>=n._nextUpdate){n._setting_limitFps&&(n._nextUpdate+=t,e>n._nextUpdate&&(n._nextUpdate=e));var a={};Object.keys(n._subscribedPilots).forEach((function(t){if(t in n._pilotInfos){var r=n._pilotInfos[t].flightId;if(r in n._flightAnimations){var i=n._flightAnimations[r];a[t]=i.updateAnimation(e)}}})),n._submitAnimationFrame(a)}requestAnimationFrame(n.animationLoop)},this._submitAnimationFrame=function(e){n._currentAnimationData=e;var t=!0,a=!1,r=void 0;try{for(var i,o=n._callbacks[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){(0,i.value)(e)}}catch(l){a=!0,r=l}finally{try{t||null==o.return||o.return()}finally{if(a)throw r}}},this.setSubscribedPilots=function(e){n._subscribedPilots=e,n._updateImportantFlights()},this.pushNewInfo=function(e){console.log("newInfo: ",e),n._pilotInfos=e,n._updateImportantFlights(),Object.values(e).forEach((function(e){var t=e.flightId;t in n._flightAnimations&&n._flightAnimations[t].updateInfos(e)}))},this.pushNewData=function(e,t){console.log("newTrackdata: ",e,t),e in n._flightAnimations&&n._flightAnimations[e].updateData(t)},this.pushFlightLanded=function(e){e in n._flightAnimations&&n._flightAnimations[e].updateLanded()},this.registerCallback=function(e){n._callbacks.includes(e)||n._callbacks.push(e),e(n._currentAnimationData)},this.unregisterCallback=function(e){var t=n._callbacks.indexOf(e);t>=0&&n._callbacks.splice(t,1)},this.getData=function(){return n._currentAnimationData},this._updateImportantFlights=function(){var e={};Object.values(n._pilotInfos).filter((function(e){return e.info.user.username in n._subscribedPilots})).forEach((function(t){e[t.flightId]=t}));var t=new Set(Object.keys(e)),a=[];for(var r in n._flightAnimations)r in e||a.push(r);for(var i=0,o=a;i<o.length;i++){var s=o[i];console.log("Removing flightAnimation of '"+s+"' ..."),n._flightAnimations[s].destroy(),delete n._flightAnimations[s]}if(Object.entries(e).forEach((function(e){var t=Object(l.a)(e,2),a=t[0],r=t[1];a in n._flightAnimations||(n._flightAnimations[a]=new oe(r))})),!function(e,t){if(e.size!==t.size)return!1;var n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value;if(!t.has(l))return!1}}catch(s){a=!0,r=s}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return!0}(t,n._subscribedFlights)){n._subscribedFlights=t;var c=[];console.log(n._flightAnimations),t.forEach((function(e){console.log(e,n._flightAnimations[e]),c.push([e,n._flightAnimations[e].getNewestTimestamp()])})),console.log("Changing flight subscribtion: ",n._subscribedFlights,t),n._setSubscribedFlightsCallback(c)}},this._currentAnimationData={},this._callbacks=[],this._subscribedPilots=z(),this._subscribedFlights=new Set,this._pilotInfos={},this._flightAnimations={},this._highPrecisionTimeSync=new le;var a=M(N.FPS_LIMIT),r=M(N.FPS_RATE);this._setting_limitFps=a.getValue(),this._setting_fps=r.getValue(),a.registerCallback((function(e){n._setting_limitFps=e})),r.registerCallback((function(e){n._setting_fps=e})),this._setSubscribedFlightsCallback=function(e){t(Array.from(e))},H.registerCallback(this.setSubscribedPilots),requestAnimationFrame(this.animationLoop)},ce=function e(t){var n=this;Object(D.a)(this,e),this.set=function(e){n._callbackData=e;var t=!0,a=!1,r=void 0;try{for(var i,o=n._callbacks[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){(0,i.value)(e)}}catch(l){a=!0,r=l}finally{try{t||null==o.return||o.return()}finally{if(a)throw r}}},this.getValue=function(){return n._callbackData},this.registerCallback=function(e){n._callbacks.includes(e)||n._callbacks.push(e)},this.unregisterCallback=function(e){var t=n._callbacks.indexOf(e);t>=0&&n._callbacks.splice(t,1)},this.use=function(){var e=Object(a.useState)(n._callbackData),t=Object(l.a)(e,2),r=t[0],i=t[1];return Object(a.useEffect)((function(){return n.registerCallback(i),function(){return n.unregisterCallback(i)}}),[]),r},this._callbacks=[],this._callbackData=t},ue={CONNECTING:"connecting",ERROR:"error",ESTABLISHED:"established",ACTIVE:"active",INACTIVE:"inactive",NO_CONNECTION:"no connection",NO_INFORMATION:"no information"},fe=function e(){var t=this;Object(D.a)(this,e),this.setSubscribedFlights=function(e){t.socket.setSubscribedFlights(e)},this.getPilotInfos=function(){return t.pilots},this.onConnectionStateChanged=function(e){t.connectionState.set(e)},this.onInfoMessageReceived=function(e){t.pilots={};var n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,c=Object(l.a)(s,2),u=c[0],f=c[1];f.overriden||(f.flightId=u,t.pilots[f.info.user.username]=f)}}catch(h){a=!0,r=h}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}t.animation.pushNewInfo(t.pilots),t.pilotInfos.set(t.pilots),B()},this.onTracklogMessageReceived=function(e){t.animation.pushNewData(e.flightUuid,e.trackChunk)},this.onFlightLandedMessageReceived=function(e){t.animation.pushFlightLanded(e)},this.pilots=[],this.connectionState=new ce(ue.NO_INFORMATION),this.pilotInfos=new ce([]),this.socket=new V(this.onConnectionStateChanged,this.onInfoMessageReceived,this.onTracklogMessageReceived,this.onFlightLandedMessageReceived),this.animation=new se(this.setSubscribedFlights)},he=null,pe=function(){return he||(he=new fe),he};function de(e){var t,n,a,r,i=function(e){for(var t=0,n=1779033703^e.length;t<e.length;t++)n=(n=Math.imul(n^e.charCodeAt(t),3432918353))<<13|n>>>19;return function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}}(e);return t=i(),n=i(),a=i(),r=i(),function(){var e=(t>>>=0)+(n>>>=0)|0;return t=n^n>>>9,n=(a>>>=0)+(a<<3)|0,a=(a=a<<21|a>>>11)+(e=e+(r=1+(r>>>=0)|0)|0)|0,(e>>>0)/4294967296}}var ge=n(100),me=n.n(ge);function be(e,t){var n=de(e),a=Math.min(Math.max(360*n(),0),360);return"#"+me.a.hsl.hex(a,100,t)}var ve=function e(t,n,a,r){var i=this;Object(D.a)(this,e),this.setMap=function(e){i.marker.setMap(e),i.track.setMap(e),i.newestTrackSegment.setMap(e)},this._updateTrack=function(e){if(e&&!(e.length<1)){var t=e.length,n=e[0].timestamp,a=e[t-1].timestamp;n===i.currentTrackVersion.startTime&&a===i.currentTrackVersion.endTime&&t===i.currentTrackVersion.length||(i.currentTrackVersion.startTime=n,i.currentTrackVersion.endTime=a,i.currentTrackVersion.length=t,i.track.setPath(e))}},this.updateData=function(e){i.marker.setPosition(e.pos),i.marker.setIcon(function(e,t,n,a,r,i,o){if(n)return a?{path:"m 12.66,19.78 6.46,-4.61 C 19.67,14.78 20,14.15 20,13.48 20,11.77 18.08,10.79 16.7,11.77 L 12,15.12 7.3,11.77 c -1.38,-0.99 -3.3,0 -3.3,1.71 0,0.67 0.33,1.31 0.88,1.7 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z m 0,-8 6.46,-4.6 C 19.67,6.78 20,6.15 20,5.48 20,3.77 18.08,2.78 16.7,3.77 L 12,7.12 7.3,3.77 C 5.92,2.78 4,3.77 4,5.48 4,6.15 4.33,6.79 4.88,7.18 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z",fillColor:o,fillOpacity:1,anchor:new e.maps.Point(12,20),strokeWeight:1,scale:1.2}:{path:"M 12.747,2 C 12.492,1.998 12.234,2.006 11.973,2.023 8.105,2.256 6.071,4.458 5.904,8.427 H 9.806 C 9.839,7.06 10.64,6.025 12.041,5.859 c 1.401,-0.133 2.735,0.2 3.135,1.134 0.434,1.034 -0.534,2.234 -1.001,2.734 -0.867,0.934 -2.268,1.634 -3.002,2.635 -0.7,1.001 -0.834,2.302 -0.901,3.902 h 3.435 c 0.033,-1.034 0.1,-2.001 0.567,-2.635 0.767,-1.034 1.901,-1.501 2.835,-2.335 0.9,-0.767 1.868,-1.701 2.001,-3.168 C 19.642,4.093 16.568,2.023 12.747,2 Z M 12.074,17.731 A 2.168,2.134 0 0 0 9.906,19.865 2.168,2.134 0 0 0 12.074,22 2.168,2.134 0 0 0 14.242,19.865 2.168,2.134 0 0 0 12.074,17.731 Z",fillColor:o,fillOpacity:1,anchor:new e.maps.Point(12,12),strokeWeight:1,scale:1.2};if(t)return{path:"M 12,2 C 8.13,2 5,5.13 5,9 c 0,5.25 7,13 7,13 0,0 7,-7.75 7,-13 0,-3.87 -3.13,-7 -7,-7",fillColor:o,fillOpacity:1,anchor:new e.maps.Point(12,22),strokeWeight:1,scale:1.2};var l=null===i?0:Object(Q.getRhumbLineBearing)(r,{lat:r.lat+i.lat,lng:r.lng+i.lng});return{path:"M12.93 4.26l6.15 14.99c.34.83-.51 1.66-1.33 1.29l-5.34-2.36c-.26-.11-.55-.11-.81 0l-5.34 2.36c-.82.36-1.67-.46-1.33-1.29l6.15-14.99c.33-.83 1.51-.83 1.85 0z",fillColor:o,fillOpacity:1,anchor:new e.maps.Point(12,12),strokeWeight:1,scale:1.2,rotation:l}}(i.google,e.startOfTrack,e.endOfTrack,e.landed,e.pos,e.velocityVec,i.pilotColor)),e.track.length>0&&i.newestTrackSegment.setPath([e.track[e.track.length-1],e.pos]),i._updateTrack(e.track)},this.google=t,this.pilotColor=be(a.info.user.username,70),this.trackColor=be(a.info.user.username,40),this.marker=new this.google.maps.Marker({map:n,position:r.pos,title:a.info.user.fullname}),this.track=new this.google.maps.Polyline({map:n,path:[],strokeColor:this.trackColor}),this.currentTrackVersion={startTime:null,endTime:null,length:null},this.newestTrackSegment=new this.google.maps.Polyline({map:n,path:[],strokeColor:this.trackColor})},ye=function e(t,n){var a=this;Object(D.a)(this,e),this.cleanupOldTracks=function(e){var t=[];for(var n in a.tracks)n in e||t.push(n);for(var r=0,i=t;r<i.length;r++){var o=i[r];a.tracks[o].setMap(null),delete a.tracks[o]}},this.update=function(e){var t=pe().getPilotInfos();a.cleanupOldTracks(e),Object.entries(e).forEach((function(e){var n=Object(l.a)(e,2),r=n[0],i=n[1];if(r in t){var o=t[r];r in a.tracks||(a.tracks[r]=new ve(a.google,a.map,o,i)),a.tracks[r].updateData(i)}}))},this.map=t,this.google=n,this.tracks={}},Oe=n(117),Ee=Object(Oe.a)((function(){var e=O(),t=Object(l.a)(e,3),n=t[0],i=t[1],o=t[2],c=Object(a.useRef)(),u=Object(a.useState)(null),f=Object(l.a)(u,2),h=f[0],p=f[1];return Object(a.useLayoutEffect)((function(){n&&!h&&p(new o.maps.Map(c.current,{center:{lat:46.509012,lng:11.827984},mapTypeId:"terrain",zoom:12,maxZoom:15,disableDefaultUI:!0,scaleControl:!0,fullscreenControl:!0,styles:A}))}),[n,h,o,c]),Object(a.useEffect)((function(){if(h&&o){var e=new ye(h,o).update;return pe().animation.registerCallback(e),function(){pe().animation.unregisterCallback(e)}}}),[h,o]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"block":"none",ref:c}),r.a.createElement(j,{message:"Loading Maps ...",hideIf:n||i}),r.a.createElement(C,{message:"Unable to load map!",hideIf:!i}))})),ke=n(24),we=n(25),Se=n(26),Pe=n(241),_e=n(105),je=n.n(_e),Ce=n(17),Ae=n(233),De=n(234),Ie=n(14),Te=n(255),Le=n(236),Ne=n(237),xe=n(232),Fe=[];window.addEventListener("popstate",(function(){0===Fe.length&&console.warn("History was already 0!");var e=Fe.pop();console.debug("- History size:",Fe.length),Fe.length>0&&window.history.pushState({},""),e&&e()}));var Me=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),i=n[0],o=n[1],s=Object(a.useState)(!1),c=Object(l.a)(s,2),u=c[0],f=c[1],h={push:function(e){var t=Fe.length;Fe.push(e),console.debug("+ History size:",Fe.length),0===t&&window.history.pushState({},"")},pop:function(){window.history.back()}};return e.open&&!i&&(u?e.onClose():(h.push((function(){o(!1),e.onClose()})),o(!0),f(!0))),!u||i||e.open||f(!1),i&&!e.open&&h.pop(),r.a.createElement(xe.a,{open:i,onClose:function(){e.onClose()},fullScreen:e.fullScreen,maxWidth:e.maxWidth,fullWidth:e.fullWidth,classes:e.classes},e.children)};var Ve=function e(){var t=this;Object(D.a)(this,e),this._updateGPSState=function(){var e=M(N.GPS_ENABLED).getValue(),n=t._callbacks.length>0,a=e&&n;null===t._watchId&&a&&navigator.geolocation&&(t._watchId=navigator.geolocation.watchPosition(t._onNewGPSData,t._onGPSError,{enableHighAccuracy:!0}),console.log("GPS: On")),null===t._watchId||a||(navigator.geolocation.clearWatch(t._watchId),t._watchId=null,t._setGPSData(null),console.log("GPS: Off"))},this._setGPSData=function(e){console.log("GPS DATA:",e),t._gpsData=e;var n=!0,a=!1,r=void 0;try{for(var i,o=t._callbacks[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(e)}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}},this._onNewGPSData=function(e){t._setGPSData(e)},this._onGPSError=function(){t._setGPSData(null)},this.registerCallback=function(e){t._callbacks.includes(e)||t._callbacks.push(e),t._updateGPSState(),e(t._gpsData)},this.unregisterCallback=function(e){var n=t._callbacks.indexOf(e);n>=0&&t._callbacks.splice(n,1),t._updateGPSState()},this.getData=function(){return t._gpsData},this._callbacks=[],this._watchId=null,this._gpsData=null,M(N.GPS_ENABLED).registerCallback(this._updateGPSState),this._updateGPSState()},Re=null,Ge=function(){return Re||(Re=new Ve),Re},We=n(258);function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue=function(e){var t=e.timestamp,n=e.landed,a=e.relative;if(null==t)return r.a.createElement("span",null,"never");var i=Date.parse(t)-Date.now(),o="";return o=a?function(e){var t="";e<0&&(e=-e,t="-");var n=Math.floor(e/1e3);if(n<60)return t+n+" sec";var a=Math.floor(n/60);if(a<60)return t+a+" min";var r=Math.floor(a/60);if(a-=60*r,r<24)return t+r+":"+a.toString().padStart(2,"0")+" h";var i=Math.floor(r/24);return t+i+"d "+(r-=24*i)+":"+a.toString().padStart(2,"0")+" h"}(i):function(e){return new Date(e).toLocaleTimeString()}(t),n?r.a.createElement("span",{style:{color:"#346B8F"}},"\u2714 ",o):-i<12e4?a?r.a.createElement("span",{style:{color:"green"}},r.a.createElement("span",{role:"img","aria-hidden":!0},"\u26ab")," ","LIVE"):r.a.createElement("span",{style:{color:"green"}},r.a.createElement("span",{role:"img","aria-hidden":!0},"\u26ab")," ",o):a?r.a.createElement("span",{style:{color:"red"}},"! LIVE (",o,")"):r.a.createElement("span",{style:{color:"red"}},"! ",o)},Be=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(ke.a)(this,Object(we.a)(t).call(this,e))).onNewGPSDataReceived=function(e){n.gpsData=e,n.updateThroughRef()},n.updateThroughRef=function(){if(n.arrowRef.current){var e=t.getArrowRotationStyle(n.gpsData,n.props.lastFix);Object.assign(n.arrowRef.current.style,e)}n.distanceRef.current&&(n.distanceRef.current.innerHTML=t.getDistance(n.gpsData,n.props.lastFix))},n.gpsData=Ge().getData(),n.state={},n.distanceRef=r.a.createRef(),n.arrowRef=r.a.createRef(),n}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){Ge().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function(){Ge().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement("span",{ref:this.distanceRef},t.getDistance(this.gpsData,this.props.lastFix))," ",r.a.createElement("div",{ref:this.arrowRef,style:ze({display:"inline-block"},t.getArrowRotationStyle(this.gpsData,this.props.lastFix))},"\u2191"))}}],[{key:"getDistance",value:function(e,t){if(null===e||null===t)return"--km";var n=Object(Q.getDistance)({lat:e.coords.latitude,lng:e.coords.longitude},t);return(Math.round(n/100)/10).toString()+"km"}},{key:"getArrowRotationStyle",value:function(e,t){if(null===e||null===t)return{};var n="rotate("+Object(Q.getRhumbLineBearing)({lat:e.coords.latitude,lng:e.coords.longitude},t).toString()+"deg)";return{transform:n,WebkitTransform:n,MozTransform:n,msTransform:n,OTransform:n}}}]),t}(a.Component);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=function(){return r.a.createElement(We.a,{component:"div",variant:"head",className:"MuiTableCell-stickyHeader",style:{height:37,display:"flex",alignItems:"center",boxSizing:"border-box"}},r.a.createElement("div",{style:{flex:"1"}},"Name"),r.a.createElement("div",{style:{width:"25%",textAlign:"right"}},"State"),r.a.createElement("div",{style:{width:"27%",textAlign:"right"}},"Country"))},Ze=function(e){function t(){return Object(D.a)(this,t),Object(ke.a)(this,Object(we.a)(t).apply(this,arguments))}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.fullname,n=e.username,a=e.lastFix,i=e.timestamp,o=e.landed,l=e.iso,c=e.disabled;return r.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",boxSizing:"border-box",filter:c?"grayscale(100%) opacity(30%)":void 0}},r.a.createElement(s.a,{flex:"1",paddingLeft:1,paddingTop:1,paddingBottom:1},r.a.createElement(k.a,{variant:"body2"},t),r.a.createElement(k.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"[",n,"]")),r.a.createElement("div",{style:{width:"25%",textAlign:"right"}},r.a.createElement(s.a,null,r.a.createElement(k.a,{variant:"caption"},r.a.createElement(Ue,{timestamp:i,landed:o,relative:!0}))),r.a.createElement(s.a,null,r.a.createElement(k.a,{variant:"caption"},r.a.createElement(Be,{lastFix:a})))),r.a.createElement("div",{style:{width:"27%",textAlign:"right"}},r.a.createElement(s.a,{paddingRight:1,paddingLeft:1},l,r.a.createElement(s.a,{fontSize:"large",marginLeft:"4px",boxShadow:1,style:{verticalAlign:"middle"},className:"flag-icon flag-icon-"+l.toLowerCase()}))))}}]),t}(r.a.PureComponent),Xe=function(e){var t=e.data,n=e.index,a=e.style,i=t.keys[n],o=t.data[i],l=o?o.info.user.fullname:"Offline User",s=o?o.info.user.username:i,c=o?o.lastFix:null,u=o?o.lastFix.timestamp:null,f=o?o.landed:null,h=o?o.info.user.nationality.iso:"--",p=-1!==t.selected.indexOf(i),d=-1!==t.alreadyAdded.indexOf(i);return r.a.createElement(We.a,{component:"div",variant:"body",padding:"none",style:Je({},a,{backgroundColor:p&&!d?"rgba(0, 0, 0, 0.04)":void 0}),onClick:function(){d||t.onPilotClicked(i)}},r.a.createElement(Ze,{fullname:l,username:s,lastFix:c,timestamp:u,landed:f,iso:h,disabled:d}))},Ke=n(118),Qe=n(103);function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tt=function(e,t){if(t){var n={lat:t.coords.latitude,lng:t.coords.longitude},a=Object.entries(e).map((function(e){var t=Object(l.a)(e,2),a=t[0],r=t[1];return[a,Object(Q.getDistance)(n,r.lastFix)]}));return a.sort((function(e,t){return e[1]-t[1]})),a.map((function(e){return e[0]}))}var r=Object.keys(e);return r.sort(),r},nt=function(e){function t(e){var n;Object(D.a)(this,t),(n=Object(ke.a)(this,Object(we.a)(t).call(this,e))).startRendering=function(){n.setState(et({},n.state,{didMount:!0}))},n.updatePilotListIfNecessary=function(){var e=tt(n.state.pilotInfos,n.gpsData);(function(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==t[n])return!1;return!0})(n.state.sortedPilotList,e)||n.setState(et({},n.state,{sortedPilotList:e}))},n.onNewGpsData=function(e){n.gpsData=e,n.updatePilotListIfNecessary()},n.onNewPilotInfos=function(e){n.setState(et({},n.state,{pilotInfos:e,sortedPilotList:tt(e,n.gpsData)}))},n.onPilotClicked=function(e){n.props.onPilotClicked&&n.props.onPilotClicked(e)},n.state={didMount:!1},n.gpsData=Ge().getData();var a=pe().pilotInfos.getValue();return n.state={pilotInfos:a,sortedPilotList:tt(a,n.gpsData)},n}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){pe().pilotInfos.registerCallback(this.onNewPilotInfos),Ge().registerCallback(this.onNewGpsData),setTimeout(this.startRendering)}},{key:"componentWillUnmount",value:function(){pe().pilotInfos.unregisterCallback(this.onNewPilotInfos),Ge().unregisterCallback(this.onNewGpsData)}},{key:"render",value:function(){var e=this;if(!this.state.didMount)return r.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center",overflow:"hidden"}},r.a.createElement(w.a,{disableShrink:!0,style:{margin:"2em"}}));var t=function(e,t,n){var a=function(e){return""===n||e.toLowerCase().includes(n.toLowerCase())},r=e.filter((function(e){return a(t[e].info.user.username)||a(t[e].info.user.fullname)}));return 0===r.length&&!/\s/.test(n)&&n.length>0&&r.push(n),r}(this.state.sortedPilotList,this.state.pilotInfos,this.props.search);return r.a.createElement(r.a.Fragment,null,r.a.createElement(qe,null),r.a.createElement("div",{style:{flex:"1"}},r.a.createElement(Qe.a,null,(function(n){var a=n.height,i=n.width;return r.a.createElement(Ke.a,{width:i,height:a,itemCount:t.length,itemSize:57,itemData:{keys:t,data:e.state.pilotInfos,selected:e.props.selected,alreadyAdded:e.props.alreadyAdded,onPilotClicked:e.onPilotClicked},itemKey:function(e,t){return t.keys[e]}},Xe)}))))}}]),t}(r.a.PureComponent),at=Object(E.a)({fullHeightWindow:{height:"100%"}}),rt=function(e){var t=at(),n=Object(Ce.a)(),i=Object(Ae.a)(n.breakpoints.down("xs")),o=Object(a.useState)([]),c=Object(l.a)(o,2),u=c[0],f=c[1],h=Object(a.useState)(""),p=Object(l.a)(h,2),d=p[0],g=p[1],m=u.length,b=function(){g(""),f([]),e.onClose()};return r.a.createElement(Me,{open:e.open,onClose:b,fullScreen:i,maxWidth:"xs",fullWidth:!0,classes:{paper:t.fullHeightWindow}},r.a.createElement(De.a,{style:0===m?{}:"light"===n.palette.type?{color:n.palette.secondary.main,backgroundColor:Object(Ie.d)(n.palette.secondary.light,.85)}:{color:n.palette.text.primary,backgroundColor:n.palette.secondary.dark}},m>0?r.a.createElement(k.a,{component:"div",color:"inherit",variant:"subtitle1"},m," selected"):r.a.createElement(k.a,{component:"div",variant:"h6",id:"tableTitle"},"Add new pilots:")),r.a.createElement(s.a,{paddingLeft:"1em",paddingRight:"1em",paddingTop:"4px"},r.a.createElement(Te.a,{margin:"dense",autoComplete:"off",variant:"outlined",id:"search_field",label:"Search",type:"search",fullWidth:!0,onChange:function(e){return g(e.target.value)}})),r.a.createElement(s.a,{flex:"1 1 auto",marginY:"8px",display:"flex",flexDirection:"column",alignItems:"stretch"},r.a.createElement(nt,{alreadyAdded:e.alreadyAdded,selected:u,onPilotClicked:function(e){var t=u.indexOf(e),n=[];-1===t?n=n.concat(u,e):0===t?n=n.concat(u.slice(1)):t===u.length-1?n=n.concat(u.slice(0,-1)):t>0&&(n=n.concat(u.slice(0,t),u.slice(t+1))),f(n)},search:d})),r.a.createElement(Le.a,null,r.a.createElement(Ne.a,{onClick:b,color:"primary"},"Cancel"),r.a.createElement(Ne.a,{disabled:0===m,onClick:function(){e.onAddPilots(u),b()},color:"primary"},"Add")))},it=n(259),ot=n(239),lt=n(240),st=n(104),ct=n.n(st);function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ht=function(e){function t(e){var n;Object(D.a)(this,t),(n=Object(ke.a)(this,Object(we.a)(t).call(this,e))).onNewGPSDataReceived=function(e){n.gpsData=e;var t=null!==n.gpsData;n.state.gps===t?t&&n.forceUpdate():n.setState(ft({},n.state,{gps:t}))},n.onNewDataReceived=function(e){n.props.pilotId in e?n.pilotInfo=e[n.props.pilotId]:n.pilotInfo=null;var t=null!==n.pilotInfo;n.state.online===t?t&&n.forceUpdate():n.setState(ft({},n.state,{online:!0}))};var a=pe().animation.getData();return n.pilotInfo=null,e.pilotId in a&&(n.pilotInfo=a[e.pilotId]),n.gpsData=Ge().getData(),n.state={online:null!==n.pilotInfo,gps:null!==n.gpsData},n}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){pe().animation.registerCallback(this.onNewDataReceived),Ge().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function(){pe().animation.unregisterCallback(this.onNewDataReceived),Ge().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function(){return r.a.createElement(it.a,{TransitionProps:{unmountOnExit:!0}},r.a.createElement(ot.a,{expandIcon:r.a.createElement(ct.a,null)},r.a.createElement(s.a,null,r.a.createElement(k.a,{variant:"body2"},this.props.pilotName),r.a.createElement(k.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"--"))),r.a.createElement(lt.a,null,r.a.createElement(k.a,null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget.")))}}]),t}(r.a.PureComponent);function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var dt=function(e){function t(e){var n;return Object(D.a)(this,t),(n=Object(ke.a)(this,Object(we.a)(t).call(this,e))).onNewDataReceived=function(e){n.pilotData=e;var t=Object.keys(e),a=!1;if(t.length===n.state.onlinePilots.length){for(var r=0;r<t.length;r++)if(t[r]!==n.state.onlinePilots[r]){a=!0;break}}else a=!0;a&&n.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.state,{onlinePilots:t}))},n.onNewGPSDataReceived=function(e){n.gpsData=e},n.removePilot=function(e){n.props.removePilots([e])},n.state={onlinePilots:[]},n.pilotData=pe().animation.getData(),n.gpsData=Ge().getData(),n}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){pe().animation.registerCallback(this.onNewDataReceived),Ge().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function(){pe().animation.unregisterCallback(this.onNewDataReceived),Ge().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function(){var e=this,t=new Set(this.state.onlinePilots),n=this.state.onlinePilots.filter((function(t){return t in e.props.pilots})),a=Object.keys(this.props.pilots).filter((function(e){return!t.has(e)})),i=function(t){var n=e.props.pilots[t];return void 0===n||null===n?t:n};return r.a.createElement(s.a,{height:"100%",bgcolor:"#f5f5f5",overflow:"auto"},r.a.createElement(s.a,{margin:1},n.map((function(t){return r.a.createElement(ht,{key:t,pilotId:t,pilotName:i(t),removePilot:e.removePilot})}))),r.a.createElement(s.a,{margin:1},a.map((function(t){return r.a.createElement(ht,{key:t,pilotId:t,pilotName:i(t),removePilot:e.removePilot})}))))}}]),t}(r.a.PureComponent),gt=function(e){function t(){var e,n;Object(D.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(ke.a)(this,(e=Object(we.a)(t)).call.apply(e,[this].concat(r)))).state={pilotSelectorOpen:!1},n.openPilotSelector=function(){!1===n.state.pilotSelectorOpen&&n.setState({pilotSelectorOpen:!0})},n.closePilotSelector=function(){!0===n.state.pilotSelectorOpen&&n.setState({pilotSelectorOpen:!1})},n}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=z();return r.a.createElement(r.a.Fragment,null,r.a.createElement(dt,{pilots:e,removePilots:J}),r.a.createElement(s.a,{position:"absolute",bottom:"16px",right:"16px"},r.a.createElement(Pe.a,{size:"small",color:"primary",onClick:this.openPilotSelector},r.a.createElement(je.a,null))),r.a.createElement(rt,{open:this.state.pilotSelectorOpen,onClose:this.closePilotSelector,onAddPilots:Y,alreadyAdded:Object.keys(e)}))}}]),t}(r.a.PureComponent),mt=n(246),bt=n(197),vt=n(260),yt=n(252),Ot=n(113),Et=n.n(Ot),kt=n(111),wt=n.n(kt),St=n(110),Pt=n.n(St),_t=n(112),jt=n.n(_t),Ct=n(53),At=n.n(Ct),Dt=n(257),It=n(235),Tt=n(243),Lt=n(251),Nt=n(244),xt=n(108),Ft=n.n(xt),Mt=n(109),Vt=n.n(Mt),Rt=n(250),Gt=n(245),Wt=n(261),Ht=n(242);function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bt=function(e){function t(){var e,n;Object(D.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(ke.a)(this,(e=Object(we.a)(t)).call.apply(e,[this].concat(r)))).state={internalUpdate:!1,value:null},n}return Object(Se.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(Te.a,{onChange:function(t){var n=t.target.value;n<e.props.min?(e.props.onChange(e.props.min),e.setState(Ut({},e.state,{internalUpdate:!0,value:n}))):n>e.props.max?e.props.onChange(e.props.max):e.props.onChange(n)},variant:"outlined",disabled:this.props.disabled,margin:"dense",hiddenLabel:!0,type:"number",value:this.state.value,InputProps:{endAdornment:r.a.createElement(Ht.a,{position:"end"},this.props.unit)},inputProps:{min:this.props.min,max:this.props.max}})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=Ut({},t,{internalUpdate:!1});return t.internalUpdate||(n.value=e.value),n}}]),t}(r.a.PureComponent),Yt=function(e){var t=M(e.setting).use(),n=Object(l.a)(t,2),a=n[0],i=n[1],o=function(){return i(!a)};return r.a.createElement(Tt.a,{button:!0,onClick:o},r.a.createElement(Nt.a,{primary:e.primaryText,secondary:e.secondaryText}),r.a.createElement(Gt.a,null,r.a.createElement(Wt.a,{edge:"end",onChange:o,checked:a})))},Jt=function(e){var t=M(e.setting).use(),n=Object(l.a)(t,2),a=n[0],i=n[1];return r.a.createElement(Tt.a,{disabled:e.disabled},r.a.createElement(Nt.a,{primary:e.primaryText,secondary:e.secondaryText}),r.a.createElement(Gt.a,null,r.a.createElement(Bt,{value:a,onChange:i,disabled:e.disabled,unit:e.unit,min:e.min,max:e.max})))},qt=n(247),Zt=n(248),Xt=n(249),Kt=n(106),Qt=n.n(Kt),$t=n(107),en=n.n($t),tn=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),i=n[0],o=n[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(mt.a,{style:{position:"static"}},r.a.createElement(De.a,null,r.a.createElement(bt.a,{edge:"start",color:"inherit",onClick:e.onClose},r.a.createElement(Qt.a,null)),r.a.createElement(s.a,{marginLeft:2,flexGrow:1},r.a.createElement(k.a,{variant:"h6"},"Settings")),r.a.createElement(bt.a,{edge:"end",color:"inherit",onClick:function(){return o(!0)}},r.a.createElement(en.a,null)))),r.a.createElement(Me,{open:i,onClose:function(){return o(!1)}},r.a.createElement(qt.a,null,"Reset all settings?"),r.a.createElement(Zt.a,null,r.a.createElement(Xt.a,null,"This sets all settings to their default values.")),r.a.createElement(Le.a,null,r.a.createElement(Ne.a,{onClick:function(){Object.values(F).forEach((function(e){return e.setValue(null)})),o(!1)},color:"primary"},"Yes"),r.a.createElement(Ne.a,{onClick:function(){return o(!1)},color:"primary",autoFocus:!0},"No"))))},nn=function(e){var t=M(N.LIMIT_PATHS).use(),n=Object(l.a)(t,1)[0],a=M(N.FPS_LIMIT).use(),i=Object(l.a)(a,1)[0];return r.a.createElement(Me,{fullScreen:!0,open:e.open,onClose:e.onClose},r.a.createElement(tn,{onClose:e.onClose}),r.a.createElement(It.a,null,r.a.createElement(Yt,{setting:N.LOW_LATENCY,primaryText:"Low Latency Mode",secondaryText:"disables animations"}),r.a.createElement(Rt.a,null),r.a.createElement(Yt,{setting:N.LIMIT_PATHS,primaryText:"Limit Track Length",secondaryText:"prevents map clutter"}),r.a.createElement(Jt,{primaryText:"Track Length",secondaryText:"Valid: 1-999 min",setting:N.PATH_LENGTH,disabled:!n,unit:"min",min:1,max:999}),r.a.createElement(Rt.a,null),r.a.createElement(Yt,{setting:N.FPS_LIMIT,primaryText:"Limit Framerate",secondaryText:"reduces energy consumption"}),r.a.createElement(Jt,{primaryText:"Framerate",secondaryText:"Valid: 1-60 fps",setting:N.FPS_RATE,disabled:!i,unit:"fps",min:1,max:60}),r.a.createElement(Rt.a,null),r.a.createElement(Yt,{setting:N.GPS_ENABLED,primaryText:"Enable GPS",secondaryText:"required for advanced features"})))},an=function(e){var t=Object(Ce.a)(),n=Object(a.useState)(!1),i=Object(l.a)(n,2),o=i[0],c=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Dt.a,{disableSwipeToOpen:!0,open:e.open,onOpen:function(){},onClose:e.onClose},r.a.createElement(De.a,{style:{backgroundColor:t.palette.primary.light,minWidth:"200px"},onClick:e.onClose},r.a.createElement(s.a,{flexGrow:1,clone:!0},r.a.createElement(k.a,{variant:"h6"},"Menu")),r.a.createElement(bt.a,{edge:"end",color:"inherit"},r.a.createElement(Ft.a,null))),r.a.createElement(It.a,null,r.a.createElement(Tt.a,{button:!0,onClick:function(){e.onClose(),c(!0)}},r.a.createElement(Lt.a,null,r.a.createElement(Vt.a,null)),r.a.createElement(Nt.a,{primary:"Settings"})))),r.a.createElement(nn,{open:o,onClose:function(){return c(!1)}}))},rn=Object(E.a)((function(e){return{popover:{padding:e.spacing(1),align:"right"}}})),on=function(e){return r.a.createElement(yt.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(w.a,{disableShrink:e.disableShrink,color:"secondary",size:15,thickness:10})},e.children)},ln=function(){var e=rn(),t=pe().connectionState.use(),n=r.a.useRef(),i=Object(a.useState)(null),o=Object(l.a)(i,2),c=o[0],u=o[1],f=Object(a.useState)(!1),h=Object(l.a)(f,2),p=h[0],d=h[1];r.a.useLayoutEffect((function(){n.current&&n.current.updatePosition()}),[t,c]);return r.a.createElement("div",null,r.a.createElement(mt.a,{position:"static"},r.a.createElement(De.a,null,r.a.createElement(bt.a,{edge:"start",color:"inherit",onClick:function(){return d(!0)}},r.a.createElement(Et.a,null)),r.a.createElement(s.a,{marginLeft:2,flexGrow:1},r.a.createElement(k.a,{variant:"h6"},"XC Live Viewer")),r.a.createElement(bt.a,{edge:"end",color:"inherit",onClick:function(e){return u(e.currentTarget)}},function(){switch(t){case ue.ACTIVE:return r.a.createElement(Pt.a,null);case ue.CONNECTING:return r.a.createElement(on,null,r.a.createElement(At.a,null));case ue.ERROR:return r.a.createElement(wt.a,{color:"error"});case ue.ESTABLISHED:return r.a.createElement(on,{disableShrink:!0},r.a.createElement(At.a,null));case ue.INACTIVE:return r.a.createElement(jt.a,null);case ue.NO_CONNECTION:default:return r.a.createElement(At.a,null)}}()))),r.a.createElement(vt.a,{open:Boolean(c),anchorEl:c,onClose:function(){return u(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},action:n},r.a.createElement(s.a,{className:e.popover},r.a.createElement(k.a,null,t))),r.a.createElement(an,{open:p,onClose:function(){return d(!1)}}))},sn=function(){var e=r.a.useState(1),t=Object(l.a)(e,2),n=t[0],a=t[1],i=r.a.useState(0),o=Object(l.a)(i,2),c=o[0],p=o[1],g=function(){p(window.innerHeight)};r.a.useLayoutEffect((function(){return g(),window.addEventListener("resize",g),function(){return window.removeEventListener("resize",g)}}),[]);return r.a.createElement(s.a,{height:c,display:"flex",flexDirection:"column"},r.a.createElement(s.a,{zIndex:100},r.a.createElement(ln,null)),r.a.createElement(s.a,{flexGrow:1,clone:!0},r.a.createElement(u.a,{disabled:!0,index:n},r.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},r.a.createElement(Ee,null)),r.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},r.a.createElement(gt,null)),r.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},"Item Three"))),r.a.createElement(s.a,{zIndex:100,boxShadow:3},r.a.createElement(f.a,{value:n,onChange:function(e,t){return a(t)},showLabels:!0},r.a.createElement(h.a,{label:"Map",icon:r.a.createElement(v.a,null)}),r.a.createElement(h.a,{label:"Pilots",icon:r.a.createElement(m.a,null)}),r.a.createElement(h.a,{label:"Nearby",icon:r.a.createElement(d.a,null)}))))},cn=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(sn,null))};n(189),n(190),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(191).config(),o.a.render(r.a.createElement(cn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},99:function(e){e.exports=JSON.parse('[{"featureType":"all","stylers":[{"visibility":"simplified"},{"saturation":-40}]},{"featureType":"administrative.land_parcel","stylers":[{"visibility":"off"}]},{"featureType":"administrative.neighborhood","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text","stylers":[{"visibility":"off"}]}]')}},[[131,1,2]]]);
//# sourceMappingURL=main.8e9887cc.chunk.js.map