/*! For license information please see main.3cd94f2c.chunk.js.LICENSE */
(this["webpackJsonpxc-live-viewer"]=this["webpackJsonpxc-live-viewer"]||[]).push([[0],{107:function(t){t.exports=JSON.parse('[{"featureType":"all","stylers":[{"visibility":"simplified"},{"saturation":-40}]},{"featureType":"administrative.land_parcel","stylers":[{"visibility":"off"}]},{"featureType":"administrative.neighborhood","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text","stylers":[{"visibility":"off"}]}]')},141:function(t,e,n){t.exports=n(206)},170:function(t,e,n){},200:function(t,e,n){},201:function(t,e,n){},206:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),o=n(9),r=n.n(o),l=n(7),s=n(267),c=n(104),u=n.n(c),h=n(25),p=n(244),d=n(264),f=n(265),g=n(127),m=n.n(g),v=n(126),b=n.n(v),y=(n(170),n(105)),k=null;var O=function useGoogleMapsApi(){var t=Object(a.useState)({ready:!1,error:!1}),e=Object(l.a)(t,2),n=e[0],i=e[1];return Object(a.useEffect)((function(){null===k&&(k=new y.a({apiKey:"AIzaSyBCrP5uoEJXfEvz8f_y1HgzQnqUGHz0Aak"}).load());var t={gotCanceled:!1};return k.then((function(){t.gotCanceled||(console.log("Google Maps API loaded."),i({ready:!0,error:!1}))})).catch((function(e){t.gotCanceled||(console.log("Error: Cannot load Google Maps API:",e),i({ready:!1,error:!0}))})),function(){t.gotCanceled=!0}}),[]),[n.ready,n.error,n.ready?window.google:null]},E=n(238),P=n(46),C=n(242),S=n(106),w=n.n(S),_=Object(E.a)((function(t){return{progress:{margin:t.spacing(2)}}})),T=function LoadingPage(t){var e=t.message,n=t.hideIf,a=t.subRef,o=_();return i.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center",ref:a},i.a.createElement(s.a,{textAlign:"center"},i.a.createElement(C.a,{className:o.progress}),i.a.createElement(P.a,null,e)))},A=function ErrorPage(t){var e=t.message,n=t.hideIf,a=_();return i.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center"},i.a.createElement(s.a,{textAlign:"center"},i.a.createElement(w.a,{fontSize:"large",color:"error",className:a.progress}),i.a.createElement(P.a,{color:"error"},e)))},x=n(107),M=n(8),L=n(13),I=function PersistentState(t,e){var n=this;Object(M.a)(this,PersistentState),this.getValue=function(){var t=localStorage.getItem(n.key);n.locallyCachedJson!==t&&(n.locallyCachedJson=t,n.locallyCachedValue=JSON.parse(t));var e=n.locallyCachedValue;return null===e?n.initialValue:e},this._notifyAll=function(){var t=n.getValue(),e=!0,a=!1,i=void 0;try{for(var o,r=n.callbacks[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){(0,o.value)(t)}}catch(l){a=!0,i=l}finally{try{e||null==r.return||r.return()}finally{if(a)throw i}}},this.registerCallback=function(t){n.callbacks.includes(t)||n.callbacks.push(t)},this.unregisterCallback=function(t){var e=n.callbacks.indexOf(t);e>=0&&n.callbacks.splice(e,1)},this.setValue=function(t){null==t?localStorage.removeItem(n.key):localStorage.setItem(n.key,JSON.stringify(t)),n._notifyAll()},this.updateValue=function(t){n.setValue(t(n.getValue()))},this.use=function(){var t=Object(a.useState)(n.getValue),e=Object(l.a)(t,2),i=e[0],o=e[1];return Object(a.useEffect)((function(){var t=function cb(t){o(t)};return n.registerCallback(t),function(){return n.unregisterCallback(t)}}),[]),[i,n.setValue]},this.key=t,this.initialValue=e,this.callbacks=[],this.locallyCachedJson=null,this.locallyCachedValue=null},j=function registerPersistentState(t,e){return new I(t,e)},D={PATH_LENGTH:"PATH_LENGTH",LIMIT_PATHS:"LIMIT_PATHS",LOW_LATENCY:"LOW_LATENCY",ANIMATION_DELAY:"ANIMATION_DELAY",FPS_LIMIT:"FPS_LIMIT",FPS_RATE:"FPS_RATE",GPS_ENABLED:"GPS_ENABLED"},N=function createSetting(t,e){return j("SETTINGS_"+t,e)},F={PATH_LENGTH:N(D.PATH_LENGTH,15),LIMIT_PATHS:N(D.LIMIT_PATHS,!1),LOW_LATENCY:N(D.LOW_LATENCY,!1),ANIMATION_DELAY:N(D.ANIMATION_DELAY,80),FPS_LIMIT:N(D.FPS_LIMIT,!0),FPS_RATE:N(D.FPS_RATE,10),GPS_ENABLED:N(D.GPS_ENABLED,!0)},R=function getSetting(t){return F[t]},V=function(){function XContestSocket(t,e,n,a){var i=this;Object(M.a)(this,XContestSocket),this.formatSubscribedFlights=function(){return i.subscribedFlights.map((function(t){var e=Object(l.a)(t,2),n=e[0],a=e[1];return{flightUuid:n,start:null===a?null:new Date(1e3*a).toISOString()}}))},this.refreshSubscribedFlights=function(){if(i.sock.readyState===WebSocket.OPEN&&i.connected){var t=i.formatSubscribedFlights();i.sock.send(JSON.stringify({tag:"WebFollow",contents:t}))}},this.setSubscribedFlights=function(t){i.subscribedFlights=t,i.refreshSubscribedFlights()},this.onOpen=function(){i.handleReset(),console.debug("WebSocket: Open!"),i.setConnectionState(ot.ESTABLISHED),i.connected=!0,i.sock.send(JSON.stringify({tag:"WebFilterArea",area:[{lat:-90,lon:-180},{lat:90,lon:180}]})),i.sock.send(JSON.stringify({tag:"WebFilterContest",contents:"alpha9999"}));var t=i.formatSubscribedFlights();i.sock.send(JSON.stringify({tag:"WebFollow",contents:t}))},this.onMessage=function(t){console.debug("WebSocket: Message!"),i.setConnectionState(ot.ACTIVE);var e=JSON.parse(t.data);clearTimeout(i.watchdog),i.watchdog=setTimeout((function(){i.setConnectionState(ot.INACTIVE)}),7e4),i.processMessage(e)},this.onClose=function(t){i.connected=!1,console.debug("WebSocket: Close!"),i.setConnectionState(ot.NO_CONNECTION),setTimeout(i.connect.bind(i),1e3)},this.onError=function(t){i.connected=!1,console.debug("WebSocket: Error!")},this.handleReset=function(){console.log("TODO: handle reset!")},this.processMessage=function(t){if("tag"in t)switch(t.tag){case"LiveFlightInfos":i.dispatchInfoMessage(t.contents);break;case"LiveFlightChunk":i.dispatchTracklogMessage(t);break;case"LiveFlightLanded":i.dispatchFlightLandedMessage(t.flightUuid);break;default:console.warn("Warning: Unknown message tag '".concat(t.tag,"'!"),t)}else console.warn("Warning: Invalid message format!",t)},this.setConnectionState=t,this.dispatchInfoMessage=e,this.dispatchTracklogMessage=n,this.dispatchFlightLandedMessage=a,this.subscribedFlights=[],this.connect(),this.connected=!1,R(D.PATH_LENGTH).registerCallback(this.refreshSubscribedFlights),R(D.LIMIT_PATHS).registerCallback(this.refreshSubscribedFlights)}return Object(L.a)(XContestSocket,[{key:"connect",value:function connect(){"WebSocket"in window?(this.connected=!1,this.setConnectionState(ot.CONNECTING),this.sock=new WebSocket("wss://live.xcontest.org/websock/webclient"),this.sock.onopen=this.onOpen,this.sock.onmessage=this.onMessage,this.sock.onclose=this.onClose,this.sock.onerror=this.onError):(this.setConnectionState(ot.ERROR),alert("WebSocket NOT supported by your Browser!"))}}]),XContestSocket}(),G=n(11),W=j("chosen-pilots",{}),H=function getChosenPilotsObject(){return W};function getChosenPilots(){return W.getValue()}function setChosenPilots(t){console.log("Selected pilots updated: ",t),W.setValue(t)}function setChosenPilotsAndUpdateNames(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!0;null===t&&(t=Object(G.a)({},getChosenPilots()),e=!1);var n=st().getPilotInfos();for(var a in t)if(a in n){var i=n[a].info.user.fullname;i!==t[a]&&(t[a]=i,e=!0)}e&&setChosenPilots(t)}var z=function addPilots(t){var e=Object(G.a)({},getChosenPilots()),n=!1,a=!0,i=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var s=r.value;s in e||(e[s]=s,n=!0)}}catch(c){i=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}n&&setChosenPilotsAndUpdateNames(e)},U=function removePilots(t){var e=Object(G.a)({},getChosenPilots()),n=!1,a=!0,i=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var s=r.value;s in e&&(delete e[s],n=!0)}}catch(c){i=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}n&&setChosenPilots(e)};var B=function lerp(t,e,n){return null===e?t:null===t?e:(1-n)*t+n*e},Y=function spline(t,e,n,a,i,o,r,l,s){o-=e,l-=e;var c=((n-t)*(s-=e)+t*(a-=e)-n*(e=0))/(a-e),u=((i-n)*s+n*o-i*a)/(o-a),h=((r-i)*s+i*l-r*o)/(l-o),p=((u-c)*s+c*o-u*e)/(o-e),d=((h-u)*s+u*l-h*a)/(l-a);return((d-p)*s+p*o-d*a)/(o-a)},J=function splineDerivative(t,e,n,a,i,o,r,l,s){o-=e,l-=e;var c=((n-t)*(s-=e)+t*(a-=e)-n*(e=0))/(a-e),u=((i-n)*s+n*o-i*a)/(o-a),h=((r-i)*s+i*l-r*o)/(l-o),p=(n-t)/(a-e),d=(i-n)/(o-a),f=(r-i)/(l-o),g=(d*s+u-p*s-c+p*o-d*e)/(o-e),m=(f*s+h-d*s-u+d*l-f*a)/(l-a);return(m*s+((h-u)*s+u*l-h*a)/(l-a)-g*s-((u-c)*s+c*o-u*e)/(o-e)+g*o-m*a)/(o-a)},X=function(){function RunningDerivation(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return e-t},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return null===t};Object(M.a)(this,RunningDerivation),this.computeDiff=e,this.isInvalid=n,this.old_val=null,this.old_t=null,this.running_avg=null,this.smoothingFactor=t}return Object(L.a)(RunningDerivation,[{key:"update",value:function update(t,e){if(null===this.old_val||null===t||null===this.old_t||null===e||this.isInvalid(this.old_val)||this.isInvalid(t)||this.old_t===this.new_t)return this.old_val=t,this.old_t=e,null;var n=e-this.old_t,a=this.computeDiff(this.old_val,t)/n,i=Math.pow(this.smoothingFactor,n);return null===this.running_avg?this.running_avg=a:this.running_avg=i*this.running_avg+(1-i)*a,this.old_val=t,this.old_t=e,this.running_avg}},{key:"reset",value:function reset(){this.old_val=null,this.old_t=null,this.running_avg=null}}]),RunningDerivation}(),q=n(32),K=function findBisect(t,e,n){if(e<1)return 0;for(var a=-1,i=e,o=0;a<i-1;)n(o=(a+i)/2|0)<t?a=o:i=o;return i},Z=function parseTime(t){return Math.round(Date.parse(t)/1e3)},$=function(){function FlightAnimationData(){var t=this;Object(M.a)(this,FlightAnimationData),this.at=function(e){return t.data[e]},this.findBisect=function(e){return K(e,t.data.length,(function(e){return t.data[e].t}))},this.findForwardSwipe=function(e,n){for(var a=n;a<t.data.length&&t.data[a].t<e;)a+=1;return a},this.getNewestTimestamp=function(){return t.data.length<1?null:t.data[t.data.length-1].t},this.data=[],this.counter_gpsVario=new X(.7),this.counter_baroVarion=new X(.7),this.counter_velocity=new X(.7,(function(t,e){return Object(q.getDistance)(t,e,.01)}),(function(){return!1}))}return Object(L.a)(FlightAnimationData,[{key:"clear",value:function clear(){this.data=[],this.counter_gpsVario=new X(.7),this.counter_baroVarion=new X(.7),this.counter_velocity=new X(.7,(function(t,e){return Object(q.getDistance)(t,e,.01)}),(function(){return!1}))}},{key:"isAfterLastElement",value:function isAfterLastElement(t){return this.data.length<=0||this.data[this.data.length-1].t<t}},{key:"append",value:function append(t){var e=!0,n=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var r=i.value,l=Z(r.timestamp),s={lat:r.lat,lng:r.lon},c=0===r.baroAlt?null:r.baroAlt,u=0===r.gpsAlt?null:r.gpsAlt,h=this.counter_gpsVario.update(u,l),p=this.counter_baroVarion.update(c,l),d=this.counter_velocity.update(s,l),f={baroAlt:c,gpsAlt:u,elevation:r.elevation,pos:s,gpsVario:h,baroVario:p,velocity:d,t:l};this.data.push(f)}}catch(g){n=!0,a=g}finally{try{e||null==o.return||o.return()}finally{if(n)throw a}}}},{key:"replace",value:function replace(t){this.clear(),this.append(t)}},{key:"insert",value:function insert(t){var e=[],n=!0,a=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var l=o.value,s=Z(l.timestamp),c={lat:l.lat,lng:l.lon},u={baroAlt:0===l.baroAlt?null:l.baroAlt,gpsAlt:0===l.gpsAlt?null:l.gpsAlt,elevation:l.elevation,pos:c,gpsVario:null,baroVario:null,velocity:null,t:s};e.push(u)}}catch(S){a=!0,i=S}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}var h=this.data;this.data=[];for(var p=0,d=0;!(p>=h.length&&d>=e.length);)if(p>=h.length)this.data.push(e[d]),d+=1;else if(d>=e.length)this.data.push(h[p]),p+=1;else{var f=h[p],g=e[d];g.t<f.t?(this.data.push(g),d+=1):f.t<g.t?(this.data.push(f),p+=1):(this.data.push(g),p+=1,d+=1)}this.counter_gpsVario.reset(),this.counter_baroVarion.reset(),this.counter_velocity.reset();var m=!0,v=!1,b=void 0;try{for(var y,k=this.data[Symbol.iterator]();!(m=(y=k.next()).done);m=!0){var O=y.value,E=this.counter_gpsVario.update(O.gpsAlt,O.t),P=this.counter_baroVarion.update(O.baroAlt,O.t),C=this.counter_velocity.update(O.pos,O.t);O.gpsVario=E,O.baroVario=P,O.velocity=C}}catch(S){v=!0,b=S}finally{try{m||null==k.return||k.return()}finally{if(v)throw b}}}},{key:"length",get:function get(){return this.data.length}}]),FlightAnimationData}(),Q=function FlightAnimationDataCache(){var t=this;Object(M.a)(this,FlightAnimationDataCache),this.reset=function(){t.currentArrayPos=null,t.mapsPath=[],t.mapsPathNewestPos=0},this.currentArrayPos=null,this.mapsPath=[],this.mapsPathNewestPos=0},tt=function(){function DataGens(){Object(M.a)(this,DataGens)}return Object(L.a)(DataGens,null,[{key:"takeData",value:function takeData(t){return{baroAlt:t.baroAlt,gpsAlt:t.gpsAlt,elevation:t.elevation,pos:{lat:t.pos.lat,lng:t.pos.lng},gpsVario:t.gpsVario,baroVario:t.baroVario,velocity:t.velocity}}},{key:"blendData",value:function blendData(t,e,n){var a=(n-t.t)/(e.t-t.t);return{baroAlt:B(t.baroAlt,e.baroAlt,a),gpsAlt:B(t.gpsAlt,e.gpsAlt,a),elevation:B(t.elevation,e.elevation,a),pos:{lat:B(t.pos.lat,e.pos.lat,a),lng:B(t.pos.lng,e.pos.lng,a)},gpsVario:B(t.gpsVario,e.gpsVario,a),baroVario:B(t.baroVario,e.baroVario,a),velocity:B(t.velocity,e.velocity,a)}}},{key:"blendDataSpline",value:function blendDataSpline(t,e,n,a,i){var o=(i-e.t)/(n.t-e.t);return{baroAlt:B(e.baroAlt,n.baroAlt,o),gpsAlt:B(e.gpsAlt,n.gpsAlt,o),elevation:B(e.elevation,n.elevation,o),pos:{lat:Y(t.pos.lat,t.t,e.pos.lat,e.t,n.pos.lat,n.t,a.pos.lat,a.t,i),lng:Y(t.pos.lng,t.t,e.pos.lng,e.t,n.pos.lng,n.t,a.pos.lng,a.t,i)},gpsVario:B(e.gpsVario,n.gpsVario,o),baroVario:B(e.baroVario,n.baroVario,o),velocity:B(e.velocity,n.velocity,o)}}},{key:"computeLinearVelocity",value:function computeLinearVelocity(t,e){var n=t.t,a=e.t;if(n===a)return null;var i=a-n,o=t.pos,r=e.pos;return{lat:(r.lat-o.lat)/i,lng:(r.lng-o.lng)/i}}},{key:"computeSplineVelocity",value:function computeSplineVelocity(t,e,n,a,i){var o=t.t,r=e.t,l=n.t,s=a.t,c=t.pos,u=e.pos,h=n.pos,p=a.pos;return{lat:J(c.lat,o,u.lat,r,h.lat,l,p.lat,s,i),lng:J(c.lng,o,u.lng,r,h.lng,l,p.lng,s,i)}}}]),DataGens}();tt.fallbackData=function(t){return{baroAlt:t.lastFix.baroAlt,gpsAlt:t.lastFix.gpsAlt,elevation:t.lastFix.elevation,pos:{lat:t.lastFix.lat,lng:t.lastFix.lon},gpsVario:null,baroVario:null,velocity:null}};var et=function FlightAnimation(t){var e=this;Object(M.a)(this,FlightAnimation),this.destroy=function(){R(D.ANIMATION_DELAY).unregisterCallback(e.updateSettings),R(D.LOW_LATENCY).unregisterCallback(e.updateSettings),R(D.PATH_LENGTH).unregisterCallback(e.updateSettings),R(D.LIMIT_PATHS).unregisterCallback(e.updateSettings)},this.updateSettings=function(){e.settings={timeOffsetSeconds:R(D.ANIMATION_DELAY).getValue(),lowLatencyMode:R(D.LOW_LATENCY).getValue(),trackLengthMinutes:R(D.PATH_LENGTH).getValue(),limitTracks:R(D.LIMIT_PATHS).getValue()},e.liveDataCache.reset(),e.flightInfoDataCache.reset()},this.updateInfos=function(t){e.landed|=t.landed,e.flightInfos=t,e.flightInfoData.replace(t.track),e.flightInfoDataCache.reset()},this.updateData=function(t){if(!(t.length<1)){var n=Z(t[0].timestamp);e.liveData.isAfterLastElement(n)?e.liveData.append(t):(e.liveData.insert(t),e.liveDataCache.reset())}},this.updateLanded=function(){console.log("Received flight landed message!"),e.landed=!0},this.getInterpolatedData=function(t,e,n){if(t.length<1)return null;null===e.currentArrayPos?e.currentArrayPos=t.findBisect(n):e.currentArrayPos=t.findForwardSwipe(n,e.currentArrayPos);var a=null,i=!1,o=!1,r=null;if(e.currentArrayPos<=0)a=tt.takeData(t.at(0)),t.length>=2&&(r=tt.computeLinearVelocity(t.at(0),t.at(1))),o=!0;else if(e.currentArrayPos>=t.length)a=tt.takeData(t.at(t.length-1)),t.length>=2&&(r=tt.computeLinearVelocity(t.at(t.length-2),t.at(t.length-1))),i=!0;else{var l=t.at(e.currentArrayPos-1),s=t.at(e.currentArrayPos),c=e.currentArrayPos-2>=0?t.at(e.currentArrayPos-2):Object(G.a)({},l,{t:l.t-1}),u=e.currentArrayPos+1<t.length?t.at(e.currentArrayPos+1):Object(G.a)({},s,{t:s.t+1});a=tt.blendDataSpline(c,l,s,u,n),r=tt.computeSplineVelocity(c,l,s,u,n)}return[a,o,i,t.at(t.length-1).t,r]},this.getFallbackData=function(){return[tt.fallbackData(e.flightInfos),!1,!0,Z(e.flightInfos.lastFix.timestamp),null]},this.computeTrack=function(t,n,a){if(t.length<1)return null;for(var i=a-60*e.settings.trackLengthMinutes,o=n.mapsPath;n.mapsPathNewestPos<t.length&&t.at(n.mapsPathNewestPos).t<a;){var r=t.at(n.mapsPathNewestPos);o.push({lat:r.pos.lat,lng:r.pos.lng,timestamp:r.t,elevation:r.gpsAlt}),n.mapsPathNewestPos+=1}if(e.settings.limitTracks){for(var l=0;l+32-1<o.length&&o[l+32-1].timestamp<i;)l+=32;l>0&&(o=o.slice(l),n.mapsPath=o)}return o},this.updateAnimation=function(t){var n=e.settings.lowLatencyMode?t/1e3:t/1e3-e.settings.timeOffsetSeconds,a=e.getInterpolatedData(e.liveData,e.liveDataCache,n);a||(a=e.getInterpolatedData(e.flightInfoData,e.flightInfoDataCache,n)),a||(a=e.getFallbackData());var i=e.computeTrack(e.liveData,e.liveDataCache,n);i||(i=e.computeTrack(e.flightInfoData,e.flightInfoDataCache,n)),i||(i=[]);var o=a,r=Object(l.a)(o,5),s=r[0],c=r[1],u=r[2],h=r[3],p=r[4];return e.settings.lowLatencyMode&&(u=!!e.landed||h<n-80),Object(G.a)({},s,{startOfTrack:c,endOfTrack:u,landed:e.landed,name:e.flightInfos.info.user.fullname,newestDataTimestamp:h,track:i,velocityVec:p})},this.getNewestTimestamp=function(){return e.liveData.getNewestTimestamp()},this.liveData=new $,this.liveDataCache=new Q,this.flightInfos=null,this.flightInfoData=new $,this.flightInfoDataCache=new Q,this.landed=t.landed,this.updateInfos(t),this.settings={},this.updateSettings(),R(D.ANIMATION_DELAY).registerCallback(this.updateSettings),R(D.LOW_LATENCY).registerCallback(this.updateSettings),R(D.PATH_LENGTH).registerCallback(this.updateSettings),R(D.LIMIT_PATHS).registerCallback(this.updateSettings)},nt=function HighPrecisionTimeSync(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;Object(M.a)(this,HighPrecisionTimeSync),this.get=function(e,n){var a=e+t.offset,i=a-n;return(i>t.tolerance||i<-t.tolerance)&&(t.offset-=i,a=e+t.offset),a},this.offset=0,this.tolerance=e};var at=function XContestAnimation(t){var e=this;Object(M.a)(this,XContestAnimation),this._nextUpdate=Date.now(),this.animationLoop=function(){var t=Date.now(),n=1e3/e._setting_fps;if(!e._setting_limitFps||t>=e._nextUpdate){e._setting_limitFps&&(e._nextUpdate+=n,t>e._nextUpdate&&(e._nextUpdate=t));var a={};Object.keys(e._subscribedPilots).forEach((function(n){if(n in e._pilotInfos){var i=e._pilotInfos[n].flightId;if(i in e._flightAnimations){var o=e._flightAnimations[i];a[n]=o.updateAnimation(t)}}})),e._submitAnimationFrame(a)}requestAnimationFrame(e.animationLoop)},this._submitAnimationFrame=function(t){e._currentAnimationData=t;var n=!0,a=!1,i=void 0;try{for(var o,r=e._callbacks[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){(0,o.value)(t)}}catch(l){a=!0,i=l}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}},this.setSubscribedPilots=function(t){e._subscribedPilots=t,e._updateImportantFlights()},this.pushNewInfo=function(t){console.log("newInfo: ",t),e._pilotInfos=t,e._updateImportantFlights(),Object.values(t).forEach((function(t){var n=t.flightId;n in e._flightAnimations&&e._flightAnimations[n].updateInfos(t)}))},this.pushNewData=function(t,n){console.log("newTrackdata: ",t,n),t in e._flightAnimations&&e._flightAnimations[t].updateData(n)},this.pushFlightLanded=function(t){t in e._flightAnimations&&e._flightAnimations[t].updateLanded()},this.registerCallback=function(t){e._callbacks.includes(t)||e._callbacks.push(t),t(e._currentAnimationData)},this.unregisterCallback=function(t){var n=e._callbacks.indexOf(t);n>=0&&e._callbacks.splice(n,1)},this.getData=function(){return e._currentAnimationData},this._updateImportantFlights=function(){var t={};Object.values(e._pilotInfos).filter((function(t){return t.info.user.username in e._subscribedPilots})).forEach((function(e){t[e.flightId]=e}));var n=new Set(Object.keys(t)),a=[];for(var i in e._flightAnimations)i in t||a.push(i);for(var o=0,r=a;o<r.length;o++){var s=r[o];console.log("Removing flightAnimation of '"+s+"' ..."),e._flightAnimations[s].destroy(),delete e._flightAnimations[s]}if(Object.entries(t).forEach((function(t){var n=Object(l.a)(t,2),a=n[0],i=n[1];a in e._flightAnimations||(e._flightAnimations[a]=new et(i))})),!function eqSet(t,e){if(t.size!==e.size)return!1;var n=!0,a=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var l=o.value;if(!e.has(l))return!1}}catch(s){a=!0,i=s}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}return!0}(n,e._subscribedFlights)){e._subscribedFlights=n;var c=[];console.log(e._flightAnimations),n.forEach((function(t){console.log(t,e._flightAnimations[t]),c.push([t,e._flightAnimations[t].getNewestTimestamp()])})),console.log("Changing flight subscribtion: ",e._subscribedFlights,n),e._setSubscribedFlightsCallback(c)}},this._currentAnimationData={},this._callbacks=[],this._subscribedPilots=getChosenPilots(),this._subscribedFlights=new Set,this._pilotInfos={},this._flightAnimations={},this._highPrecisionTimeSync=new nt;var n=R(D.FPS_LIMIT),a=R(D.FPS_RATE);this._setting_limitFps=n.getValue(),this._setting_fps=a.getValue(),n.registerCallback((function(t){e._setting_limitFps=t})),a.registerCallback((function(t){e._setting_fps=t})),this._setSubscribedFlightsCallback=function(e){t(Array.from(e))},H().registerCallback(this.setSubscribedPilots),requestAnimationFrame(this.animationLoop)},it=function EventfulState(t){var e=this;Object(M.a)(this,EventfulState),this.set=function(t){e._callbackData=t;var n=!0,a=!1,i=void 0;try{for(var o,r=e._callbacks[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){(0,o.value)(t)}}catch(l){a=!0,i=l}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}},this.getValue=function(){return e._callbackData},this.registerCallback=function(t){e._callbacks.includes(t)||e._callbacks.push(t)},this.unregisterCallback=function(t){var n=e._callbacks.indexOf(t);n>=0&&e._callbacks.splice(n,1)},this.use=function(){var t=Object(a.useState)(e._callbackData),n=Object(l.a)(t,2),i=n[0],o=n[1];return Object(a.useEffect)((function(){return e.registerCallback(o),function(){return e.unregisterCallback(o)}}),[]),i},this._callbacks=[],this._callbackData=t},ot={CONNECTING:"connecting",ERROR:"error",ESTABLISHED:"established",ACTIVE:"active",INACTIVE:"inactive",NO_CONNECTION:"no connection",NO_INFORMATION:"no information"},rt=function XContestInterface(){var t=this;Object(M.a)(this,XContestInterface),this.setSubscribedFlights=function(e){t.socket.setSubscribedFlights(e)},this.getPilotInfos=function(){return t.pilots},this.onConnectionStateChanged=function(e){t.connectionState.set(e)},this.onInfoMessageReceived=function(e){t.pilots={};var n=!0,a=!1,i=void 0;try{for(var o,r=e[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var s=o.value,c=Object(l.a)(s,2),u=c[0],h=c[1];h.overriden||(h.flightId=u,t.pilots[h.info.user.username]=h)}}catch(p){a=!0,i=p}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}t.animation.pushNewInfo(t.pilots),t.pilotInfos.set(t.pilots),setChosenPilotsAndUpdateNames()},this.onTracklogMessageReceived=function(e){t.animation.pushNewData(e.flightUuid,e.trackChunk)},this.onFlightLandedMessageReceived=function(e){t.animation.pushFlightLanded(e)},this.pilots=[],this.connectionState=new it(ot.NO_INFORMATION),this.pilotInfos=new it([]),this.socket=new V(this.onConnectionStateChanged,this.onInfoMessageReceived,this.onTracklogMessageReceived,this.onFlightLandedMessageReceived),this.animation=new at(this.setSubscribedFlights)},lt=null,st=function getXContestInterface(){return lt||(lt=new rt),lt};function createRng(t){var e=function xmur3(t){for(var e=0,n=1779033703^t.length;e<t.length;e++)n=(n=Math.imul(n^t.charCodeAt(e),3432918353))<<13|n>>>19;return function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}}(t);return function sfc32(t,e,n,a){return function(){var i=(t>>>=0)+(e>>>=0)|0;return t=e^e>>>9,e=(n>>>=0)+(n<<3)|0,n=(n=n<<21|n>>>11)+(i=i+(a=(a>>>=0)+1|0)|0)|0,(i>>>0)/4294967296}}(e(),e(),e(),e())}var ct=n(108),ut=n.n(ct);function string2color(t,e){var n=createRng(t),a=Math.min(Math.max(360*n(),0),360);return"#"+ut.a.hsl.hex(a,100,e)}var ht=function getPilotIconColor(t){return string2color(t,70)},pt=function getPilotIcon(t,e,n,a,i,o){return e?n?{path:"m 12.66,19.78 6.46,-4.61 C 19.67,14.78 20,14.15 20,13.48 20,11.77 18.08,10.79 16.7,11.77 L 12,15.12 7.3,11.77 c -1.38,-0.99 -3.3,0 -3.3,1.71 0,0.67 0.33,1.31 0.88,1.7 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z m 0,-8 6.46,-4.6 C 19.67,6.78 20,6.15 20,5.48 20,3.77 18.08,2.78 16.7,3.77 L 12,7.12 7.3,3.77 C 5.92,2.78 4,3.77 4,5.48 4,6.15 4.33,6.79 4.88,7.18 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z",fillColor:o,fillOpacity:1,anchor:{x:12,y:20},strokeWeight:1,scale:1.2}:{path:"M 12.747,2 C 12.492,1.998 12.234,2.006 11.973,2.023 8.105,2.256 6.071,4.458 5.904,8.427 H 9.806 C 9.839,7.06 10.64,6.025 12.041,5.859 c 1.401,-0.133 2.735,0.2 3.135,1.134 0.434,1.034 -0.534,2.234 -1.001,2.734 -0.867,0.934 -2.268,1.634 -3.002,2.635 -0.7,1.001 -0.834,2.302 -0.901,3.902 h 3.435 c 0.033,-1.034 0.1,-2.001 0.567,-2.635 0.767,-1.034 1.901,-1.501 2.835,-2.335 0.9,-0.767 1.868,-1.701 2.001,-3.168 C 19.642,4.093 16.568,2.023 12.747,2 Z M 12.074,17.731 A 2.168,2.134 0 0 0 9.906,19.865 2.168,2.134 0 0 0 12.074,22 2.168,2.134 0 0 0 14.242,19.865 2.168,2.134 0 0 0 12.074,17.731 Z",fillColor:o,fillOpacity:1,anchor:{x:12,y:12},strokeWeight:1,scale:1.2}:t?{path:"M 12,2 C 8.13,2 5,5.13 5,9 c 0,5.25 7,13 7,13 0,0 7,-7.75 7,-13 0,-3.87 -3.13,-7 -7,-7",fillColor:o,fillOpacity:1,anchor:{x:12,y:22},strokeWeight:1,scale:1.2}:{path:"M12.93 4.26l6.15 14.99c.34.83-.51 1.66-1.33 1.29l-5.34-2.36c-.26-.11-.55-.11-.81 0l-5.34 2.36c-.82.36-1.67-.46-1.33-1.29l6.15-14.99c.33-.83 1.51-.83 1.85 0z",fillColor:o,fillOpacity:1,anchor:{x:12,y:12},strokeWeight:1,scale:1.2,rotation:null===i?0:Object(q.getRhumbLineBearing)(a,{lat:a.lat+i.lat,lng:a.lng+i.lng})}},dt=function GoogleMapsTrack(t,e,n,a,i){var o=this;Object(M.a)(this,GoogleMapsTrack),this.setMap=function(t){o.marker.setMap(t),o.track.setMap(t),o.newestTrackSegment.setMap(t)},this._updateTrack=function(t){if(t&&!(t.length<1)){var e=t.length,n=t[0].timestamp,a=t[e-1].timestamp;if(n!==o.currentTrackVersion.startTime||a!==o.currentTrackVersion.endTime||e!==o.currentTrackVersion.length){if(n===o.currentTrackVersion.startTime&&e>o.currentTrackVersion.length&&a>o.currentTrackVersion.endTime){for(var i=o.track.getPath(),r=i.getLength();r<e;){var l=t[r];r=i.push(new o.google.maps.LatLng(l.lat,l.lng))}return o.currentTrackVersion.endTime=a,void(o.currentTrackVersion.length=e)}o.currentTrackVersion.startTime=n,o.currentTrackVersion.endTime=a,o.currentTrackVersion.length=e,o.track.setPath(t)}}},this._updateNewestSegment=function(t,e){null===o.newestTrackSegmentData&&(o.newestTrackSegment.setPath([t,e]),o.newestTrackSegmentData=[t,e]);var n=Object(l.a)(o.newestTrackSegmentData,2),a=n[0],i=n[1];o.newestTrackSegmentData=[t,e];var r=o.newestTrackSegment.getPath();if(t.lat!==a.lat||t.lng!==a.lng){var s=new o.google.maps.LatLng(t.lat,t.lng);r.setAt(0,s)}if(i.lat!==e.lat||i.lng!==e.lng){var c=new o.google.maps.LatLng(e.lat,e.lng);r.setAt(1,c)}},this.updateData=function(t){o.marker.setPosition(t.pos);var e=o.marker.getIcon(),n=pt(t.startOfTrack,t.endOfTrack,t.landed,t.pos,t.velocityVec,o.pilotColor);if(function pilotIconChanged(t,e){for(var n in t)if(!(n in e))return!0;for(var a in e){if(!(a in t))return!0;if("anchor"===a){if(t[a].x!==e[a].x||t[a].y!==e[a].y)return!0}else if(t[a]!==e[a])return!0}return!1}(e,n)&&o.marker.setIcon(n),t.track.length>0){var a=t.track[t.track.length-1],i=t.pos;o._updateNewestSegment(i,a)}o._updateTrack(t.track)},this.google=t,this.pilotInfoWindow=i,this.pilotColor=ht(n.info.user.username),this.trackColor=function getPilotTrackColor(t){return string2color(t,40)}(n.info.user.username),this.pilotIcon=pt(a.startOfTrack,a.endOfTrack,a.landed,a.pos,a.velocityVec,this.pilotColor),this.marker=new this.google.maps.Marker({map:e,position:a.pos,title:n.info.user.fullname,icon:this.pilotIcon}),this.marker.addListener("click",(function(){o.pilotInfoWindow.open(o.map,o.marker,n.info.user.username)})),this.track=new this.google.maps.Polyline({map:e,path:[],strokeColor:this.trackColor}),this.currentTrackVersion={startTime:null,endTime:null,length:null},this.newestTrackSegment=new this.google.maps.Polyline({map:e,path:[],strokeColor:this.trackColor}),this.newestTrackSegmentData=null},ft=function MapPilotInfoWindow(t){var e=this;Object(M.a)(this,MapPilotInfoWindow),this.open=function(t,n,a){e.currentPilot=a,e.infoWindow.open(t,n),e.updateContent()},this.close=function(){e.infoWindow.close(),e.currentPilot=null,e.updateContent()},this.update=function(t){e.data=t,e.updateContent()},this.updateContent=function(){if(null!=e.infoWindow.anchor){if(null!==e.currentPilot){if(!(e.currentPilot in e.data))return e.currentPilot=null,void e.infoWindow.close();var t=e.data[e.currentPilot],n=null===t.gpsAlt?t.baroAlt:t.gpsAlt,a=Math.max(n-t.elevation,0),i="";if(i+="<b>"+t.name+"</b><br>",i+=Math.round(n)+"m (",i+=Math.round(a)+"m)<br>",null!==t.baroVario&&!t.landed){var o=Math.round(10*t.baroVario),r=Math.abs(o);r>99&&(r=99),i+="<span>"+((o>=0?"&plus;":"&minus;")+Math.floor(r/10)+"."+r%10+"m/s")+"</span>&nbsp;&nbsp;"}null===t.velocity||t.landed||(i+=Math.round(3.6*t.velocity)+"km/h"),e.infoWindow.getContent()!==i&&e.infoWindow.setContent(i)}}else e.currentPilot=null},this.google=t,this.infoWindow=new t.maps.InfoWindow({content:"- ERROR -",pixelOffset:new t.maps.Size(0,-5),disableAutoPan:!0}),this.data={},this.currentPilot=null},gt=function MapAnimator(t,e){var n=this;Object(M.a)(this,MapAnimator),this.cleanupOldTracks=function(t){var e=[];for(var a in n.tracks)a in t||e.push(a);for(var i=0,o=e;i<o.length;i++){var r=o[i];n.tracks[r].setMap(null),delete n.tracks[r]}},this.update=function(t){var e=st().getPilotInfos();n.cleanupOldTracks(t),Object.entries(t).forEach((function(t){var a=Object(l.a)(t,2),i=a[0],o=a[1];if(i in e){var r=e[i];i in n.tracks||(n.tracks[i]=new dt(n.google,n.map,r,o,n.infoWindow)),n.tracks[i].updateData(o)}})),n.infoWindow.update(t)},this.map=t,this.google=e,this.tracks={},this.infoWindow=new ft(e)},mt=n(35),vt=(n(200),n(21)),bt=n(20),yt=n(51),kt=n(22);var Ot=Object(mt.a)((function LiveMap(){var t=O(),e=Object(l.a)(t,3),n=e[0],o=e[1],r=e[2],c=Object(a.useRef)(),u=Object(a.useState)(null),h=Object(l.a)(u,2),p=h[0],d=h[1];return Object(a.useLayoutEffect)((function(){n&&!p&&d(new r.maps.Map(c.current,{center:{lat:46.509012,lng:11.827984},mapTypeId:"terrain",zoom:5,maxZoom:15,disableDefaultUI:!0,zoomControl:!0,fullscreenControl:!0,styles:x}))}),[n,p,r,c]),Object(a.useEffect)((function(){if(p&&r){var t=new gt(p,r).update;st().animation.registerCallback(t);var e=function createGeolocationMarker(t,e){var n=function(e){function GeolocationMarker(e,n,a,i){var o;Object(M.a)(this,GeolocationMarker),(o=Object(vt.a)(this,Object(bt.a)(GeolocationMarker).call(this))).outerMarker_=null,o.marker_=null,o.circle_=null,o.watchId_=-1;var r={clickable:!1,cursor:"pointer",draggable:!1,flat:!0,icon:{path:t.maps.SymbolPath.CIRCLE,fillColor:"#C8D6EC",fillOpacity:.7,scale:12,strokeWeight:0},position:new t.maps.LatLng(0,0),title:"Current location",zIndex:2},l={clickable:!1,cursor:"pointer",draggable:!1,flat:!0,icon:{path:t.maps.SymbolPath.CIRCLE,fillColor:"#4285F4",fillOpacity:1,scale:6,strokeColor:"white",strokeWeight:2},optimized:!1,position:new t.maps.LatLng(0,0),title:"Current location",zIndex:3};n&&(r=o.copyOptions_(r,n)),a&&(l=o.copyOptions_(l,a));var s={clickable:!1,radius:0,strokeColor:"1bb6ff",strokeOpacity:.4,fillColor:"61a0bf",fillOpacity:.4,strokeWeight:1,zIndex:1};return i&&(s=o.copyOptions_(s,i)),o.outerMarker_=new t.maps.Marker(r),o.marker_=new t.maps.Marker(l),o.circle_=new t.maps.Circle(s),t.maps.MVCObject.prototype.set.call(Object(yt.a)(o),"accuracy",null),t.maps.MVCObject.prototype.set.call(Object(yt.a)(o),"position",null),t.maps.MVCObject.prototype.set.call(Object(yt.a)(o),"map",null),o.set("minimum_accuracy",null),o.set("position_options",{enableHighAccuracy:!0,maximumAge:1e3}),o.circle_.bindTo("map",o.outerMarker_),o.circle_.bindTo("map",o.marker_),e&&o.setMap(e),o}return Object(kt.a)(GeolocationMarker,e),Object(L.a)(GeolocationMarker,[{key:"set",value:function set(e,n){if(GeolocationMarker.invalidPropertiesExpr_.test(e))throw new Error("'"+e+"' is a read-only property.");"map"===e?this.setMap(n):t.maps.MVCObject.prototype.set.call(this,e,n)}},{key:"getMap",value:function getMap(){return this.get("map")}},{key:"getPositionOptions",value:function getPositionOptions(){return this.get("position_options")}},{key:"setPositionOptions",value:function setPositionOptions(t){this.set("position_options",t)}},{key:"getPosition",value:function getPosition(){return this.get("position")}},{key:"getBounds",value:function getBounds(){return this.get("position")?this.circle_.getBounds():null}},{key:"getAccuracy",value:function getAccuracy(){return this.get("accuracy")}},{key:"getMinimumAccuracy",value:function getMinimumAccuracy(){return this.get("minimum_accuracy")}},{key:"setMinimumAccuracy",value:function setMinimumAccuracy(t){this.set("minimum_accuracy",t)}},{key:"setMap",value:function setMap(e){t.maps.MVCObject.prototype.set.call(this,"map",e),e?this.watchPosition_():(this.outerMarker_.unbind("position"),this.marker_.unbind("position"),this.circle_.unbind("center"),this.circle_.unbind("radius"),t.maps.MVCObject.prototype.set.call(this,"accuracy",null),t.maps.MVCObject.prototype.set.call(this,"position",null),navigator.geolocation.clearWatch(this.watchId_),this.watchId_=-1,this.outerMarker_.setMap(e),this.marker_.setMap(e))}},{key:"setOuterMarkerOptions",value:function setOuterMarkerOptions(t){this.outerMarker_.setOptions(this.copyOptions_({},t))}},{key:"setMarkerOptions",value:function setMarkerOptions(t){this.marker_.setOptions(this.copyOptions_({},t))}},{key:"setCircleOptions",value:function setCircleOptions(t){this.circle_.setOptions(this.copyOptions_({},t))}},{key:"updatePosition_",value:function updatePosition_(e){var n=new t.maps.LatLng(e.coords.latitude,e.coords.longitude),a=null==this.marker_.getMap();if(a){if(null!=this.getMinimumAccuracy()&&e.coords.accuracy>this.getMinimumAccuracy())return;this.outerMarker_.setMap(this.getMap()),this.marker_.setMap(this.getMap()),this.outerMarker_.bindTo("position",this),this.marker_.bindTo("position",this),this.circle_.bindTo("center",this,"position"),this.circle_.bindTo("radius",this,"accuracy")}this.getAccuracy()!==e.coords.accuracy&&t.maps.MVCObject.prototype.set.call(this,"accuracy",e.coords.accuracy),!a&&null!=this.getPosition()&&this.getPosition().equals(n)||t.maps.MVCObject.prototype.set.call(this,"position",n)}},{key:"watchPosition_",value:function watchPosition_(){navigator.geolocation&&(this.watchId_=navigator.geolocation.watchPosition(this.updatePosition_.bind(this),this.geolocationError_.bind(this),this.getPositionOptions()))}},{key:"geolocationError_",value:function geolocationError_(e){t.maps.event.trigger(this,"geolocation_error",e)}},{key:"copyOptions_",value:function copyOptions_(t,e){for(var n in e)!0!==GeolocationMarker.DISALLOWED_OPTIONS[n]&&(t[n]=e[n]);return t}}]),GeolocationMarker}(t.maps.MVCObject);return n.DISALLOWED_OPTIONS={map:!0,position:!0,radius:!0},n.invalidPropertiesExpr_=/^(?:position|accuracy)$/i,new n(e)}(r,null);e.setPositionOptions({enableHighAccuracy:!0}),R(D.GPS_ENABLED).getValue()&&e.setMap(p);var n=function geolocationMarkerStateUpdater(t){t?e.setMap(p):e.setMap(null)};return R(D.GPS_ENABLED).registerCallback(n),function(){st().animation.unregisterCallback(t),R(D.GPS_ENABLED).unregisterCallback(n),e.setMap(null)}}}),[p,r]),i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{width:"100%",height:"100%",display:n?"block":"none",ref:c}),i.a.createElement(T,{message:"Loading Maps ...",hideIf:n||o}),i.a.createElement(A,{message:"Unable to load map!",hideIf:!o}))})),Et=n(255),Pt=n(117),Ct=n.n(Pt),St=n(245),wt=n(14),_t=n(266),Tt=n(247),At=n(248),xt=n(243),Mt=[];window.addEventListener("popstate",(function(){0===Mt.length&&console.warn("History was already 0!");var t=Mt.pop();console.debug("- History size:",Mt.length),Mt.length>0&&window.history.pushState({},""),t&&t()}),{passive:!0});var Lt=function SubWindow(t){var e=Object(a.useState)(!1),n=Object(l.a)(e,2),o=n[0],r=n[1],s=Object(a.useState)(!1),c=Object(l.a)(s,2),u=c[0],h=c[1],p=function useHistory(){return{push:function pushFunction(t){var e=Mt.length;Mt.push(t),console.debug("+ History size:",Mt.length),0===e&&window.history.pushState({},"")},pop:function popFunction(){window.history.back()}}}();return t.open&&!o&&(u?t.onClose():function openWindow(){p.push((function(){r(!1),t.onClose()})),r(!0),h(!0)}()),!u||o||t.open||h(!1),o&&!t.open&&p.pop(),i.a.createElement(xt.a,{open:o,onClose:function onClose(){t.onClose()},fullScreen:t.fullScreen,maxWidth:t.maxWidth,fullWidth:t.fullWidth,classes:t.classes},t.children)};var It=function GPSProvider(){var t=this;Object(M.a)(this,GPSProvider),this._updateGPSState=function(){var e=R(D.GPS_ENABLED).getValue(),n=t._callbacks.length>0,a=e&&n;null===t._watchId&&a&&navigator.geolocation&&(t._watchId=navigator.geolocation.watchPosition(t._onNewGPSData,t._onGPSError,{enableHighAccuracy:!0}),console.log("GPS: On")),null===t._watchId||a||(navigator.geolocation.clearWatch(t._watchId),t._watchId=null,t._setGPSData(null),console.log("GPS: Off"))},this._setGPSData=function(e){console.log("GPS DATA:",e),t._gpsData=e;var n=!0,a=!1,i=void 0;try{for(var o,r=t._callbacks[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){(0,o.value)(e)}}catch(l){a=!0,i=l}finally{try{n||null==r.return||r.return()}finally{if(a)throw i}}},this._onNewGPSData=function(e){t._setGPSData(e)},this._onGPSError=function(){t._setGPSData(null)},this.registerCallback=function(e){t._callbacks.includes(e)||t._callbacks.push(e),t._updateGPSState(),e(t._gpsData)},this.unregisterCallback=function(e){var n=t._callbacks.indexOf(e);n>=0&&t._callbacks.splice(n,1),t._updateGPSState()},this.getData=function(){return t._gpsData},this._callbacks=[],this._watchId=null,this._gpsData=null,R(D.GPS_ENABLED).registerCallback(this._updateGPSState),this._updateGPSState()},jt=null,Dt=function getGPSProvider(){return jt||(jt=new It),jt},Nt=n(269),Ft=function getRotationStyle(t){var e="rotate("+t.toString()+"deg)";return{transform:e,WebkitTransform:e,MozTransform:e,msTransform:e,OTransform:e}};var Rt=function(t){function LastFixState(t){var e;return Object(M.a)(this,LastFixState),(e=Object(vt.a)(this,Object(bt.a)(LastFixState).call(this,t))).getMessage=function(t){var e=t.timestamp,n=t.endOfTrack,a=t.landed,i=t.relative,o=t.showLastFix;if(null==e)return["","never"];var r=new Date(e).getTime()-Date.now(),l="";return l=i?function formatTimeDiff(t){var e="";t<0&&(t=-t,e="-");var n=Math.floor(t/1e3);if(n<90)return e+n+" sec";var a=Math.floor(n/60);if(a<60)return e+a+" min";var i=Math.floor(a/60);if(a-=60*i,i<24)return e+i+":"+a.toString().padStart(2,"0")+" h";var o=Math.floor(i/24);return e+o+"d "+(i-=24*o)+":"+a.toString().padStart(2,"0")+" h"}(r):function timestampToTimeString(t){return new Date(t).toLocaleTimeString()}(e),n&&a?["#346B8F","\u2714 "+l]:-r<12e4&&!n?i?o?["green","\u26ab LIVE ("+l+")"]:["green","\u26ab LIVE"]:["green","\u26ab "+l]:i?["red","! LIVE ("+l+")"]:["red","! "+l]},e.shallowRerender=function(t){if(null!==e.msgRef.current){var n=e.msgRef.current,a=e.getMessage(t),i=Object(l.a)(a,2),o=i[0],r=i[1];Object.assign(n.style,{color:o}),n.innerHTML!==r&&(n.innerHTML=r)}},e.msgRef=i.a.createRef(),e}return Object(kt.a)(LastFixState,t),Object(L.a)(LastFixState,[{key:"render",value:function render(){var t=this.getMessage(this.props),e=Object(l.a)(t,2),n=e[0],a=e[1];return i.a.createElement("span",{style:{color:n},ref:this.msgRef},a)}}]),LastFixState}(i.a.PureComponent),Vt=function(t){function LastFixArrow(t){var e;return Object(M.a)(this,LastFixArrow),(e=Object(vt.a)(this,Object(bt.a)(LastFixArrow).call(this,t))).onNewGPSDataReceived=function(t){e.gpsData=t,e.updateThroughRef()},e.setFix=function(t){e.lastFix=t,e.updateThroughRef()},e.updateThroughRef=function(){if(e.arrowRef.current){var t=LastFixArrow.getArrowRotationStyle(e.gpsData,e.lastFix);Object.assign(e.arrowRef.current.style,t)}if(e.distanceRef.current){var n=LastFixArrow.getDistance(e.gpsData,e.lastFix);n!==e.distanceRef.current.innerHTML&&(e.distanceRef.current.innerHTML=n)}},e.gpsData=Dt().getData(),e.distanceRef=i.a.createRef(),e.arrowRef=i.a.createRef(),e.lastFix=e.props.lastFix,e}return Object(kt.a)(LastFixArrow,t),Object(L.a)(LastFixArrow,[{key:"componentDidMount",value:function componentDidMount(){Dt().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function componentWillUnmount(){Dt().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function render(){return this.lastFix=this.props.lastFix,i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{ref:this.distanceRef},LastFixArrow.getDistance(this.gpsData,this.lastFix))," ",i.a.createElement("div",{ref:this.arrowRef,style:Object(G.a)({display:"inline-block"},LastFixArrow.getArrowRotationStyle(this.gpsData,this.lastFix))},"\u2191"))}}],[{key:"getDistance",value:function getDistance(t,e){if(null===t||null===e)return"--km";var n=Object(q.getDistance)({lat:t.coords.latitude,lng:t.coords.longitude},e);return(Math.round(n/100)/10).toString()+"km"}},{key:"getArrowRotationStyle",value:function getArrowRotationStyle(t,e){if(null===t||null===e)return Ft(0);var n=Object(q.getRhumbLineBearing)({lat:t.coords.latitude,lng:t.coords.longitude},e);return Ft(n)}}]),LastFixArrow}(i.a.PureComponent),Gt=function TableHeader(){return i.a.createElement(Nt.a,{component:"div",variant:"head",className:"MuiTableCell-stickyHeader",style:{height:37,display:"flex",alignItems:"center",boxSizing:"border-box"}},i.a.createElement("div",{style:{flex:"1"}},"Name"),i.a.createElement("div",{style:{width:"25%",textAlign:"right"}},"State"),i.a.createElement("div",{style:{width:"27%",textAlign:"right"}},"Country"))},Wt=function(t){function PilotSelectorListRow(){return Object(M.a)(this,PilotSelectorListRow),Object(vt.a)(this,Object(bt.a)(PilotSelectorListRow).apply(this,arguments))}return Object(kt.a)(PilotSelectorListRow,t),Object(L.a)(PilotSelectorListRow,[{key:"render",value:function render(){var t=this.props,e=t.fullname,n=t.username,a=t.lastFix,o=t.timestamp,r=t.landed,l=t.iso,c=t.disabled;return i.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",boxSizing:"border-box",filter:c?"grayscale(100%) opacity(30%)":void 0}},i.a.createElement(s.a,{flex:"1",paddingLeft:1,paddingTop:1,paddingBottom:1},i.a.createElement(P.a,{variant:"body2"},e),i.a.createElement(P.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"[",n,"]")),i.a.createElement("div",{style:{width:"25%",textAlign:"right"}},i.a.createElement("div",null,i.a.createElement(P.a,{variant:"caption"},i.a.createElement(Rt,{timestamp:o,landed:r,endOfTrack:r,relative:!0}))),i.a.createElement("div",null,i.a.createElement(P.a,{variant:"caption"},i.a.createElement(Vt,{lastFix:a})))),i.a.createElement("div",{style:{width:"27%",textAlign:"right"}},i.a.createElement(s.a,{paddingRight:1,paddingLeft:1},l,i.a.createElement(s.a,{fontSize:"large",marginLeft:"4px",boxShadow:1,style:{verticalAlign:"middle"},className:"flag-icon flag-icon-"+l.toLowerCase()}))))}}]),PilotSelectorListRow}(i.a.PureComponent),Ht=function renderRow(t){var e=t.data,n=t.index,a=t.style,o=e.keys[n],r=e.data[o],l=r?r.info.user.fullname:"Offline User",s=r?r.info.user.username:o,c=r?r.lastFix:null,u=r?r.lastFix.timestamp:null,h=r?r.landed:null,p=r?r.info.user.nationality.iso:"--",d=-1!==e.selected.indexOf(o),f=-1!==e.alreadyAdded.indexOf(o);return i.a.createElement(Nt.a,{component:"div",variant:"body",padding:"none",style:Object(G.a)({},a,{backgroundColor:d&&!f?"rgba(0, 0, 0, 0.04)":void 0}),onClick:function onClick(){f||e.onPilotClicked(o)}},i.a.createElement(Wt,{fullname:l,username:s,lastFix:c,timestamp:u,landed:h,iso:p,disabled:f}))},zt=n(128),Ut=n(111),Bt=function sortPilotList(t,e){if(e){var n={lat:e.coords.latitude,lng:e.coords.longitude},a=Object.entries(t).map((function(t){var e=Object(l.a)(t,2),a=e[0],i=e[1];return[a,Object(q.getDistance)(n,i.lastFix)]}));return a.sort((function(t,e){return t[1]-e[1]})),a.map((function(t){return t[0]}))}var i=Object.keys(t);return i.sort(),i},Yt=function(t){function PilotSelectorList(t){var e;Object(M.a)(this,PilotSelectorList),(e=Object(vt.a)(this,Object(bt.a)(PilotSelectorList).call(this,t))).startRendering=function(){e.setState((function(t){return Object(G.a)({},t,{didMount:!0})}))},e.updatePilotListIfNecessary=function(){var t=Bt(e.state.pilotInfos,e.gpsData);(function arraysEqual(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,a=t.length;n<a;n++)if(t[n]!==e[n])return!1;return!0})(e.state.sortedPilotList,t)||e.setState((function(e){return Object(G.a)({},e,{sortedPilotList:t})}))},e.onNewGpsData=function(t){e.gpsData=t,e.updatePilotListIfNecessary()},e.onNewPilotInfos=function(t){e.setState((function(n){return Object(G.a)({},n,{pilotInfos:t,sortedPilotList:Bt(t,e.gpsData)})}))},e.onPilotClicked=function(t){e.props.onPilotClicked&&e.props.onPilotClicked(t)},e.state={didMount:!1},e.gpsData=Dt().getData();var n=st().pilotInfos.getValue();return e.state={pilotInfos:n,sortedPilotList:Bt(n,e.gpsData)},e}return Object(kt.a)(PilotSelectorList,t),Object(L.a)(PilotSelectorList,[{key:"componentDidMount",value:function componentDidMount(){st().pilotInfos.registerCallback(this.onNewPilotInfos),Dt().registerCallback(this.onNewGpsData),setTimeout(this.startRendering)}},{key:"componentWillUnmount",value:function componentWillUnmount(){st().pilotInfos.unregisterCallback(this.onNewPilotInfos),Dt().unregisterCallback(this.onNewGpsData)}},{key:"render",value:function render(){var t=this;if(!this.state.didMount)return i.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center",overflow:"hidden"}},i.a.createElement(C.a,{disableShrink:!0,style:{margin:"2em"}}));var e=function filterPilotList(t,e,n){var a=function matchesSearch(t){return""===n||t.toLowerCase().includes(n.toLowerCase())},i=t.filter((function(t){return a(e[t].info.user.username)||a(e[t].info.user.fullname)}));return 0===i.length&&!/\s/.test(n)&&n.length>0&&i.push(n),i}(this.state.sortedPilotList,this.state.pilotInfos,this.props.search);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Gt,null),i.a.createElement("div",{style:{flex:"1"}},i.a.createElement(Ut.a,null,(function(n){var a=n.height,o=n.width;return i.a.createElement(zt.a,{width:o,height:a,itemCount:e.length,itemSize:57,itemData:{keys:e,data:t.state.pilotInfos,selected:t.props.selected,alreadyAdded:t.props.alreadyAdded,onPilotClicked:t.onPilotClicked},itemKey:function itemKey(t,e){return e.keys[t]}},Ht)}))))}}]),PilotSelectorList}(i.a.PureComponent),Jt=Object(E.a)({fullHeightWindow:{height:"100%"}}),Xt=Object(mt.a)((function PilotSelector(t){var e=Jt(),n=Object(h.a)(),o=Object(p.a)(n.breakpoints.down("xs")),r=Object(a.useState)([]),c=Object(l.a)(r,2),u=c[0],d=c[1],f=Object(a.useState)(""),g=Object(l.a)(f,2),m=g[0],v=g[1],b=u.length,y=function closeWindow(){v(""),d([]),t.onClose()};return i.a.createElement(Lt,{open:t.open,onClose:y,fullScreen:o,maxWidth:"xs",fullWidth:!0,classes:{paper:e.fullHeightWindow}},i.a.createElement(St.a,{style:0===b?{}:"light"===n.palette.type?{color:n.palette.secondary.main,backgroundColor:Object(wt.d)(n.palette.secondary.light,.85)}:{color:n.palette.text.primary,backgroundColor:n.palette.secondary.dark}},b>0?i.a.createElement(P.a,{component:"div",color:"inherit",variant:"subtitle1"},b," selected"):i.a.createElement(P.a,{component:"div",variant:"h6",id:"tableTitle"},"Add new pilots:")),i.a.createElement(s.a,{paddingLeft:"1em",paddingRight:"1em",paddingTop:"4px"},i.a.createElement(_t.a,{margin:"dense",autoComplete:"off",variant:"outlined",id:"search_field",label:"Search",type:"search",fullWidth:!0,onChange:function onChange(t){return v(t.target.value)}})),i.a.createElement(s.a,{flex:"1 1 auto",marginY:"8px",display:"flex",flexDirection:"column",alignItems:"stretch"},i.a.createElement(Yt,{alreadyAdded:t.alreadyAdded,selected:u,onPilotClicked:function pilotClicked(t){var e=u.indexOf(t),n=[];-1===e?n=n.concat(u,t):0===e?n=n.concat(u.slice(1)):e===u.length-1?n=n.concat(u.slice(0,-1)):e>0&&(n=n.concat(u.slice(0,e),u.slice(e+1))),d(n)},search:m})),i.a.createElement(Tt.a,null,i.a.createElement(At.a,{onClick:y,color:"primary"},"Cancel"),i.a.createElement(At.a,{disabled:0===b,onClick:function onClick(){t.onAddPilots(u),y()},color:"primary"},"Add")))})),qt=n(271),Kt=n(246),Zt=n(252),$t=n(253),Qt=n(254),te=n(250),ee=n(270),ne=n(251),ae=n(112),ie=n.n(ae),oe=n(241),re=n(207),le=-1!==navigator.platform.indexOf("iPhone")||-1!==navigator.platform.indexOf("iPad")||-1!==navigator.platform.indexOf("iPod")?400:1e3,se=function ContextMenuHandler(t){var e=this;Object(M.a)(this,ContextMenuHandler),this.onTouchStart=function(t){console.log(e.toString(),"onTouchStart"),e.contextMenuPossible=!0;var n=t.touches[0];e.longPressCountdown=setTimeout((function(){e.contextMenuPossible=!1,e.callback(n),console.log(e.toString(),"CONTEXT_MENU")}),le)},this.onTouchMove=function(t){console.log(e.toString(),"onTouchMove"),clearTimeout(e.longPressCountdown)},this.onTouchCancel=function(t){console.log(e.toString(),"onTouchCancel"),e.contextMenuPossible=!1,clearTimeout(e.longPressCountdown)},this.onTouchEnd=function(t){console.log(e.toString(),"onTouchEnd"),e.contextMenuPossible=!1,clearTimeout(e.longPressCountdown)},this.onContextMenu=function(t){console.log(e.toString(),"onContextMenu"),e.contextMenuPossible=!1,clearTimeout(e.longPressCountdown),e.callback(t),t.preventDefault()},this.callback=t,this.longPressCountdown=null,this.contextMenuPossible=!1},ce=Object(oe.a)(P.a)({overflow:"hidden",flex:"1"}),ue=Object(oe.a)(P.a)({marginRight:".2em",marginLeft:".5em"}),he=Object(oe.a)(P.a)({display:"flex",justifyContent:"space-between",paddingLeft:".5em"}),pe=Object(re.a)({root:{paddingLeft:"12px"},content:{overflow:"hidden",alignItems:"center",whiteSpace:"nowrap"}})(te.a),de=function(t){function AnimatedPilotListEntry(t){var e;return Object(M.a)(this,AnimatedPilotListEntry),(e=Object(vt.a)(this,Object(bt.a)(AnimatedPilotListEntry).call(this,t))).extractImportantProps=function(t){return{height:null!==t.gpsAlt?t.gpsAlt:t.baroAlt,elevation:t.elevation,vario:t.baroVario,startOfTrack:t.startOfTrack,endOfTrack:t.endOfTrack,landed:t.landed,newestDataTimestamp:t.newestDataTimestamp,lat:t.pos.lat,lng:t.pos.lng,velocityLat:null===t.velocityVec?null:t.velocityVec.lat,velocityLng:null===t.velocityVec?null:t.velocityVec.lng,velocity:t.velocity}},e.propsChanged=function(t){var n=e.pilotProps;for(var a in n)if(!(a in t))return!0;for(var i in t){if(!(i in n))return!0;if(n[i]!==t[i])return!0}return!1},e.onNewGPSDataReceived=function(t){e.gpsData=t},e.onNewDataReceived=function(t){if(e.props.pilotId in t){var n=t[e.props.pilotId],a=e.extractImportantProps(n);e.propsChanged(a)?(e.pilotProps=a,e.shallowRerender(!0)):e.shallowRerender(!1)}},e.shallowRerender=function(t){if(null!==e.heightRef.current&&t){var n=AnimatedPilotListEntry.renderHeight(e.pilotProps);n!==e.heightRef.current.innerHTML&&(e.heightRef.current.innerHTML=n)}if(null!==e.lastFixRef.current&&t&&e.lastFixRef.current.setFix({lat:e.pilotProps.lat,lng:e.pilotProps.lng}),null!==e.iconRef.current&&t){var a=e.iconRef.current,i=pt(e.pilotProps.startOfTrack,e.pilotProps.endOfTrack,e.pilotProps.landed,{lat:e.pilotProps.lat,lng:e.pilotProps.lng},{lat:e.pilotProps.velocityLat,lng:e.pilotProps.velocityLng});if(a.childNodes.length>0){var o=a.childNodes[0];o.getAttribute("d")!==i.path&&o.setAttribute("d",i.path)}var r=void 0===i.rotation?0:i.rotation;Object.assign(a.style,Ft(r))}null!==e.liveStateRef.current&&e.liveStateRef.current.shallowRerender({timestamp:1e3*e.pilotProps.newestDataTimestamp,landed:e.pilotProps.landed,endOfTrack:e.pilotProps.endOfTrack,relative:!0,showLastFix:R(D.LOW_LATENCY).getValue()})},e.gpsData=Dt().getData(),e.pilotColor=ht(e.props.pilotId),e.lastFixRef=i.a.createRef(),e.heightRef=i.a.createRef(),e.liveStateRef=i.a.createRef(),e.iconRef=i.a.createRef(),e.contextMenuHandler=new se((function(t){e.props.onContextMenuHandler(e.props.pilotId,{left:t.pageX,top:t.pageY},e.pilotProps)})),e}return Object(kt.a)(AnimatedPilotListEntry,t),Object(L.a)(AnimatedPilotListEntry,[{key:"componentDidMount",value:function componentDidMount(){st().animation.registerCallback(this.onNewDataReceived),Dt().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function componentWillUnmount(){st().animation.unregisterCallback(this.onNewDataReceived),Dt().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function render(){var t=st().animation.getData(),e=this.props.pilotId in t?t[this.props.pilotId]:null;this.pilotProps=this.extractImportantProps(e),console.log("RENDER ",this.props.pilotId,this.state,this.props,this.pilotProps);var n=pt(this.pilotProps.startOfTrack,this.pilotProps.endOfTrack,this.pilotProps.landed,{lat:this.pilotProps.lat,lng:this.pilotProps.lng},{lat:this.pilotProps.velocityLat,lng:this.pilotProps.velocityLng}),a=void 0===n.rotation?0:n.rotation;return i.a.createElement(ee.a,{TransitionProps:{unmountOnExit:!0},onContextMenu:this.contextMenuHandler.onContextMenu,onTouchStart:this.contextMenuHandler.onTouchStart,onTouchCancel:this.contextMenuHandler.onTouchCancel,onTouchEnd:this.contextMenuHandler.onTouchEnd,onTouchMove:this.contextMenuHandler.onTouchMove},i.a.createElement(pe,{expandIcon:i.a.createElement(ie.a,null)},i.a.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 24 24",display:"block",style:Object(G.a)({flex:"0 0 auto"},Ft(a)),ref:this.iconRef},i.a.createElement("path",{d:n.path,fill:this.pilotColor,stroke:"black"})),i.a.createElement("div",{style:{flex:"1 1 auto",overflow:"hidden",marginLeft:"10px"}},i.a.createElement("div",{style:{width:"100%",display:"flex",overflow:"hidden"}},i.a.createElement(ce,{variant:"body2"},this.props.pilotName),i.a.createElement(ue,{variant:"caption"},i.a.createElement(Vt,{ref:this.lastFixRef,lastFix:{lat:this.pilotProps.lat,lng:this.pilotProps.lng}}))),i.a.createElement(he,{variant:"caption"},i.a.createElement(Rt,{timestamp:1e3*this.pilotProps.newestDataTimestamp,landed:this.pilotProps.landed,endOfTrack:this.pilotProps.endOfTrack,relative:!0,ref:this.liveStateRef,showLastFix:R(D.LOW_LATENCY).getValue()}),i.a.createElement("span",{ref:this.heightRef},AnimatedPilotListEntry.renderHeight(this.pilotProps))))),i.a.createElement(ne.a,null,i.a.createElement(P.a,{style:{MozUserSelect:"none",WebkitUserSelect:"none",msUserSelect:"none"}},"TODO: Details")))}}],[{key:"renderHeight",value:function renderHeight(t){var e=t.height;return Math.round(e)+"m ("+Math.round(Math.max(0,e-t.elevation))+"m)"}}]),AnimatedPilotListEntry}(i.a.PureComponent),fe=n(113),ge=n.n(fe),me=n(116),ve=n.n(me),be=n(114),ye=n.n(be),ke=n(115),Oe=n.n(ke);var Ee=function(t){function AnimatedPilotList(t){var e;return Object(M.a)(this,AnimatedPilotList),(e=Object(vt.a)(this,Object(bt.a)(AnimatedPilotList).call(this,t))).getSortedPilotList=function(t){if(null===e.gpsData)return Object.keys(t);var n={lat:e.gpsData.coords.latitude,lng:e.gpsData.coords.longitude},a=Object.entries(t).map((function(t){var e=Object(l.a)(t,2),a=e[0],i=e[1];return[a,Object(q.getDistance)(n,i.pos)]}));return a.sort((function(t,e){return t[1]-e[1]})),a.map((function(t){return t[0]}))},e.onAnimationFrame=function(t){var n=e.getSortedPilotList(t),a=n.filter((function(e){return t[e].endOfTrack&&t[e].landed})),i=n.filter((function(e){return!(t[e].endOfTrack&&t[e].landed)})).concat(a),o=!1;if(i.length===e.state.onlinePilots.length){for(var r=0;r<i.length;r++)if(i[r]!==e.state.onlinePilots[r]){o=!0;break}}else o=!0;o&&e.setState((function(t){return Object(G.a)({},t,{onlinePilots:i})}))},e.onNewGPSDataReceived=function(t){e.gpsData=t},e.removePilot=function(t){e.props.removePilots([t])},e.showContextMenu=function(t,n,a){e.setState((function(e){return Object(G.a)({},e,{contextMenu:{pilotId:t,pos:n,props:a}})}))},e.hideContextMenu=function(){e.setState((function(t){return Object(G.a)({},t,{contextMenu:null})}))},e.contextMenu_delete=function(){null!==e.state.contextMenu&&e.removePilot(e.state.contextMenu.pilotId),e.hideContextMenu()},e.contextMenu_navigateTo=function(){if(null!==e.state.contextMenu){var t=e.state.contextMenu.props;!function navigateTo(t){-1!==navigator.platform.indexOf("iPhone")||-1!==navigator.platform.indexOf("iPad")||-1!==navigator.platform.indexOf("iPod")?window.open("https://maps.apple.com/maps?q="+t.lat.toString()+","+t.lng.toString()):window.open("https://maps.google.com/maps?q="+t.lat.toString()+","+t.lng.toString())}({lat:t.lat,lng:t.lng})}e.hideContextMenu()},e.state={onlinePilots:[],contextMenu:null},e.gpsData=Dt().getData(),e}return Object(kt.a)(AnimatedPilotList,t),Object(L.a)(AnimatedPilotList,[{key:"componentDidMount",value:function componentDidMount(){st().animation.registerCallback(this.onAnimationFrame),Dt().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function componentWillUnmount(){st().animation.unregisterCallback(this.onAnimationFrame),Dt().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function render(){var t=this,e=new Set(this.state.onlinePilots),n=this.state.onlinePilots.filter((function(e){return e in t.props.pilots})),a=Object.keys(this.props.pilots).filter((function(t){return!e.has(t)})),o=function getPilotName(e){var n=t.props.pilots[e];return void 0===n||null===n?e:n};return i.a.createElement(s.a,{height:"100%",bgcolor:"#eeeef5",overflow:"auto"},i.a.createElement(s.a,{margin:1},n.map((function(e){return i.a.createElement(de,{key:e,pilotId:e,pilotName:o(e),removePilot:t.removePilot,onContextMenuHandler:t.showContextMenu})}))),i.a.createElement(s.a,{margin:1},a.map((function(e){return i.a.createElement(s.a,{key:e,onClick:function onClick(){t.removePilot(e)},display:"flex"},i.a.createElement(P.a,{variant:"body2"},o(e)),i.a.createElement(P.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"[",e,"]"))}))),i.a.createElement(qt.a,{open:null!==this.state.contextMenu,anchorReference:"anchorPosition",anchorPosition:null===this.state.contextMenu?null:this.state.contextMenu.pos,transformOrigin:{vertical:"top",horizontal:"right"},onClose:this.hideContextMenu},i.a.createElement(Kt.a,{component:"nav",dense:!0},i.a.createElement(Zt.a,{button:!0,disabled:!0},i.a.createElement($t.a,null,i.a.createElement(ge.a,null)),i.a.createElement(Qt.a,null,"Show Pilot on Map")),i.a.createElement(Zt.a,{button:!0,disabled:!0},i.a.createElement($t.a,null,i.a.createElement(ye.a,null)),i.a.createElement(Qt.a,null,"Live Navigation")),i.a.createElement(Zt.a,{button:!0,onClick:this.contextMenu_navigateTo},i.a.createElement($t.a,null,i.a.createElement(Oe.a,null)),i.a.createElement(Qt.a,null,"Open in Maps")),i.a.createElement(Zt.a,{button:!0,onClick:this.contextMenu_delete},i.a.createElement($t.a,null,i.a.createElement(ve.a,null)),i.a.createElement(Qt.a,null,"Remove Pilot")))))}}]),AnimatedPilotList}(i.a.PureComponent),Pe=function(t){function Pilots(t){var e;return Object(M.a)(this,Pilots),(e=Object(vt.a)(this,Object(bt.a)(Pilots).call(this,t))).openPilotSelector=function(){!1===e.state.pilotSelectorOpen&&e.setState((function(t){return Object(G.a)({},t,{pilotSelectorOpen:!0})}))},e.closePilotSelector=function(){!0===e.state.pilotSelectorOpen&&e.setState((function(t){return Object(G.a)({},t,{pilotSelectorOpen:!1})}))},e.chosenPilotsChanged=function(t){e.setState((function(e){return Object(G.a)({},e,{chosenPilots:t})}))},e.state={pilotSelectorOpen:!1,chosenPilots:getChosenPilots()},e}return Object(kt.a)(Pilots,t),Object(L.a)(Pilots,[{key:"componentDidMount",value:function componentDidMount(){H().registerCallback(this.chosenPilotsChanged)}},{key:"componentWillUnmount",value:function componentWillUnmount(){H().unregisterCallback(this.chosenPilotsChanged)}},{key:"render",value:function render(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ee,{pilots:this.state.chosenPilots,removePilots:U}),i.a.createElement(s.a,{position:"absolute",bottom:"16px",right:"16px"},i.a.createElement(Et.a,{size:"small",color:"primary",onClick:this.openPilotSelector},i.a.createElement(Ct.a,null))),i.a.createElement(Xt,{open:this.state.pilotSelectorOpen,onClose:this.closePilotSelector,onAddPilots:z,alreadyAdded:Object.keys(this.state.chosenPilots)}))}}]),Pilots}(i.a.Component),Ce=n(258),Se=n(209),we=n(263),_e=n(125),Te=n.n(_e),Ae=n(123),xe=n.n(Ae),Me=n(122),Le=n.n(Me),Ie=n(124),je=n.n(Ie),De=n(58),Ne=n.n(De),Fe=n(268),Re=n(120),Ve=n.n(Re),Ge=n(121),We=n.n(Ge),He=n(262),ze=n(257),Ue=n(272),Be=n(256),Ye=function(t){function NumberInput(){var t,e;Object(M.a)(this,NumberInput);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=Object(vt.a)(this,(t=Object(bt.a)(NumberInput)).call.apply(t,[this].concat(a)))).state={internalUpdate:!1,value:null},e}return Object(kt.a)(NumberInput,t),Object(L.a)(NumberInput,[{key:"render",value:function render(){var t=this;return i.a.createElement(_t.a,{onChange:function onChange(e){var n=e.target.value;n<t.props.min?(t.props.onChange(t.props.min),t.setState((function(t){return Object(G.a)({},t,{internalUpdate:!0,value:n})}))):n>t.props.max?t.props.onChange(t.props.max):t.props.onChange(n)},variant:"outlined",disabled:this.props.disabled,margin:"dense",hiddenLabel:!0,type:"number",value:this.state.value,InputProps:{endAdornment:i.a.createElement(Be.a,{position:"end"},this.props.unit)},inputProps:{min:this.props.min,max:this.props.max}})}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(t,e){var n=Object(G.a)({},e,{internalUpdate:!1});return e.internalUpdate||(n.value=t.value),n}}]),NumberInput}(i.a.PureComponent),Je=Object(mt.a)((function(t){var e=R(t.setting).use(),n=Object(l.a)(e,2),a=n[0],o=n[1],r=function flipSetting(){return o(!a)};return i.a.createElement(Zt.a,{button:!0,onClick:r},i.a.createElement(Qt.a,{primary:t.primaryText,secondary:t.secondaryText}),i.a.createElement(ze.a,null,i.a.createElement(Ue.a,{edge:"end",onChange:r,checked:a})))})),Xe=Object(mt.a)((function(t){var e=R(t.setting).use(),n=Object(l.a)(e,2),a=n[0],o=n[1];return i.a.createElement(Zt.a,{disabled:t.disabled},i.a.createElement(Qt.a,{primary:t.primaryText,secondary:t.secondaryText}),i.a.createElement(ze.a,null,i.a.createElement(Ye,{value:a,onChange:o,disabled:t.disabled,unit:t.unit,min:t.min,max:t.max})))})),qe=n(259),Ke=n(260),Ze=n(261),$e=n(118),Qe=n.n($e),tn=n(119),en=n.n(tn),nn=Object(mt.a)((function(t){var e=Object(a.useState)(!1),n=Object(l.a)(e,2),o=n[0],r=n[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ce.a,{style:{position:"static"}},i.a.createElement(St.a,null,i.a.createElement(Se.a,{edge:"start",color:"inherit",onClick:t.onClose},i.a.createElement(Qe.a,null)),i.a.createElement(s.a,{marginLeft:2,flexGrow:1},i.a.createElement(P.a,{variant:"h6"},"Settings")),i.a.createElement(Se.a,{edge:"end",color:"inherit",onClick:function onClick(){return r(!0)}},i.a.createElement(en.a,null)))),i.a.createElement(Lt,{open:o,onClose:function onClose(){return r(!1)}},i.a.createElement(qe.a,null,"Reset all settings?"),i.a.createElement(Ke.a,null,i.a.createElement(Ze.a,null,"This sets all settings to their default values.")),i.a.createElement(Tt.a,null,i.a.createElement(At.a,{onClick:function onClick(){!function resetAllSettings(){Object.values(F).forEach((function(t){return t.setValue(null)}))}(),r(!1)},color:"primary"},"Yes"),i.a.createElement(At.a,{onClick:function onClick(){return r(!1)},color:"primary",autoFocus:!0},"No"))))})),an=function SettingsPage(t){var e=R(D.LIMIT_PATHS).use(),n=Object(l.a)(e,1)[0],a=R(D.FPS_LIMIT).use(),o=Object(l.a)(a,1)[0];return i.a.createElement(Lt,{fullScreen:!0,open:t.open,onClose:t.onClose},i.a.createElement(nn,{onClose:t.onClose}),i.a.createElement(Kt.a,null,i.a.createElement(Je,{setting:D.LOW_LATENCY,primaryText:"Low Latency Mode",secondaryText:"disables animations"}),i.a.createElement(He.a,null),i.a.createElement(Je,{setting:D.LIMIT_PATHS,primaryText:"Limit Track Length",secondaryText:"prevents map clutter"}),i.a.createElement(Xe,{primaryText:"Track Length",secondaryText:"Valid: 1-999 min",setting:D.PATH_LENGTH,disabled:!n,unit:"min",min:1,max:999}),i.a.createElement(He.a,null),i.a.createElement(Je,{setting:D.FPS_LIMIT,primaryText:"Limit Framerate",secondaryText:"reduces energy consumption"}),i.a.createElement(Xe,{primaryText:"Framerate",secondaryText:"Valid: 1-60 fps",setting:D.FPS_RATE,disabled:!o,unit:"fps",min:1,max:60}),i.a.createElement(He.a,null),i.a.createElement(Je,{setting:D.GPS_ENABLED,primaryText:"Enable GPS",secondaryText:"required for advanced features"})))},on=function MainMenu(t){var e=Object(h.a)(),n=Object(a.useState)(!1),o=Object(l.a)(n,2),r=o[0],c=o[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Fe.a,{disableSwipeToOpen:!0,open:t.open,onOpen:function onOpen(){},onClose:t.onClose},i.a.createElement(St.a,{style:{backgroundColor:e.palette.primary.light,minWidth:"200px"},onClick:t.onClose},i.a.createElement(s.a,{flexGrow:1,clone:!0},i.a.createElement(P.a,{variant:"h6"},"Menu")),i.a.createElement(Se.a,{edge:"end",color:"inherit"},i.a.createElement(Ve.a,null))),i.a.createElement(Kt.a,null,i.a.createElement(Zt.a,{button:!0,onClick:function onClick(){t.onClose(),c(!0)}},i.a.createElement($t.a,null,i.a.createElement(We.a,null)),i.a.createElement(Qt.a,{primary:"Settings"})))),i.a.createElement(an,{open:r,onClose:function onClose(){return c(!1)}}))},rn=Object(E.a)((function(t){return{popover:{padding:t.spacing(1),align:"right"}}})),ln=function LoadingBadge(t){return i.a.createElement(we.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:i.a.createElement(C.a,{disableShrink:t.disableShrink,color:"secondary",size:15,thickness:10})},t.children)},sn=Object(mt.a)((function TitleBar(){var t=rn(),e=function useXContestConnectionState(){return st().connectionState.use()}(),n=i.a.useRef(),o=Object(a.useState)(null),r=Object(l.a)(o,2),c=r[0],u=r[1],h=Object(a.useState)(!1),p=Object(l.a)(h,2),d=p[0],f=p[1];i.a.useLayoutEffect((function(){n.current&&n.current.updatePosition()}),[e,c]);return i.a.createElement("div",null,i.a.createElement(Ce.a,{position:"static"},i.a.createElement(St.a,null,i.a.createElement(Se.a,{edge:"start",color:"inherit",onClick:function onClick(){return f(!0)}},i.a.createElement(Te.a,null)),i.a.createElement(s.a,{marginLeft:2,flexGrow:1},i.a.createElement(P.a,{variant:"h6"},"XC Live Viewer")),i.a.createElement(Se.a,{edge:"end",color:"inherit",onClick:function onClick(t){return u(t.currentTarget)}},function renderConnectionIcon(){switch(e){case ot.ACTIVE:return i.a.createElement(Le.a,null);case ot.CONNECTING:return i.a.createElement(ln,null,i.a.createElement(Ne.a,null));case ot.ERROR:return i.a.createElement(xe.a,{color:"error"});case ot.ESTABLISHED:return i.a.createElement(ln,{disableShrink:!0},i.a.createElement(Ne.a,null));case ot.INACTIVE:return i.a.createElement(je.a,null);case ot.NO_CONNECTION:default:return i.a.createElement(Ne.a,null)}}()))),i.a.createElement(qt.a,{open:Boolean(c),anchorEl:c,onClose:function onClose(){return u(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},action:n},i.a.createElement(s.a,{className:t.popover},i.a.createElement(P.a,null,e))),i.a.createElement(on,{open:d,onClose:function onClose(){return f(!1)}}))})),cn=function MainPage(){var t=i.a.useState(1),e=Object(l.a)(t,2),n=e[0],a=e[1],o=i.a.useState(0),r=Object(l.a)(o,2),c=r[0],g=r[1],v=Object(h.a)(),y=Object(p.a)(v.breakpoints.down("sm")),k=function updateWindowHeight(){g(window.innerHeight)};i.a.useLayoutEffect((function(){return k(),window.addEventListener("resize",k),function(){return window.removeEventListener("resize",k)}}),[]);var O=y?i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{flexGrow:1,clone:!0,display:"flex"},i.a.createElement(u.a,{disabled:!0,index:n},i.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},i.a.createElement(Ot,null)),i.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},i.a.createElement(Pe,null)))),i.a.createElement(s.a,{zIndex:100,boxShadow:3},i.a.createElement(d.a,{value:n,onChange:function handleNavigationButton(t,e){return a(e)},showLabels:!0},i.a.createElement(f.a,{label:"Map",icon:i.a.createElement(b.a,null)}),i.a.createElement(f.a,{label:"Pilots",icon:i.a.createElement(m.a,null)})))):i.a.createElement(s.a,{width:"100%",flexGrow:1,display:"flex"},i.a.createElement(s.a,{flexGrow:1,height:"100%"},i.a.createElement(Ot,null)),i.a.createElement(s.a,{width:"450px",height:"100%",zIndex:50,boxShadow:3},i.a.createElement(Pe,null)));return i.a.createElement(s.a,{height:c,display:"flex",flexDirection:"column"},i.a.createElement(s.a,{zIndex:100},i.a.createElement(sn,null)),O)},un=function App(){return i.a.createElement("div",{className:"App"},i.a.createElement(cn,null))};n(201),n(202),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(203).config(),r.a.render(i.a.createElement(un,null),document.getElementById("root")),function unregister(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}()}},[[141,1,2]]]);
//# sourceMappingURL=main.3cd94f2c.chunk.js.map