{"version":3,"sources":["common/GoogleMapsApiLoader.js","pages/StatusPages.jsx","common/PersistentState/PersistentState.js","common/PersistentState/Settings.js","location_provider/XContest/XContestSocket.js","common/PersistentState/ChosenPilots.js","util/Interpolation.js","util/RunningDerivation.js","util/FindBisect.js","location_provider/XContest/FlightAnimationData.js","location_provider/XContest/FlightAnimation.js","util/HighPrecisionTimeSync.js","location_provider/XContest/XContestAnimation.js","util/EventfulState.js","location_provider/XContest/XContestInterface.js","pages/GoogleMapsTrack.js","common/PilotIcon.js","pages/MapAnimator.js","pages/LiveMap.jsx","common/History.js","util/SubWindow.jsx","common/GPSProvider.js","util/LastFixState.jsx","pages/PilotSelector/PilotSelectorListItems.jsx","pages/PilotSelector/PilotSelector.jsx","util/CompareArrays.js","pages/PilotList/AnimatedPilotListEntry.jsx","pages/PilotList/AnimatedPilotList.jsx","pages/PilotList/Pilots.jsx","util/NumberInput.jsx","pages/SettingsPage/SettingsPageEntries.jsx","pages/SettingsPage/SettingsPageTitleBar.jsx","pages/SettingsPage/SettingsPage.jsx","pages/MainMenu.jsx","pages/TitleBar.jsx","MainPage.jsx","App.jsx","serviceWorker.jsx","index.js"],"names":["googleMapsApiPromise","useGoogleMapsApi","useState","ready","error","state","setState","useEffect","Promise","resolve","_reject","console","log","script","document","createElement","src","async","addEventListener","body","appendChild","then","success","window","google","useStyles","makeStyles","theme","progress","margin","spacing","LoadingPage","message","hideIf","subRef","classes","Box","width","height","display","alignItems","justifyContent","ref","textAlign","CircularProgress","className","Typography","ErrorPage","fontSize","color","PersistentState","key","initialValue","getValue","value","JSON","parse","localStorage","getItem","_notifyAll","callbacks","cb","registerCallback","includes","push","unregisterCallback","index","indexOf","splice","setValue","removeItem","setItem","stringify","use","newValue","this","registerPersistentState","name","Settings","PATH_LENGTH","LIMIT_PATHS","LOW_LATENCY","ANIMATION_DELAY","FPS_LIMIT","FPS_RATE","GPS_ENABLED","createSetting","settingsObjects","getSetting","XContestSocket","onStateChanged","onInfoMessage","onTracklogMessage","onFlightLanded","formatSubscribedFlights","subscribedFlights","map","flightId","startTimestamp","flightUuid","start","Date","toISOString","refreshSubscribedFlights","sock","readyState","WebSocket","OPEN","connected","formattedSubscribedFlights","send","tag","contents","setSubscribedFlights","flights","onOpen","handleReset","debug","setConnectionState","ConnectionState","ESTABLISHED","area","lat","lon","onMessage","evt","ACTIVE","msg","data","clearTimeout","watchdog","setTimeout","INACTIVE","processMessage","onClose","NO_CONNECTION","connect","bind","onError","dispatchInfoMessage","dispatchTracklogMessage","dispatchFlightLandedMessage","warn","CONNECTING","onopen","onmessage","onclose","onerror","ERROR","alert","persistentChosenPilots","lerp","val1","val2","pct","spline","p0","t0","p1","t1","p2","t2","p3","t3","t","A1","A2","A3","B1","B2","splineDerivative","A1d","A2d","A3d","B1d","B2d","RunningDerivation","smoothingFactor","derivation_func","a","b","invalid_func","computeDiff","isInvalid","old_val","old_t","running_avg","new_val","new_t","dt","deriv","weight","Math","pow","findBisect","targetValue","length","dataFn","minIndex","maxIndex","currentIndex","parseTime","isoStr","round","FlightAnimationData","at","timestamp","pos","findForwardSwipe","startPos","getNewestTimestamp","counter_gpsVario","counter_baroVarion","counter_velocity","end","getDistance","elem","lng","baroAlt","gpsAlt","gpsVario","update","baroVario","velocity","newElem","elevation","clear","append","newElements","oldElements","oldPos","newPos","oldEl","newEl","reset","FlightAnimationDataCache","currentArrayPos","mapsPath","mapsPathNewestPos","DataGens","data1","data2","timeStamp","data0","data3","dT","d0","d1","d2","d3","fallbackData","flightInfos","lastFix","FlightAnimation","destroy","updateSettings","settings","timeOffsetSeconds","lowLatencyMode","trackLengthMinutes","limitTracks","liveDataCache","flightInfoDataCache","updateInfos","infos","landed","flightInfoData","replace","track","updateData","data_start_time","liveData","isAfterLastElement","insert","updateLanded","getInterpolatedData","cache","blendedData","endOfTrack","startOfTrack","velocityVec","takeData","computeLinearVelocity","blendDataSpline","computeSplineVelocity","getFallbackData","computeTrack","oldestTimestamp","numRemove","slice","updateAnimation","animationTimeMillis","animationTimeSeconds","animationResult","newestDataTimestamp","HighPrecisionTimeSync","tolerance","get","currentHighPrecisionTime","currentTime","estimatedTime","offset","offBy","XContestAnimation","_nextUpdate","now","animationLoop","absTime","frameTimeDelta","_setting_fps","_setting_limitFps","newAnimationData","Object","keys","_subscribedPilots","forEach","pilot","_pilotInfos","_flightAnimations","flightAnim","_submitAnimationFrame","requestAnimationFrame","_currentAnimationData","_callbacks","setSubscribedPilots","subscribedPilots","_updateImportantFlights","pushNewInfo","pilotInfo","values","flightInfo","pushNewData","trackId","trackData","pushFlightLanded","getData","importantFlights","filter","val","info","user","username","importantFlightSet","Set","toRemove","entries","as","bs","size","has","eqSet","_subscribedFlights","flightsWithTimestamps","_setSubscribedFlightsCallback","_highPrecisionTimeSync","settings_limitFps","settings_fps","Array","from","EventfulState","set","_callbackData","NO_INFORMATION","XContestInterface","socket","getPilotInfos","pilots","onConnectionStateChanged","connectionState","onInfoMessageReceived","overriden","animation","pilotInfos","onTracklogMessageReceived","trackChunk","onFlightLandedMessageReceived","_instance","getXContestInterface","GoogleMapsTrack","initialData","setMap","marker","newestTrackSegment","_updateTrack","startTime","endTime","currentTrackVersion","setPath","setPosition","setIcon","waitingForStart","hasLanded","path","fillColor","fillOpacity","anchor","maps","Point","strokeWeight","scale","bearing","getRhumbLineBearing","rotation","getPilotIcon","Marker","position","title","fullname","Polyline","MapAnimator","cleanupOldTracks","tracks","pilotData","LiveMap","mapReady","mapError","mapsRef","useRef","useLayoutEffect","Map","current","center","mapTypeId","zoom","maxZoom","disableDefaultUI","scaleControl","fullscreenControl","styles","mapStyle","mapAnimatorUpdateCallback","Fragment","ourHistory","callback","pop","history","pushState","SubWindow","props","open","_setOpen","historyOpen","_setHistoryOpen","histSize","back","Dialog","fullScreen","maxWidth","fullWidth","children","GPSProvider","_updateGPSState","gpssettingEnabled","callbackRegistered","enableGps","_watchId","navigator","geolocation","watchPosition","_onNewGPSData","_onGPSError","enableHighAccuracy","clearWatch","_setGPSData","_gpsData","getGPSProvider","LastFixState","relative","time_diff","timeStr","millis","negative","secs","floor","mins","hours","toString","padStart","days","formatTimeDiff","toLocaleTimeString","timestampToTimeString","style","role","aria-hidden","LastFixArrow","onNewGPSDataReceived","gpsData","updateThroughRef","arrowRef","arrowStyle","getArrowRotationStyle","assign","distanceRef","innerHTML","React","createRef","myPosition","pilotFix","distance","coords","latitude","longitude","transform","WebkitTransform","MozTransform","msTransform","OTransform","Component","columns","id","label","render","paddingLeft","paddingTop","paddingBottom","variant","align","iso","nationality","paddingRight","marginLeft","boxShadow","verticalAlign","toLowerCase","PilotSelectorListHeader","TableRow","column","TableCell","component","PilotSelectorListEntry","boxStyle","disabled","columnContent","padding","selected","onClick","getSortedPilotList","gps","myPos","distances","pilotId","sort","el1","el2","el","pilotIds","PilotSelectorContent","updatePilotListIfNecessary","newPilotList","array1","array2","i","l","arraysEqual","sortedPilotList","onNewGpsData","onNewPilotInfos","displayedPilots","pilotList","search","matchesSearch","filteredPilots","test","computeDisplayedPilots","Table","stickyHeader","TableHead","TableBody","isItemSelected","itemDisabled","alreadyAdded","wasAlreadyAdded","onPilotClicked","PilotSelector","useTheme","useMediaQuery","breakpoints","down","setSelected","setSearch","numSelected","closeWindow","Toolbar","palette","type","secondary","main","backgroundColor","lighten","light","text","primary","dark","TextField","autoComplete","onChange","event","target","flex","marginY","overflowY","selectedIndex","newSelected","concat","DialogActions","Button","onAddPilots","AnimatedPilotListEntry","hasGps","forceUpdate","onNewDataReceived","hasPilotInfo","online","animatedPilotData","pilotDebugOutput","dataElement","isNaN","subKey","removePilot","accuracy","AnimatedPilotList","pilotListChanged","onlinePilots","pilotIsOnline","apply","content","removePilots","Pilots","pilotSelectorOpen","setPilotSelectorOpen","chosenPilots","setChosenPilots","newPilotState","changed","useChosenPilots","addPilots","bottom","right","Fab","NumberInput","internalUpdate","min","max","hiddenLabel","InputProps","endAdornment","InputAdornment","unit","inputProps","resultState","BooleanSetting","setting","settingValue","setSettingValue","flipSetting","ListItem","button","ListItemText","primaryText","secondaryText","ListItemSecondaryAction","Switch","edge","checked","NumberSetting","SettingsPageTitleBar","resetAllSettingsDialogOpen","setResetAllSettingsDialogOpen","AppBar","IconButton","flexGrow","DialogTitle","DialogContent","DialogContentText","settingsObj","autoFocus","SettingsPage","settingLimitPaths","settingFpsLimit","List","Divider","MainMenu","settingsOpen","setSettingsOpen","SwipeableDrawer","disableSwipeToOpen","minWidth","clone","ListItemIcon","popover","LoadingBadge","Badge","anchorOrigin","vertical","horizontal","badgeContent","disableShrink","thickness","TitleBar","popoverActions","connectionPopAnchor","setConnectionPopAnchor","mainMenuOpen","setMainMenuOpen","updatePosition","currentTarget","renderConnectionIcon","Popover","Boolean","anchorEl","transformOrigin","action","MainPage","tabId","setTabId","windowHeight","setWindowHeight","updateWindowHeight","innerHeight","removeEventListener","flexDirection","zIndex","BottomNavigation","_event","showLabels","BottomNavigationAction","icon","App","location","hostname","match","require","config","ReactDOM","getElementById","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.ca38462b.chunk.js","sourcesContent":["import { useState, useEffect } from \"react\";\n\n// Hook\nlet googleMapsApiPromise = null;\nfunction useGoogleMapsApi() {\n  // Keeping track of script loaded and error state\n  const [state, setState] = useState({\n    ready: false,\n    error: false\n  });\n\n  useEffect(\n    () => {\n      if (googleMapsApiPromise === null) {\n        googleMapsApiPromise = new Promise((resolve, _reject) => {\n          console.log(\"Loading Google Maps API ...\");\n          // Create script\n          let script = document.createElement(\"script\");\n          script.src =\n            \"https://maps.googleapis.com/maps/api/js?key=\" +\n            process.env.REACT_APP_GAPI_KEY;\n          script.async = true;\n\n          script.addEventListener(\"load\", () => resolve(true));\n          script.addEventListener(\"error\", () => resolve(false));\n\n          // Add script to document body\n          document.body.appendChild(script);\n        });\n      }\n\n      googleMapsApiPromise.then(success => {\n        if (success) {\n          console.log(\"Google Maps API loaded.\");\n          setState({\n            ready: true,\n            error: false\n          });\n        } else {\n          console.log(\"Error: Cannot load Google Maps API.\");\n          setState({\n            ready: false,\n            error: true\n          });\n        }\n      });\n    },\n    [] // Don't re-run\n  );\n\n  return [state.ready, state.error, state.ready ? window.google : null];\n}\n\nexport default useGoogleMapsApi;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Box, Typography } from \"@material-ui/core\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport ErrorIcon from \"@material-ui/icons/Error\";\n\nconst useStyles = makeStyles(theme => ({\n  progress: {\n    margin: theme.spacing(2)\n  }\n}));\n\nexport const LoadingPage = ({ message, hideIf, subRef }) => {\n  const classes = useStyles();\n  return (\n    <Box\n      width=\"100%\"\n      height=\"100%\"\n      display={hideIf ? \"none\" : \"flex\"}\n      alignItems=\"center\"\n      justifyContent=\"center\"\n      ref={subRef}\n    >\n      <Box textAlign=\"center\">\n        <CircularProgress className={classes.progress} />\n        <Typography>{message}</Typography>\n      </Box>\n    </Box>\n  );\n};\n\nexport const ErrorPage = ({ message, hideIf }) => {\n  const classes = useStyles();\n  return (\n    <Box\n      width=\"100%\"\n      height=\"100%\"\n      display={hideIf ? \"none\" : \"flex\"}\n      alignItems=\"center\"\n      justifyContent=\"center\"\n    >\n      <Box textAlign=\"center\">\n        <ErrorIcon\n          fontSize=\"large\"\n          color=\"error\"\n          className={classes.progress}\n        />\n        <Typography color=\"error\">{message}</Typography>\n      </Box>\n    </Box>\n  );\n};\n","import { useState, useEffect } from \"react\";\n\nclass PersistentState {\n  constructor(key, initialValue) {\n    this.key = key;\n    this.initialValue = initialValue;\n    this.callbacks = [];\n  }\n\n  getValue = () => {\n    const value = JSON.parse(localStorage.getItem(this.key));\n    if (value === null) return this.initialValue;\n    return value;\n  };\n\n  _notifyAll = () => {\n    const value = this.getValue();\n    for (const cb of this.callbacks) {\n      cb(value);\n    }\n  };\n\n  registerCallback = cb => {\n    if (!this.callbacks.includes(cb)) this.callbacks.push(cb);\n  };\n\n  unregisterCallback = cb => {\n    const index = this.callbacks.indexOf(cb);\n    if (index >= 0) {\n      this.callbacks.splice(index, 1);\n    }\n  };\n\n  setValue = value => {\n    if (value == null) {\n      localStorage.removeItem(this.key);\n    } else {\n      localStorage.setItem(this.key, JSON.stringify(value));\n    }\n\n    this._notifyAll();\n  };\n\n  use = () => {\n    const [value, setValue] = useState(this.getValue);\n\n    useEffect(() => {\n      const cb = newValue => {\n        // trigger component update on change\n        setValue(newValue);\n      };\n\n      this.registerCallback(cb);\n      return () => this.unregisterCallback(cb);\n    }, []);\n\n    return [value, this.setValue];\n  };\n}\n\nexport const registerPersistentState = (name, initialValue) => {\n  return new PersistentState(name, initialValue);\n};\n","import { registerPersistentState } from \"./PersistentState\";\n\n// Keys\nexport const Settings = {\n  PATH_LENGTH: \"PATH_LENGTH\",\n  LIMIT_PATHS: \"LIMIT_PATHS\",\n  LOW_LATENCY: \"LOW_LATENCY\",\n  ANIMATION_DELAY: \"ANIMATION_DELAY\",\n  FPS_LIMIT: \"FPS_LIMIT\",\n  FPS_RATE: \"FPS_RATE\",\n  GPS_ENABLED: \"GPS_ENABLED\"\n};\n\n// Wrapper for simplification\nconst createSetting = (key, value) =>\n  registerPersistentState(\"SETTINGS_\" + key, value);\n\n// Settings objects\nconst settingsObjects = {\n  PATH_LENGTH: createSetting(Settings.PATH_LENGTH, 15),\n  LIMIT_PATHS: createSetting(Settings.LIMIT_PATHS, false),\n  LOW_LATENCY: createSetting(Settings.LOW_LATENCY, false),\n  ANIMATION_DELAY: createSetting(Settings.ANIMATION_DELAY, 80),\n  FPS_LIMIT: createSetting(Settings.FPS_LIMIT, true),\n  FPS_RATE: createSetting(Settings.FPS_RATE, 10),\n  GPS_ENABLED: createSetting(Settings.GPS_ENABLED, true)\n};\n\nexport const getSetting = key => settingsObjects[key];\n\nexport const resetAllSettings = () => {\n  Object.values(settingsObjects).forEach(settingsObj =>\n    settingsObj.setValue(null)\n  );\n};\n","import { ConnectionState } from \"./XContestInterface\";\nimport { getSetting, Settings } from \"../../common/PersistentState/Settings\";\n\nexport default class XContestSocket {\n  constructor(\n    onStateChanged,\n    onInfoMessage,\n    onTracklogMessage,\n    onFlightLanded\n  ) {\n    this.setConnectionState = onStateChanged;\n    this.dispatchInfoMessage = onInfoMessage;\n    this.dispatchTracklogMessage = onTracklogMessage;\n    this.dispatchFlightLandedMessage = onFlightLanded;\n    this.subscribedFlights = [];\n    this.connect();\n    this.connected = false;\n\n    // Register hooks, so we get notified when these settings change\n    getSetting(Settings.PATH_LENGTH).registerCallback(\n      this.refreshSubscribedFlights\n    );\n    getSetting(Settings.LIMIT_PATHS).registerCallback(\n      this.refreshSubscribedFlights\n    );\n  }\n\n  connect() {\n    if (\"WebSocket\" in window) {\n      this.connected = false;\n      this.setConnectionState(ConnectionState.CONNECTING);\n      this.sock = new WebSocket(\"wss://live.xcontest.org/websock/webclient\");\n      this.sock.onopen = this.onOpen;\n      this.sock.onmessage = this.onMessage;\n      this.sock.onclose = this.onClose;\n      this.sock.onerror = this.onError;\n    } else {\n      this.setConnectionState(ConnectionState.ERROR);\n      // The browser doesn't support WebSocket\n      alert(\"WebSocket NOT supported by your Browser!\");\n    }\n  }\n\n  formatSubscribedFlights = () => {\n    const formattedFlights = this.subscribedFlights.map(\n      ([flightId, startTimestamp]) => {\n        const startIsoTime =\n          startTimestamp === null\n            ? null\n            : new Date(1000 * startTimestamp).toISOString();\n        return { flightUuid: flightId, start: startIsoTime };\n      }\n    );\n\n    return formattedFlights;\n  };\n\n  refreshSubscribedFlights = () => {\n    if (this.sock.readyState === WebSocket.OPEN && this.connected) {\n      const formattedSubscribedFlights = this.formatSubscribedFlights();\n\n      this.sock.send(\n        JSON.stringify({\n          tag: \"WebFollow\",\n          contents: formattedSubscribedFlights\n        })\n      );\n    }\n  };\n\n  setSubscribedFlights = flights => {\n    this.subscribedFlights = flights;\n    this.refreshSubscribedFlights();\n  };\n\n  onOpen = () => {\n    this.handleReset();\n    console.debug(\"WebSocket: Open!\");\n    this.setConnectionState(ConnectionState.ESTABLISHED);\n    this.connected = true;\n\n    // Set area filter to the entire world\n    this.sock.send(\n      JSON.stringify({\n        tag: \"WebFilterArea\",\n        area: [{ lat: -90, lon: -180 }, { lat: 90, lon: 180 }]\n      })\n    );\n\n    // Use current 'fake' contest that is valid for the current alpha phase.\n    // Primarily sent to match the messages from their reverse engineered websocket\n    this.sock.send(\n      JSON.stringify({ tag: \"WebFilterContest\", contents: \"alpha9999\" })\n    );\n\n    // Tell the webserver which flights we want in more detail. TODO.\n    const formattedSubscribedFlights = this.formatSubscribedFlights();\n    this.sock.send(\n      JSON.stringify({\n        tag: \"WebFollow\",\n        contents: formattedSubscribedFlights\n      })\n    );\n  };\n\n  onMessage = evt => {\n    console.debug(\"WebSocket: Message!\");\n    this.setConnectionState(ConnectionState.ACTIVE);\n\n    let msg = JSON.parse(evt.data);\n\n    // Expect the next message in 60 seconds. If not, change the status message.\n    clearTimeout(this.watchdog);\n    this.watchdog = setTimeout(() => {\n      this.setConnectionState(ConnectionState.INACTIVE);\n    }, 70000);\n\n    // Process the message\n    this.processMessage(msg);\n  };\n\n  onClose = evt => {\n    this.connected = false;\n    console.debug(\"WebSocket: Close!\");\n    this.setConnectionState(ConnectionState.NO_CONNECTION);\n    // websocket is closed.\n    setTimeout(this.connect.bind(this), 1000);\n  };\n\n  onError = evt => {\n    this.connected = false;\n    console.debug(\"WebSocket: Error!\");\n  };\n\n  // Message Processing\n  handleReset = () => {\n    console.log(\"TODO: handle reset!\");\n  };\n  processMessage = msg => {\n    if (!(\"tag\" in msg)) {\n      console.warn(\"Warning: Invalid message format!\", msg);\n      return;\n    }\n    switch (msg.tag) {\n      case \"LiveFlightInfos\":\n        this.dispatchInfoMessage(msg.contents);\n        break;\n      case \"LiveFlightChunk\":\n        this.dispatchTracklogMessage(msg);\n        break;\n      case \"LiveFlightLanded\":\n        this.dispatchFlightLandedMessage(msg.flightUuid);\n        break;\n      default:\n        console.warn(`Warning: Unknown message tag '${msg.tag}'!`, msg);\n    }\n  };\n}\n","import { registerPersistentState } from \"./PersistentState\";\n\nconst persistentChosenPilots = registerPersistentState(\"chosen-pilots\", {});\n\nexport const getChosenPilotsObject = () => persistentChosenPilots;\n\nexport function getChosenPilots() {\n  return persistentChosenPilots.getValue();\n}\n\nexport function useChosenPilots() {\n  const [chosenPilots, setChosenPilots] = persistentChosenPilots.use();\n\n  // Add new pilots\n  const addPilots = pilotIds => {\n    const newPilotState = { ...chosenPilots };\n\n    let changed = false;\n    for (const pilotId of pilotIds) {\n      if (!(pilotId in newPilotState)) {\n        newPilotState[pilotId] = null;\n        changed = true;\n      }\n    }\n\n    if (changed) {\n      setChosenPilots(newPilotState);\n    }\n  };\n\n  // Remove pilots\n  const removePilots = pilotIds => {\n    const newPilotState = { ...chosenPilots };\n\n    let changed = false;\n    for (const pilotId of pilotIds) {\n      if (pilotId in newPilotState) {\n        delete newPilotState[pilotId];\n        changed = true;\n      }\n    }\n\n    if (changed) {\n      setChosenPilots(newPilotState);\n    }\n  };\n\n  return [chosenPilots, addPilots, removePilots];\n}\n","export const lerp = (val1, val2, pct) => {\n  if (val2 === null) {\n    return val1;\n  }\n  if (val1 === null) {\n    return val2;\n  }\n  return (1.0 - pct) * val1 + pct * val2;\n};\n\n// Important:\n// t0<t1<t2<t3 and t1<=t<=t2\nexport const spline = (p0, t0, p1, t1, p2, t2, p3, t3, t) => {\n  // Make timestamps relative.\n  // This enables us to handle unix timestamps (large numbers)\n  t1 -= t0;\n  t2 -= t0;\n  t3 -= t0;\n  t -= t0;\n  t0 = 0;\n\n  const A1 = ((p1 - p0) * t + p0 * t1 - p1 * t0) / (t1 - t0);\n  const A2 = ((p2 - p1) * t + p1 * t2 - p2 * t1) / (t2 - t1);\n  const A3 = ((p3 - p2) * t + p2 * t3 - p3 * t2) / (t3 - t2);\n\n  const B1 = ((A2 - A1) * t + A1 * t2 - A2 * t0) / (t2 - t0);\n  const B2 = ((A3 - A2) * t + A2 * t3 - A3 * t1) / (t3 - t1);\n\n  const C = ((B2 - B1) * t + B1 * t2 - B2 * t1) / (t2 - t1);\n\n  return C;\n};\n\nexport const splineDerivative = (p0, t0, p1, t1, p2, t2, p3, t3, t) => {\n  // Make timestamps relative.\n  // This enables us to handle unix timestamps (large numbers)\n  t1 -= t0;\n  t2 -= t0;\n  t3 -= t0;\n  t -= t0;\n  t0 = 0;\n\n  const A1 = ((p1 - p0) * t + p0 * t1 - p1 * t0) / (t1 - t0);\n  const A2 = ((p2 - p1) * t + p1 * t2 - p2 * t1) / (t2 - t1);\n  const A3 = ((p3 - p2) * t + p2 * t3 - p3 * t2) / (t3 - t2);\n\n  const A1d = (p1 - p0) / (t1 - t0);\n  const A2d = (p2 - p1) / (t2 - t1);\n  const A3d = (p3 - p2) / (t3 - t2);\n\n  const B1 = ((A2 - A1) * t + A1 * t2 - A2 * t0) / (t2 - t0);\n  const B2 = ((A3 - A2) * t + A2 * t3 - A3 * t1) / (t3 - t1);\n\n  const B1d = (A2d * t + A2 - A1d * t - A1 + A1d * t2 - A2d * t0) / (t2 - t0);\n  const B2d = (A3d * t + A3 - A2d * t - A2 + A2d * t3 - A3d * t1) / (t3 - t1);\n\n  const Cd = (B2d * t + B2 - B1d * t - B1 + B1d * t2 - B2d * t1) / (t2 - t1);\n\n  return Cd;\n};\n\n// Interpolates between points p1 and p2\nexport const uniformspline = (p0, p1, p2, p3, pct) => {\n  //return 0.5*pct*pct*pct*(p3-3*p2+3*p1-p0) + 0.5*pct*pct*(2*p0-5*p1+4*p2-p3) + 0.5*pct*(p2-p0) + p1;\n  return (\n    pct *\n      (pct *\n        (pct * (p3 - 3 * p2 + 3 * p1 - p0) + 2 * p0 - 5 * p1 + 4 * p2 - p3) +\n        p2 -\n        p0) *\n      0.5 +\n    p1\n  );\n};\n\nexport const uniformsplineDerivative = (p0, p1, p2, p3, pct) => {\n  //return 1.5*pct*pct*(p3-3*p2+3*p1-p0) + pct*(2*p0-5*p1+4*p2-p3) + 0.5*(p2-p0);\n  return (\n    0.5 *\n    (pct *\n      (3 * pct * (p3 - 3 * p2 + 3 * p1 - p0) +\n        4 * p0 -\n        10 * p1 +\n        8 * p2 -\n        2 * p3) +\n      p2 -\n      p0)\n  );\n};\n","export default class RunningDerivation {\n  constructor(\n    smoothingFactor,\n    derivation_func = (a, b) => b - a,\n    invalid_func = a => a === null\n  ) {\n    this.computeDiff = derivation_func;\n    this.isInvalid = invalid_func;\n    this.old_val = null;\n    this.old_t = null;\n    this.running_avg = null;\n    this.smoothingFactor = smoothingFactor;\n  }\n\n  update(new_val, new_t) {\n    if (\n      this.old_val === null ||\n      new_val === null ||\n      this.old_t === null ||\n      new_t === null ||\n      this.isInvalid(this.old_val) ||\n      this.isInvalid(new_val) ||\n      this.old_t === this.new_t\n    ) {\n      this.old_val = new_val;\n      this.old_t = new_t;\n      return null;\n    }\n\n    let dt = new_t - this.old_t;\n    let diff = this.computeDiff(this.old_val, new_val);\n    let deriv = diff / dt;\n\n    let weight = Math.pow(this.smoothingFactor, dt);\n    if (this.running_avg === null) {\n      this.running_avg = deriv;\n    } else {\n      this.running_avg = weight * this.running_avg + (1.0 - weight) * deriv;\n    }\n\n    this.old_val = new_val;\n    this.old_t = new_t;\n    return this.running_avg;\n  }\n\n  reset() {\n    this.old_val = null;\n    this.old_t = null;\n    this.running_avg = null;\n  }\n}\n","const findBisect = (targetValue, length, dataFn) => {\n  if (length < 1) return 0;\n\n  let minIndex = -1;\n  let maxIndex = length;\n  let currentIndex = 0;\n  let currentValue = null;\n\n  while (minIndex < maxIndex - 1) {\n    currentIndex = ((minIndex + maxIndex) / 2) | 0;\n    currentValue = dataFn(currentIndex);\n\n    if (currentValue < targetValue) {\n      minIndex = currentIndex;\n    } else {\n      maxIndex = currentIndex;\n    }\n  }\n\n  return maxIndex;\n};\n\nexport default findBisect;\n","import RunningDerivation from \"../../util/RunningDerivation\";\nimport { getDistance } from \"geolib\";\nimport findBisect from \"../../util/FindBisect\";\n\nexport const parseTime = isoStr => {\n  return Math.round(Date.parse(isoStr) / 1000);\n};\n\nexport default class FlightAnimationData {\n  constructor() {\n    this.data = [];\n    this.counter_gpsVario = new RunningDerivation(0.7);\n    this.counter_baroVarion = new RunningDerivation(0.7);\n    this.counter_velocity = new RunningDerivation(\n      0.7,\n      (start, end) => getDistance(start, end, 0.01),\n      () => false\n    );\n  }\n\n  at = index => this.data[index];\n\n  clear() {\n    // reset everything\n    this.data = [];\n    this.counter_gpsVario = new RunningDerivation(0.7);\n    this.counter_baroVarion = new RunningDerivation(0.7);\n    this.counter_velocity = new RunningDerivation(\n      0.7,\n      (start, end) => getDistance(start, end, 0.01),\n      () => false\n    );\n  }\n\n  get length() {\n    return this.data.length;\n  }\n\n  isAfterLastElement(timestamp) {\n    if (this.data.length <= 0) return true;\n    return this.data[this.data.length - 1].t < timestamp;\n  }\n\n  append(data) {\n    for (const elem of data) {\n      const timestamp = parseTime(elem.timestamp);\n      const pos = { lat: elem.lat, lng: elem.lon };\n\n      const baroAlt = elem.baroAlt === 0 ? null : elem.baroAlt;\n      const gpsAlt = elem.gpsAlt === 0 ? null : elem.gpsAlt;\n\n      // Compute new running average values\n      const gpsVario = this.counter_gpsVario.update(gpsAlt, timestamp);\n      const baroVario = this.counter_baroVarion.update(baroAlt, timestamp);\n      const velocity = this.counter_velocity.update(pos, timestamp);\n\n      const newElem = {\n        baroAlt: baroAlt,\n        gpsAlt: gpsAlt,\n        elevation: elem.elevation,\n        pos: pos,\n        gpsVario: gpsVario,\n        baroVario: baroVario,\n        velocity: velocity,\n        t: timestamp\n      };\n      this.data.push(newElem);\n    }\n  }\n\n  replace(data) {\n    this.clear();\n    this.append(data);\n  }\n\n  insert(data) {\n    const newElements = [];\n    for (const elem of data) {\n      const timestamp = parseTime(elem.timestamp);\n      const pos = { lat: elem.lat, lng: elem.lon };\n      const baroAlt = elem.baroAlt === 0 ? null : elem.baroAlt;\n      const gpsAlt = elem.gpsAlt === 0 ? null : elem.gpsAlt;\n\n      const newElem = {\n        baroAlt: baroAlt,\n        gpsAlt: gpsAlt,\n        elevation: elem.elevation,\n        pos: pos,\n        gpsVario: null,\n        baroVario: null,\n        velocity: null,\n        t: timestamp\n      };\n      newElements.push(newElem);\n    }\n\n    // Merge\n    const oldElements = this.data;\n    this.data = [];\n\n    let oldPos = 0;\n    let newPos = 0;\n\n    while (true) {\n      if (oldPos >= oldElements.length && newPos >= newElements.length) break;\n      else if (oldPos >= oldElements.length) {\n        this.data.push(newElements[newPos]);\n        newPos += 1;\n      } else if (newPos >= newElements.length) {\n        this.data.push(oldElements[oldPos]);\n        oldPos += 1;\n      } else {\n        const oldEl = oldElements[oldPos];\n        const newEl = newElements[newPos];\n\n        if (newEl.t < oldEl.t) {\n          this.data.push(newEl);\n          newPos += 1;\n        } else if (oldEl.t < newEl.t) {\n          this.data.push(oldEl);\n          oldPos += 1;\n        } else {\n          this.data.push(newEl);\n          oldPos += 1;\n          newPos += 1;\n        }\n      }\n    }\n\n    // Re-compute derivatives\n    this.counter_gpsVario.reset();\n    this.counter_baroVarion.reset();\n    this.counter_velocity.reset();\n    for (let elem of this.data) {\n      const gpsVario = this.counter_gpsVario.update(elem.gpsAlt, elem.t);\n      const baroVario = this.counter_baroVarion.update(elem.baroAlt, elem.t);\n      const velocity = this.counter_velocity.update(elem.pos, elem.t);\n\n      elem.gpsVario = gpsVario;\n      elem.baroVario = baroVario;\n      elem.velocity = velocity;\n    }\n  }\n\n  findBisect = timestamp => {\n    return findBisect(timestamp, this.data.length, pos => this.data[pos].t);\n  };\n\n  findForwardSwipe = (timestamp, startPos) => {\n    let pos = startPos;\n    while (pos < this.data.length && this.data[pos].t < timestamp) {\n      pos += 1;\n    }\n    return pos;\n  };\n\n  getNewestTimestamp = () => {\n    if (this.data.length < 1) return null;\n    return this.data[this.data.length - 1].t;\n  };\n}\n","import { lerp, splineDerivative, spline } from \"../../util/Interpolation\";\nimport FlightAnimationData, { parseTime } from \"./FlightAnimationData\";\nimport { getSetting, Settings } from \"../../common/PersistentState/Settings\";\n\nclass FlightAnimationDataCache {\n  // IMPORTANT ASSUMPTION IN THIS ENTIRE FILE:\n  // While the cache exists, new data gets only appended. Whenever existing data changes, the cache\n  // will be invalidated.\n  // I.E., chache invariants:\n  //    - existing data entries don't change, indices always point to the same data\n  //    - data timestamps are monotonic rising, meaning, to get newer data the data array only\n  //      needs to be traversed in forward direction, never backwards.\n  // This enables efficient caching and O(1) lookup times.\n  constructor() {\n    this.currentArrayPos = null;\n    this.mapsPath = [];\n    this.mapsPathNewestPos = 0;\n  }\n\n  reset = () => {\n    this.currentArrayPos = null;\n    this.mapsPath = [];\n    this.mapsPathNewestPos = 0;\n  };\n}\n\nclass DataGens {\n  static fallbackData = flightInfos => {\n    return {\n      baroAlt: flightInfos.lastFix.baroAlt,\n      gpsAlt: flightInfos.lastFix.gpsAlt,\n      elevation: flightInfos.lastFix.elevation,\n      pos: {\n        lat: flightInfos.lastFix.lat,\n        lng: flightInfos.lastFix.lon\n      },\n      gpsVario: null,\n      baroVario: null,\n      velocity: null\n    };\n  };\n\n  static takeData(data) {\n    return {\n      baroAlt: data.baroAlt,\n      gpsAlt: data.gpsAlt,\n      elevation: data.elevation,\n      pos: {\n        lat: data.pos.lat,\n        lng: data.pos.lng\n      },\n      gpsVario: data.gpsVario,\n      baroVario: data.baroVario,\n      velocity: data.velocity\n    };\n  }\n\n  static blendData(data1, data2, timeStamp) {\n    const pct = (timeStamp - data1.t) / (data2.t - data1.t);\n    return {\n      baroAlt: lerp(data1.baroAlt, data2.baroAlt, pct),\n      gpsAlt: lerp(data1.gpsAlt, data2.gpsAlt, pct),\n      elevation: lerp(data1.elevation, data2.elevation, pct),\n      pos: {\n        lat: lerp(data1.pos.lat, data2.pos.lat, pct),\n        lng: lerp(data1.pos.lng, data2.pos.lng, pct)\n      },\n      gpsVario: lerp(data1.gpsVario, data2.gpsVario, pct),\n      baroVario: lerp(data1.baroVario, data2.baroVario, pct),\n      velocity: lerp(data1.velocity, data2.velocity, pct)\n    };\n  }\n\n  static blendDataSpline(data0, data1, data2, data3, timeStamp) {\n    const pct = (timeStamp - data1.t) / (data2.t - data1.t);\n    return {\n      baroAlt: lerp(data1.baroAlt, data2.baroAlt, pct),\n      gpsAlt: lerp(data1.gpsAlt, data2.gpsAlt, pct),\n      elevation: lerp(data1.elevation, data2.elevation, pct),\n      pos: {\n        lat: spline(\n          data0.pos.lat,\n          data0.t,\n          data1.pos.lat,\n          data1.t,\n          data2.pos.lat,\n          data2.t,\n          data3.pos.lat,\n          data3.t,\n          timeStamp\n        ),\n        lng: spline(\n          data0.pos.lng,\n          data0.t,\n          data1.pos.lng,\n          data1.t,\n          data2.pos.lng,\n          data2.t,\n          data3.pos.lng,\n          data3.t,\n          timeStamp\n        )\n      },\n      gpsVario: lerp(data1.gpsVario, data2.gpsVario, pct),\n      baroVario: lerp(data1.baroVario, data2.baroVario, pct),\n      velocity: lerp(data1.velocity, data2.velocity, pct)\n    };\n  }\n\n  static computeLinearVelocity(data1, data2) {\n    const t1 = data1.t;\n    const t2 = data2.t;\n    if (t1 === t2) return null;\n\n    const dT = t2 - t1;\n\n    const p1 = data1.pos;\n    const p2 = data2.pos;\n\n    const vLat = (p2.lat - p1.lat) / dT;\n    const vLng = (p2.lng - p1.lng) / dT;\n    return { lat: vLat, lng: vLng };\n  }\n\n  static computeSplineVelocity(d0, d1, d2, d3, t) {\n    const t0 = d0.t;\n    const t1 = d1.t;\n    const t2 = d2.t;\n    const t3 = d3.t;\n\n    const p0 = d0.pos;\n    const p1 = d1.pos;\n    const p2 = d2.pos;\n    const p3 = d3.pos;\n\n    const vLat = splineDerivative(\n      p0.lat,\n      t0,\n      p1.lat,\n      t1,\n      p2.lat,\n      t2,\n      p3.lat,\n      t3,\n      t\n    );\n\n    const vLng = splineDerivative(\n      p0.lng,\n      t0,\n      p1.lng,\n      t1,\n      p2.lng,\n      t2,\n      p3.lng,\n      t3,\n      t\n    );\n\n    return { lat: vLat, lng: vLng };\n  }\n}\n\nclass FlightAnimation {\n  constructor(flightInfos) {\n    // Live data\n    this.liveData = new FlightAnimationData();\n    this.liveDataCache = new FlightAnimationDataCache();\n\n    // Data from flight infos, used as fallback\n    this.flightInfos = null;\n    this.flightInfoData = new FlightAnimationData();\n    this.flightInfoDataCache = new FlightAnimationDataCache();\n\n    // 'landed' state\n    this.landed = flightInfos.landed;\n\n    // Set flight infos\n    this.updateInfos(flightInfos);\n\n    this.settings = {};\n    this.updateSettings();\n\n    // register settings hooks\n    getSetting(Settings.ANIMATION_DELAY).registerCallback(this.updateSettings);\n    getSetting(Settings.LOW_LATENCY).registerCallback(this.updateSettings);\n    getSetting(Settings.PATH_LENGTH).registerCallback(this.updateSettings);\n    getSetting(Settings.LIMIT_PATHS).registerCallback(this.updateSettings);\n  }\n\n  destroy = () => {\n    getSetting(Settings.ANIMATION_DELAY).unregisterCallback(\n      this.updateSettings\n    );\n    getSetting(Settings.LOW_LATENCY).unregisterCallback(this.updateSettings);\n    getSetting(Settings.PATH_LENGTH).unregisterCallback(this.updateSettings);\n    getSetting(Settings.LIMIT_PATHS).unregisterCallback(this.updateSettings);\n  };\n\n  updateSettings = () => {\n    this.settings = {\n      timeOffsetSeconds: getSetting(Settings.ANIMATION_DELAY).getValue(),\n      lowLatencyMode: getSetting(Settings.LOW_LATENCY).getValue(),\n      trackLengthMinutes: getSetting(Settings.PATH_LENGTH).getValue(),\n      limitTracks: getSetting(Settings.LIMIT_PATHS).getValue()\n    };\n    this.liveDataCache.reset();\n    this.flightInfoDataCache.reset();\n  };\n\n  updateInfos = infos => {\n    this.landed |= infos.landed;\n    this.flightInfos = infos;\n    this.flightInfoData.replace(infos.track);\n    this.flightInfoDataCache.reset();\n  };\n\n  updateData = data => {\n    if (data.length < 1) return;\n\n    // Compute start time\n    const data_start_time = parseTime(data[0].timestamp);\n    if (this.liveData.isAfterLastElement(data_start_time)) {\n      // If the new data is newer than everything in the existing data, append\n      this.liveData.append(data);\n    } else {\n      // Otherwise, merge\n      this.liveData.insert(data);\n\n      // Reset animation\n      this.liveDataCache.reset();\n    }\n  };\n\n  updateLanded = () => {\n    console.log(\"Received flight landed message!\");\n    this.landed = true;\n  };\n\n  getInterpolatedData = (data, cache, timeStamp) => {\n    if (data.length < 1) return null;\n\n    if (cache.currentArrayPos === null) {\n      cache.currentArrayPos = data.findBisect(timeStamp);\n    } else {\n      // Optimization because we assume that time runs forward and the next value is after the current value\n      cache.currentArrayPos = data.findForwardSwipe(\n        timeStamp,\n        cache.currentArrayPos\n      );\n    }\n\n    // Compute\n    let blendedData = null;\n    let endOfTrack = false;\n    let startOfTrack = false;\n    let velocityVec = null;\n    if (cache.currentArrayPos <= 0) {\n      // If the timestamp is before our track, return first element\n      blendedData = DataGens.takeData(data.at(0));\n      if (data.length >= 2) {\n        velocityVec = DataGens.computeLinearVelocity(data.at(0), data.at(1));\n      }\n      startOfTrack = true;\n    } else if (cache.currentArrayPos >= data.length) {\n      // If the timestamp is after our track, return last element\n      blendedData = DataGens.takeData(data.at(data.length - 1));\n      if (data.length >= 2) {\n        velocityVec = DataGens.computeLinearVelocity(\n          data.at(data.length - 2),\n          data.at(data.length - 1)\n        );\n      }\n      endOfTrack = true;\n    } else {\n      const data1 = data.at(cache.currentArrayPos - 1);\n      const data2 = data.at(cache.currentArrayPos);\n\n      const data0 =\n        cache.currentArrayPos - 2 >= 0\n          ? data.at(cache.currentArrayPos - 2)\n          : {\n              ...data1,\n              t: data1.t - 1\n            };\n\n      const data3 =\n        cache.currentArrayPos + 1 < data.length\n          ? data.at(cache.currentArrayPos + 1)\n          : {\n              ...data2,\n              t: data2.t + 1\n            };\n\n      // Blend via spline\n      blendedData = DataGens.blendDataSpline(\n        data0,\n        data1,\n        data2,\n        data3,\n        timeStamp\n      );\n      velocityVec = DataGens.computeSplineVelocity(\n        data0,\n        data1,\n        data2,\n        data3,\n        timeStamp\n      );\n    }\n\n    const newestDataTimestamp = data.at(data.length - 1).t;\n\n    return [\n      blendedData,\n      startOfTrack,\n      endOfTrack,\n      newestDataTimestamp,\n      velocityVec\n    ];\n  };\n\n  getFallbackData = () => {\n    return [\n      DataGens.fallbackData(this.flightInfos),\n      false,\n      this.flightInfos.landed,\n      parseTime(this.flightInfos.lastFix.timestamp),\n      null\n    ];\n  };\n\n  computeTrack = (data, cache, timestamp) => {\n    if (data.length < 1) return null;\n\n    const oldestTimestamp = timestamp - this.settings.trackLengthMinutes * 60;\n\n    let track = cache.mapsPath;\n\n    // Append new data\n    while (\n      cache.mapsPathNewestPos < data.length &&\n      data.at(cache.mapsPathNewestPos).t < timestamp\n    ) {\n      const elem = data.at(cache.mapsPathNewestPos);\n      track.push({\n        lat: elem.pos.lat,\n        lng: elem.pos.lng,\n        timestamp: elem.t,\n        elevation: elem.gpsAlt\n      });\n      cache.mapsPathNewestPos += 1;\n    }\n\n    // Delete old data\n    if (this.settings.limitTracks) {\n      const removeChunkSize = 32;\n      let numRemove = 0;\n      while (\n        numRemove + removeChunkSize - 1 < track.length &&\n        track[numRemove + removeChunkSize - 1].timestamp < oldestTimestamp\n      ) {\n        numRemove += removeChunkSize;\n      }\n      if (numRemove > 0) {\n        track = track.slice(numRemove);\n        cache.mapsPath = track;\n      }\n    }\n\n    return track;\n  };\n\n  updateAnimation = animationTimeMillis => {\n    const animationTimeSeconds = this.settings.lowLatencyMode\n      ? animationTimeMillis / 1000\n      : animationTimeMillis / 1000 - this.settings.timeOffsetSeconds;\n\n    let animationResult = this.getInterpolatedData(\n      this.liveData,\n      this.liveDataCache,\n      animationTimeSeconds\n    );\n    if (!animationResult) {\n      animationResult = this.getInterpolatedData(\n        this.flightInfoData,\n        this.flightInfoDataCache,\n        animationTimeSeconds\n      );\n    }\n    if (!animationResult) {\n      animationResult = this.getFallbackData();\n    }\n\n    let track = this.computeTrack(\n      this.liveData,\n      this.liveDataCache,\n      animationTimeSeconds\n    );\n    if (!track) {\n      track = this.computeTrack(\n        this.flightInfoData,\n        this.flightInfoDataCache,\n        animationTimeSeconds\n      );\n    }\n    if (!track) {\n      track = [];\n    }\n\n    let [\n      blendedData,\n      startOfTrack,\n      endOfTrack,\n      newestDataTimestamp,\n      velocityVec\n    ] = animationResult;\n\n    // Special case for endOfTrack for lowLatencyMode\n    if (this.settings.lowLatencyMode) {\n      if (this.landed) {\n        // If 'landed' got signalled, immediately also end the track,\n        // as the 'landed' signal comes simultaneously to the last track message\n        endOfTrack = true;\n      } else {\n        // Otherwise, determine by how long ago we last heard from the pilot whether\n        // the track is broken or not.\n        // Has to be treated different than the default case, because in lowLatencyMode we\n        // are always at the end of the track.\n        endOfTrack = newestDataTimestamp < animationTimeSeconds - 80;\n      }\n    }\n\n    const result = {\n      ...blendedData,\n      startOfTrack: startOfTrack,\n      endOfTrack: endOfTrack,\n      landed: this.landed,\n      newestDataTimestamp: newestDataTimestamp,\n      track: track,\n      velocityVec: velocityVec\n    };\n\n    return result;\n  };\n\n  getNewestTimestamp = () => this.liveData.getNewestTimestamp();\n}\n\nexport default FlightAnimation;\n","class HighPrecisionTimeSync {\n  // Tolerance should be larger than the duration of one animation frame.\n  // Most animations are 60Hz, meaning 16ms, so 20ms is fine.\n  constructor(tolerance = 20) {\n    this.offset = 0.0;\n    this.tolerance = tolerance;\n  }\n\n  get = (currentHighPrecisionTime, currentTime) => {\n    let estimatedTime = currentHighPrecisionTime + this.offset;\n    const offBy = estimatedTime - currentTime;\n\n    if (offBy > this.tolerance || offBy < -this.tolerance) {\n      this.offset -= offBy;\n      estimatedTime = currentHighPrecisionTime + this.offset;\n    }\n\n    return estimatedTime;\n  };\n}\n\nexport default HighPrecisionTimeSync;\n","import {\n  getChosenPilots,\n  getChosenPilotsObject\n} from \"../../common/PersistentState/ChosenPilots\";\nimport FlightAnimation from \"./FlightAnimation\";\nimport HighPrecisionTimeSync from \"../../util/HighPrecisionTimeSync\";\nimport { Settings, getSetting } from \"../../common/PersistentState/Settings\";\n\nfunction eqSet(as, bs) {\n  if (as.size !== bs.size) return false;\n  for (const a of as) if (!bs.has(a)) return false;\n  return true;\n}\n\nexport default class XContestAnimation {\n  constructor(setSubscribedFlights) {\n    this._currentAnimationData = {};\n    this._callbacks = [];\n    this._subscribedPilots = getChosenPilots();\n    this._subscribedFlights = new Set();\n    this._pilotInfos = {};\n    this._flightAnimations = {};\n    this._highPrecisionTimeSync = new HighPrecisionTimeSync();\n    const settings_limitFps = getSetting(Settings.FPS_LIMIT);\n    const settings_fps = getSetting(Settings.FPS_RATE);\n\n    // Cached settings values for performance improvements. Not sure if actually worth\n    this._setting_limitFps = settings_limitFps.getValue();\n    this._setting_fps = settings_fps.getValue();\n    settings_limitFps.registerCallback(value => {\n      this._setting_limitFps = value;\n    });\n    settings_fps.registerCallback(value => {\n      this._setting_fps = value;\n    });\n\n    this._setSubscribedFlightsCallback = flights => {\n      setSubscribedFlights(Array.from(flights));\n    };\n    getChosenPilotsObject().registerCallback(this.setSubscribedPilots);\n    requestAnimationFrame(this.animationLoop);\n  }\n\n  // Animation loop\n  _nextUpdate = Date.now();\n  animationLoop = () => {\n    // Can't use time of function parameter, because we need absolute time\n    const absTime = Date.now();\n\n    const frameTimeDelta = 1000.0 / this._setting_fps;\n\n    if (!this._setting_limitFps || absTime >= this._nextUpdate) {\n      if (this._setting_limitFps) {\n        this._nextUpdate += frameTimeDelta;\n        if (absTime > this._nextUpdate) {\n          this._nextUpdate = absTime;\n        }\n      }\n\n      const newAnimationData = {};\n      Object.keys(this._subscribedPilots).forEach(pilot => {\n        if (pilot in this._pilotInfos) {\n          const flightId = this._pilotInfos[pilot].flightId;\n          if (flightId in this._flightAnimations) {\n            const flightAnim = this._flightAnimations[flightId];\n            newAnimationData[pilot] = flightAnim.updateAnimation(absTime);\n          }\n        }\n      });\n      this._submitAnimationFrame(newAnimationData);\n    }\n    requestAnimationFrame(this.animationLoop);\n  };\n\n  _submitAnimationFrame = data => {\n    this._currentAnimationData = data;\n    for (const cb of this._callbacks) {\n      cb(data);\n    }\n  };\n\n  // External\n  setSubscribedPilots = subscribedPilots => {\n    this._subscribedPilots = subscribedPilots;\n    this._updateImportantFlights();\n  };\n\n  pushNewInfo = pilotInfo => {\n    console.log(\"newInfo: \", pilotInfo);\n    this._pilotInfos = pilotInfo;\n    this._updateImportantFlights();\n\n    // Update flight info in flightAnimations\n    Object.values(pilotInfo).forEach(flightInfo => {\n      const flightId = flightInfo.flightId;\n      if (flightId in this._flightAnimations) {\n        this._flightAnimations[flightId].updateInfos(flightInfo);\n      }\n    });\n  };\n\n  pushNewData = (trackId, trackData) => {\n    console.log(\"newTrackdata: \", trackId, trackData);\n    if (trackId in this._flightAnimations)\n      this._flightAnimations[trackId].updateData(trackData);\n  };\n\n  pushFlightLanded = flightId => {\n    if (flightId in this._flightAnimations)\n      this._flightAnimations[flightId].updateLanded();\n  };\n\n  // callback gets called every frame with new data\n  registerCallback = cb => {\n    if (!this._callbacks.includes(cb)) this._callbacks.push(cb);\n    cb(this._currentAnimationData);\n  };\n\n  unregisterCallback = cb => {\n    const index = this._callbacks.indexOf(cb);\n    if (index >= 0) {\n      this._callbacks.splice(index, 1);\n    }\n  };\n\n  getData = () => {\n    return this._currentAnimationData;\n  };\n\n  // Internal\n  _updateImportantFlights = () => {\n    // Filter important flights\n    let importantFlights = {};\n    Object.values(this._pilotInfos)\n      .filter(val => val.info.user.username in this._subscribedPilots)\n      .forEach(val => {\n        importantFlights[val.flightId] = val;\n      });\n\n    let importantFlightSet = new Set(Object.keys(importantFlights));\n\n    // Cleanup old entries of _flightAnimations\n    {\n      const toRemove = [];\n      for (const flightId in this._flightAnimations) {\n        if (!(flightId in importantFlights)) {\n          toRemove.push(flightId);\n        }\n      }\n      for (const flightId of toRemove) {\n        console.log(\"Removing flightAnimation of '\" + flightId + \"' ...\");\n        this._flightAnimations[flightId].destroy();\n        delete this._flightAnimations[flightId];\n      }\n    }\n\n    // Add new flightAnimations\n    Object.entries(importantFlights).forEach(([flightId, flightInfo]) => {\n      if (!(flightId in this._flightAnimations)) {\n        this._flightAnimations[flightId] = new FlightAnimation(flightInfo);\n      }\n    });\n\n    // Send subscription change to socket\n    if (!eqSet(importantFlightSet, this._subscribedFlights)) {\n      this._subscribedFlights = importantFlightSet;\n\n      // Get the timestamp of the newest track element, to prevent loading the same data multiple times\n      let flightsWithTimestamps = [];\n      console.log(this._flightAnimations);\n      importantFlightSet.forEach(flightId => {\n        console.log(flightId, this._flightAnimations[flightId]);\n        flightsWithTimestamps.push([\n          flightId,\n          this._flightAnimations[flightId].getNewestTimestamp()\n        ]);\n      });\n\n      console.log(\n        \"Changing flight subscribtion: \",\n        this._subscribedFlights,\n        importantFlightSet\n      );\n      this._setSubscribedFlightsCallback(flightsWithTimestamps);\n    }\n  };\n}\n","import { useState, useEffect } from \"react\";\n\nclass EventfulState {\n  constructor(initialValue) {\n    this._callbacks = [];\n    this._callbackData = initialValue;\n  }\n\n  set = value => {\n    this._callbackData = value;\n    for (const cb of this._callbacks) {\n      cb(value);\n    }\n  };\n\n  getValue = () => this._callbackData;\n\n  registerCallback = cb => {\n    if (!this._callbacks.includes(cb)) this._callbacks.push(cb);\n  };\n\n  unregisterCallback = cb => {\n    const index = this._callbacks.indexOf(cb);\n    if (index >= 0) {\n      this._callbacks.splice(index, 1);\n    }\n  };\n\n  use = () => {\n    const [value, setValue] = useState(this._callbackData);\n\n    useEffect(() => {\n      // trigger component update on change\n      this.registerCallback(setValue);\n      return () => this.unregisterCallback(setValue);\n    }, []);\n\n    return value;\n  };\n}\n\nexport default EventfulState;\n","import XContestSocket from \"./XContestSocket\";\nimport XContestAnimation from \"./XContestAnimation\";\nimport EventfulState from \"../../util/EventfulState\";\n\nexport const ConnectionState = {\n  CONNECTING: \"connecting\", //orange\n  ERROR: \"error\", //red\n  ESTABLISHED: \"established\", //yellow\n  ACTIVE: \"active\", //green\n  INACTIVE: \"inactive\", //orange\n  NO_CONNECTION: \"no connection\", //red\n  NO_INFORMATION: \"no information\" //gray\n};\n\nclass XContestInterface {\n  constructor() {\n    this.pilots = [];\n    this.connectionState = new EventfulState(ConnectionState.NO_INFORMATION);\n    this.pilotInfos = new EventfulState([]);\n    this.socket = new XContestSocket(\n      this.onConnectionStateChanged,\n      this.onInfoMessageReceived,\n      this.onTracklogMessageReceived,\n      this.onFlightLandedMessageReceived\n    );\n    this.animation = new XContestAnimation(this.setSubscribedFlights);\n  }\n\n  setSubscribedFlights = flights => {\n    this.socket.setSubscribedFlights(flights);\n  };\n\n  getPilotInfos = () => this.pilots;\n\n  onConnectionStateChanged = state => {\n    this.connectionState.set(state);\n  };\n\n  onInfoMessageReceived = msg => {\n    this.pilots = {};\n    for (const [trackId, track] of msg) {\n      // Skip if we have a newer track of the same person\n      if (track.overriden) continue;\n\n      track.flightId = trackId;\n\n      this.pilots[track.info.user.username] = track;\n    }\n    this.animation.pushNewInfo(this.pilots);\n    this.pilotInfos.set(this.pilots);\n  };\n\n  onTracklogMessageReceived = msg => {\n    this.animation.pushNewData(msg.flightUuid, msg.trackChunk);\n  };\n\n  onFlightLandedMessageReceived = flightId => {\n    this.animation.pushFlightLanded(flightId);\n  };\n}\n\n// Singleton stuff\nlet _instance = null;\nexport const getXContestInterface = () => {\n  if (!_instance) {\n    _instance = new XContestInterface();\n  }\n  return _instance;\n};\n\nexport const useXContestPilots = () => getXContestInterface().pilotInfos.use();\nexport const useXContestConnectionState = () =>\n  getXContestInterface().connectionState.use();\n","import { getPilotIcon } from \"../common/PilotIcon\";\n\nexport default class GoogleMapsTrack {\n  constructor(google, map, pilotInfo, initialData) {\n    this.google = google;\n    this.marker = new this.google.maps.Marker({\n      map: map,\n      position: initialData.pos,\n      title: pilotInfo.info.user.fullname\n    });\n    this.track = new this.google.maps.Polyline({\n      map: map,\n      path: []\n    });\n    this.currentTrackVersion = { startTime: null, endTime: null, length: null };\n    this.newestTrackSegment = new this.google.maps.Polyline({\n      map: map,\n      path: []\n    });\n  }\n\n  setMap = map => {\n    this.marker.setMap(map);\n    this.track.setMap(map);\n    this.newestTrackSegment.setMap(map);\n  };\n\n  _updateTrack = track => {\n    if (!track || track.length < 1) return;\n\n    // Compute identifiers to reduce the amount if maps updates\n    const length = track.length;\n    const startTime = track[0].timestamp;\n    const endTime = track[length - 1].timestamp;\n    if (\n      startTime === this.currentTrackVersion.startTime &&\n      endTime === this.currentTrackVersion.endTime &&\n      length === this.currentTrackVersion.length\n    ) {\n      return;\n    }\n\n    // If the start/end time or length changed, update track in map\n    this.currentTrackVersion.startTime = startTime;\n    this.currentTrackVersion.endTime = endTime;\n    this.currentTrackVersion.length = length;\n\n    this.track.setPath(track);\n  };\n\n  updateData = data => {\n    this.marker.setPosition(data.pos);\n    this.marker.setIcon(\n      getPilotIcon(\n        this.google,\n        data.startOfTrack,\n        data.endOfTrack,\n        data.landed,\n        data.pos,\n        data.velocityVec,\n        \"#0f0\"\n      )\n    );\n    if (data.track.length > 0) {\n      this.newestTrackSegment.setPath([\n        data.track[data.track.length - 1],\n        data.pos\n      ]);\n    }\n    this._updateTrack(data.track);\n  };\n}\n","import { getRhumbLineBearing } from \"geolib\";\n\n//const path_questionmark =\n//  \"m 12.747342,2.0001932 c -0.254753,-0.0015 -0.513283,0.0061 -0.773833,0.0228 C 8.104865,2.2564442 6.070752,4.4579604 5.904,8.4266554 h 3.901734 c 0.03335,-1.367366 0.834151,-2.401618 2.234867,-2.56837 1.400716,-0.133402 2.734861,0.200232 3.135066,1.134043 0.433555,1.033862 -0.533606,2.234215 -1.000512,2.734471 -0.86711,0.9338106 -2.267826,1.6342986 -3.001534,2.6348096 -0.700358,1.000512 -0.834151,2.301567 -0.900851,3.902386 h 3.43535 c 0.03335,-1.033862 0.09979,-2.001153 0.566695,-2.63481 0.767059,-1.033862 1.900972,-1.500768 2.834783,-2.334527 0.90046,-0.767059 1.867621,-1.7008696 2.001023,-3.1682856 0.531522,-4.033312 -2.54199,-6.1030962 -6.363279,-6.1261792 z M 12.073821,17.730891 A 2.1677748,2.1344245 0 0 0 9.906046,19.865445 2.1677748,2.1344245 0 0 0 12.073821,22 2.1677748,2.1344245 0 0 0 14.241595,19.865445 2.1677748,2.1344245 0 0 0 12.073821,17.730891 Z\";\nconst path_questionmark_min =\n  \"M 12.747,2 C 12.492,1.998 12.234,2.006 11.973,2.023 8.105,2.256 6.071,4.458 5.904,8.427 H 9.806 C 9.839,7.06 10.64,6.025 12.041,5.859 c 1.401,-0.133 2.735,0.2 3.135,1.134 0.434,1.034 -0.534,2.234 -1.001,2.734 -0.867,0.934 -2.268,1.634 -3.002,2.635 -0.7,1.001 -0.834,2.302 -0.901,3.902 h 3.435 c 0.033,-1.034 0.1,-2.001 0.567,-2.635 0.767,-1.034 1.901,-1.501 2.835,-2.335 0.9,-0.767 1.868,-1.701 2.001,-3.168 C 19.642,4.093 16.568,2.023 12.747,2 Z M 12.074,17.731 A 2.168,2.134 0 0 0 9.906,19.865 2.168,2.134 0 0 0 12.074,22 2.168,2.134 0 0 0 14.242,19.865 2.168,2.134 0 0 0 12.074,17.731 Z\";\nconst path_arrow =\n  \"M12.93 4.26l6.15 14.99c.34.83-.51 1.66-1.33 1.29l-5.34-2.36c-.26-.11-.55-.11-.81 0l-5.34 2.36c-.82.36-1.67-.46-1.33-1.29l6.15-14.99c.33-.83 1.51-.83 1.85 0z\";\nconst path_idle =\n  \"M 12,2 C 8.13,2 5,5.13 5,9 c 0,5.25 7,13 7,13 0,0 7,-7.75 7,-13 0,-3.87 -3.13,-7 -7,-7\";\n//const path_landed =\n//  \"M 12.662857,19.784264 19.12,15.167121 C 19.668572,14.77855 20,14.149978 20,13.475692 20,11.772835 18.08,10.789978 16.697143,11.772835 L 12,15.121407 7.302857,11.772835 C 5.92,10.778549 4,11.772835 4,13.475692 c 0,0.674286 0.331429,1.314286 0.88,1.702858 l 6.457143,4.617142 c 0.4,0.274286 0.925714,0.274286 1.325714,-0.01143 z m 0,-8 L 19.12,7.1785496 C 19.668572,6.7785496 20,6.1499781 20,5.4756924 20,3.7728353 18.08,2.7785495 16.697143,3.7728353 L 12,7.1214067 7.302857,3.7728353 C 5.92,2.7785495 4,3.7728353 4,5.4756924 4,6.1499781 4.331429,6.7899782 4.88,7.1785496 l 6.457143,4.6171424 c 0.4,0.274286 0.925714,0.274286 1.325714,-0.01143 z\";\nconst path_landed_min =\n  \"m 12.66,19.78 6.46,-4.61 C 19.67,14.78 20,14.15 20,13.48 20,11.77 18.08,10.79 16.7,11.77 L 12,15.12 7.3,11.77 c -1.38,-0.99 -3.3,0 -3.3,1.71 0,0.67 0.33,1.31 0.88,1.7 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z m 0,-8 6.46,-4.6 C 19.67,6.78 20,6.15 20,5.48 20,3.77 18.08,2.78 16.7,3.77 L 12,7.12 7.3,3.77 C 5.92,2.78 4,3.77 4,5.48 4,6.15 4.33,6.79 4.88,7.18 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z\";\n\nexport const getPilotIcon = (\n  google,\n  waitingForStart,\n  endOfTrack,\n  hasLanded,\n  pos,\n  velocityVec,\n  color\n) => {\n  /*\n    Four different symbols:\n      - Flying\n      - Signal lost\n      - Landed\n      - Not yet started (idle)\n  */\n\n  if (endOfTrack) {\n    if (hasLanded) {\n      // LANDED\n      return {\n        path: path_landed_min,\n        fillColor: color,\n        fillOpacity: 1,\n        anchor: new google.maps.Point(12, 20),\n        strokeWeight: 1,\n        scale: 1.2\n      };\n    } else {\n      // SIGNAL LOST\n      return {\n        path: path_questionmark_min,\n        fillColor: color,\n        fillOpacity: 1,\n        anchor: new google.maps.Point(12, 12),\n        strokeWeight: 1,\n        scale: 1.2\n      };\n    }\n  }\n\n  if (waitingForStart) {\n    // NOT YET STARTED\n    return {\n      path: path_idle,\n      fillColor: color,\n      fillOpacity: 1,\n      anchor: new google.maps.Point(12, 22),\n      strokeWeight: 1,\n      scale: 1.2\n    };\n  }\n\n  // TODO Compute direction\n  const bearing =\n    velocityVec === null\n      ? 0\n      : getRhumbLineBearing(pos, {\n          lat: pos.lat + velocityVec.lat,\n          lng: pos.lng + velocityVec.lng\n        });\n\n  // FLYING\n  return {\n    path: path_arrow,\n    fillColor: color,\n    fillOpacity: 1,\n    anchor: new google.maps.Point(12, 12),\n    strokeWeight: 1,\n    scale: 1.2,\n    rotation: bearing\n  };\n};\n","import { getXContestInterface } from \"../location_provider/XContest/XContestInterface\";\nimport GoogleMapsTrack from \"./GoogleMapsTrack\";\n\nexport default class MapAnimator {\n  constructor(map, google) {\n    this.map = map;\n    this.google = google;\n    this.tracks = {};\n  }\n\n  cleanupOldTracks = data => {\n    const toRemove = [];\n    for (const pilot in this.tracks) {\n      if (!(pilot in data)) {\n        toRemove.push(pilot);\n      }\n    }\n    for (const pilot of toRemove) {\n      this.tracks[pilot].setMap(null);\n      delete this.tracks[pilot];\n    }\n  };\n\n  update = data => {\n    const pilotInfos = getXContestInterface().getPilotInfos();\n\n    // Remove tracks that we unsubscribed from\n    this.cleanupOldTracks(data);\n\n    // Update all pilots\n    Object.entries(data).forEach(([pilot, pilotData]) => {\n      if (!(pilot in pilotInfos)) return;\n      const info = pilotInfos[pilot];\n\n      // Add track if it doesn't exist\n      if (!(pilot in this.tracks)) {\n        this.tracks[pilot] = new GoogleMapsTrack(\n          this.google,\n          this.map,\n          info,\n          pilotData\n        );\n      }\n\n      // Update all tracks properties\n      const track = this.tracks[pilot];\n      track.updateData(pilotData);\n    });\n  };\n}\n","import React, { useState, useRef, useLayoutEffect, useEffect } from \"react\";\nimport Box from \"@material-ui/core/Box\";\nimport useGoogleMapsApi from \"../common/GoogleMapsApiLoader\";\nimport { LoadingPage, ErrorPage } from \"./StatusPages\";\nimport mapStyle from \"./MapStyle.json\";\nimport { getXContestInterface } from \"../location_provider/XContest/XContestInterface\";\nimport MapAnimator from \"./MapAnimator\";\n\nconst LiveMap = () => {\n  const [mapReady, mapError, google] = useGoogleMapsApi();\n  const mapsRef = useRef();\n  const [map, setMap] = useState(null);\n\n  // Initialize Map\n  useLayoutEffect(() => {\n    if (mapReady && !map) {\n      setMap(\n        new google.maps.Map(mapsRef.current, {\n          center: { lat: 46.509012, lng: 11.827984 },\n          mapTypeId: \"terrain\",\n          zoom: 12,\n          maxZoom: 15,\n          disableDefaultUI: true,\n          scaleControl: true,\n          fullscreenControl: true,\n          styles: mapStyle\n        })\n      );\n    }\n  }, [mapReady, map, google, mapsRef]);\n\n  // Register map for updates\n  useEffect(() => {\n    if (map && google) {\n      const mapAnimator = new MapAnimator(map, google);\n      const mapAnimatorUpdateCallback = mapAnimator.update;\n      getXContestInterface().animation.registerCallback(\n        mapAnimatorUpdateCallback\n      );\n\n      return () => {\n        getXContestInterface().animation.unregisterCallback(\n          mapAnimatorUpdateCallback\n        );\n      };\n    }\n  }, [map, google]);\n\n  return (\n    <React.Fragment>\n      <Box\n        width=\"100%\"\n        height=\"100%\"\n        display={mapReady ? \"block\" : \"none\"}\n        ref={mapsRef}\n      ></Box>\n      <LoadingPage\n        message=\"Loading Maps ...\"\n        hideIf={mapReady || mapError}\n      ></LoadingPage>\n      <ErrorPage message=\"Unable to load map!\" hideIf={!mapError}></ErrorPage>\n    </React.Fragment>\n  );\n};\n\nexport default LiveMap;\n","const ourHistory = [];\n\nwindow.addEventListener(\"popstate\", () => {\n  if (ourHistory.length === 0) {\n    console.warn(\"History was already 0!\");\n  }\n  const callback = ourHistory.pop();\n  console.debug(\"- History size:\", ourHistory.length);\n  if (ourHistory.length > 0) window.history.pushState({}, \"\");\n  if (callback) callback();\n});\n\nexport const useHistory = () => {\n  const pushFunction = cb => {\n    const histSize = ourHistory.length;\n    ourHistory.push(cb);\n    console.debug(\"+ History size:\", ourHistory.length);\n    if (histSize === 0) {\n      window.history.pushState({}, \"\");\n    }\n  };\n\n  const popFunction = () => {\n    //console.log(\"window.history.back()\", window.history.length);\n    window.history.back();\n  };\n\n  return { push: pushFunction, pop: popFunction };\n};\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { Dialog } from \"@material-ui/core\";\nimport { useHistory } from \"../common/History\";\n\n// The difficult here is to fire exactly one history.back() for any case.\n// Cases:\n// - \"open\" changes to 'false'\n// - \"Dialog.onClose()\" => same as previous, as can be forwarded\n// - History gets reverted\n\nconst SubWindow = props => {\n  const [open, _setOpen] = useState(false);\n  const [historyOpen, _setHistoryOpen] = useState(false);\n  const history = useHistory();\n\n  const openWindow = () => {\n    // TODO create history entry\n    history.push(() => {\n      _setOpen(false);\n      props.onClose();\n    });\n    _setOpen(true);\n    _setHistoryOpen(true);\n  };\n\n  // If we should be open, initiate a window opening.\n  // Special case: if we just closed the window, don't immediately re-open it,\n  // but signal the parent class to close instead.\n  if (props.open && !open) {\n    if (historyOpen) {\n      // This creates an endless feedback loop if props.onClose doesn't set\n      // props.open to false. Therefore we require props.onClose to do so.\n      props.onClose();\n\n      // To further prevent the feedback loop, we now set the history open state.\n      // Now, if props.onClose failed to set props.open to false, the window\n      // will immediately re-open.\n      // Currently commented out, because it proved unstable and caused state\n      // fluctuations.\n      //_setHistoryOpen(false);\n    } else {\n      openWindow();\n    }\n  }\n\n  // If both the external and internal state agree that the window is now close,\n  // reset the history state. The history state prevents the window\n  // from immediately re-opening if the external and internal states disagree.\n  if (historyOpen && !open && !props.open) {\n    _setHistoryOpen(false);\n  }\n\n  // If we are open, the history entry still exists.\n  // Therefore, go back in history if we get signalled to close.\n  if (open && !props.open) {\n    history.pop();\n  }\n\n  return (\n    <Dialog\n      open={open}\n      onClose={() => {\n        props.onClose();\n      }}\n      fullScreen={props.fullScreen}\n      maxWidth={props.maxWidth}\n      fullWidth={props.fullWidth}\n    >\n      {props.children}\n    </Dialog>\n  );\n};\n\nexport default SubWindow;\n","import { getSetting, Settings } from \"./PersistentState/Settings\";\n\nclass GPSProvider {\n  constructor() {\n    this._callbacks = [];\n    this._watchId = null;\n    this._gpsData = null;\n\n    let gpsEnabledSetting = getSetting(Settings.GPS_ENABLED);\n    gpsEnabledSetting.registerCallback(this._updateGPSState);\n    this._updateGPSState();\n  }\n\n  _updateGPSState = () => {\n    let gpssettingEnabled = getSetting(Settings.GPS_ENABLED).getValue();\n    let callbackRegistered = this._callbacks.length > 0;\n\n    let enableGps = gpssettingEnabled && callbackRegistered;\n\n    if (this._watchId === null && enableGps) {\n      this._watchId = navigator.geolocation.watchPosition(\n        this._onNewGPSData,\n        this._onGPSError,\n        { enableHighAccuracy: true }\n      );\n      console.log(\"GPS: On\");\n    }\n\n    if (this._watchId !== null && !enableGps) {\n      navigator.geolocation.clearWatch(this._watchId);\n      this._watchId = null;\n      this._setGPSData(null);\n      console.log(\"GPS: Off\");\n    }\n\n    //console.log(\"UPDATE_GPS_STATE\", enableGps, this._callbacks.length);\n  };\n\n  _setGPSData = data => {\n    console.log(\"GPS DATA:\", data);\n    this._gpsData = data;\n    for (const cb of this._callbacks) {\n      cb(data);\n    }\n  };\n\n  _onNewGPSData = data => {\n    this._setGPSData(data);\n  };\n  _onGPSError = () => {\n    this._setGPSData(null);\n  };\n\n  registerCallback = cb => {\n    if (!this._callbacks.includes(cb)) this._callbacks.push(cb);\n    this._updateGPSState();\n    cb(this._gpsData);\n  };\n\n  unregisterCallback = cb => {\n    const index = this._callbacks.indexOf(cb);\n    if (index >= 0) {\n      this._callbacks.splice(index, 1);\n    }\n    this._updateGPSState();\n  };\n\n  getData = () => {\n    return this._gpsData;\n  };\n}\n\n// Singleton stuff\nlet _instance = null;\nexport const getGPSProvider = () => {\n  if (!_instance) {\n    _instance = new GPSProvider();\n  }\n  return _instance;\n};\n","import React, { Component } from \"react\";\nimport { getGPSProvider } from \"../common/GPSProvider\";\nimport { getDistance, getRhumbLineBearing } from \"geolib\";\n\nfunction formatTimeDiff(millis) {\n  let negative = \"\";\n\n  if (millis < 0) {\n    millis = -millis;\n    negative = \"-\";\n  }\n\n  let secs = Math.floor(millis / 1000);\n  if (secs < 60) {\n    return negative + secs + \" sec\";\n  }\n\n  let mins = Math.floor(secs / 60);\n  if (mins < 60) {\n    return negative + mins + \" min\";\n  }\n\n  let hours = Math.floor(mins / 60);\n  mins = mins - hours * 60;\n  if (hours < 24) {\n    return negative + hours + \":\" + mins.toString().padStart(2, \"0\") + \" h\";\n  }\n\n  let days = Math.floor(hours / 24);\n  hours = hours - days * 24;\n  return (\n    negative +\n    days +\n    \"d \" +\n    hours +\n    \":\" +\n    mins.toString().padStart(2, \"0\") +\n    \" h\"\n  );\n}\n\nfunction timestampToTimeString(timestamp) {\n  let time = new Date(timestamp);\n  return time.toLocaleTimeString();\n}\n\nexport const LastFixState = props => {\n  const timestamp = props.timestamp;\n  const landed = props.landed;\n  const relative = props.relative;\n\n  if (timestamp == null) {\n    return <span>never</span>;\n  }\n  let time_diff = Date.parse(timestamp) - Date.now();\n\n  let timeStr = \"\";\n  if (relative) timeStr = formatTimeDiff(time_diff);\n  else timeStr = timestampToTimeString(timestamp);\n\n  if (landed) {\n    return <span style={{ color: \"#346B8F\" }}>&#10004; {timeStr}</span>;\n  }\n\n  if (-time_diff < 120000) {\n    if (relative)\n      return (\n        <span style={{ color: \"green\" }}>\n          <span role=\"img\" aria-hidden>\n            &#9899;\n          </span>{\" \"}\n          LIVE\n        </span>\n      );\n    else\n      return (\n        <span style={{ color: \"green\" }}>\n          <span role=\"img\" aria-hidden>\n            &#9899;\n          </span>{\" \"}\n          {timeStr}\n        </span>\n      );\n  }\n\n  if (relative) return <span style={{ color: \"red\" }}>! LIVE ({timeStr})</span>;\n  else return <span style={{ color: \"red\" }}>! {timeStr}</span>;\n};\n\nexport class LastFixArrow extends Component {\n  constructor(props) {\n    super(props);\n    this.gpsData = getGPSProvider().getData();\n    this.state = {};\n\n    this.distanceRef = React.createRef();\n    this.arrowRef = React.createRef();\n  }\n\n  onNewGPSDataReceived = gpsData => {\n    this.gpsData = gpsData;\n\n    // Otherwise, directly update through the refs\n    this.updateThroughRef();\n  };\n\n  componentDidMount() {\n    getGPSProvider().registerCallback(this.onNewGPSDataReceived);\n  }\n  componentWillUnmount() {\n    getGPSProvider().unregisterCallback(this.onNewGPSDataReceived);\n  }\n\n  updateThroughRef = () => {\n    if (this.arrowRef.current) {\n      const arrowStyle = LastFixArrow.getArrowRotationStyle(\n        this.gpsData,\n        this.props.lastFix\n      );\n      Object.assign(this.arrowRef.current.style, arrowStyle);\n    }\n    if (this.distanceRef.current) {\n      this.distanceRef.current.innerHTML = LastFixArrow.getDistance(\n        this.gpsData,\n        this.props.lastFix\n      );\n    }\n  };\n\n  static getDistance(myPosition, pilotFix) {\n    if (myPosition === null || pilotFix === null) return \"--km\";\n\n    const distance = getDistance(\n      { lat: myPosition.coords.latitude, lng: myPosition.coords.longitude },\n      pilotFix\n    );\n    return (Math.round(distance / 100) / 10).toString() + \"km\";\n  }\n\n  static getArrowRotationStyle(myPosition, pilotFix) {\n    if (myPosition === null || pilotFix === null) return {};\n    const bearing = getRhumbLineBearing(\n      { lat: myPosition.coords.latitude, lng: myPosition.coords.longitude },\n      pilotFix\n    );\n    const transform = \"rotate(\" + bearing.toString() + \"deg)\";\n\n    const rotationStyle = {\n      transform: transform,\n\n      /* Safari */\n      WebkitTransform: transform,\n\n      /* Firefox */\n      MozTransform: transform,\n\n      /* IE */\n      msTransform: transform,\n\n      /* Opera */\n      OTransform: transform\n    };\n    return rotationStyle;\n  }\n\n  render() {\n    return (\n      <span>\n        <span ref={this.distanceRef}>\n          {LastFixArrow.getDistance(this.gpsData, this.props.lastFix)}\n        </span>{\" \"}\n        <div\n          ref={this.arrowRef}\n          style={{\n            display: \"inline-block\",\n            ...LastFixArrow.getArrowRotationStyle(\n              this.gpsData,\n              this.props.lastFix\n            )\n          }}\n        >\n          \n        </div>\n      </span>\n    );\n  }\n}\n","import React from \"react\";\nimport { TableRow, TableCell, Box, Typography } from \"@material-ui/core\";\nimport { LastFixState, LastFixArrow } from \"../../util/LastFixState\";\n\nconst columns = [\n  {\n    id: \"name\",\n    label: \"Name\",\n    render: (name, data) => {\n      const fullname = data ? data.info.user.fullname : \"Offline User\";\n      const username = data ? data.info.user.username : name;\n      return (\n        <Box paddingLeft={1} paddingTop={1} paddingBottom={1}>\n          <Typography variant=\"body2\">{fullname}</Typography>\n          <Typography\n            variant=\"caption\"\n            color=\"textSecondary\"\n            style={{ paddingLeft: \".5em\" }}\n          >\n            [{username}]\n          </Typography>\n        </Box>\n      );\n    }\n  },\n  {\n    id: \"state\",\n    label: \"State\",\n    align: \"right\",\n    render: (name, data) => {\n      const lastFix = data ? data.lastFix : null;\n      const timestamp = data ? data.lastFix.timestamp : null;\n      const landed = data ? data.landed : null;\n      return (\n        <Box>\n          <Box>\n            <Typography variant=\"caption\">\n              <LastFixState timestamp={timestamp} landed={landed} relative />\n            </Typography>\n          </Box>\n          <Box>\n            <Typography variant=\"caption\">\n              <LastFixArrow lastFix={lastFix} />\n            </Typography>\n          </Box>\n        </Box>\n      );\n    }\n  },\n  {\n    id: \"country\",\n    label: \"Country\",\n    align: \"right\",\n    render: (name, data) => {\n      const iso = data ? data.info.user.nationality.iso : \"--\";\n      return (\n        <Box paddingRight={1} paddingLeft={1}>\n          {iso}\n          <Box\n            fontSize=\"large\"\n            marginLeft=\"4px\"\n            boxShadow={1}\n            style={{ verticalAlign: \"middle\" }}\n            className={\"flag-icon flag-icon-\" + iso.toLowerCase()}\n          ></Box>\n        </Box>\n      );\n    }\n  }\n];\n\nexport const PilotSelectorListHeader = () => (\n  <TableRow>\n    {columns.map(column => (\n      <TableCell\n        key={column.id}\n        align={column.align}\n        style={{ width: column.width }}\n        component=\"th\"\n      >\n        {column.label}\n      </TableCell>\n    ))}\n  </TableRow>\n);\n\nexport const PilotSelectorListEntry = props => {\n  const boxStyle = props.disabled\n    ? { filter: \"grayscale(100%) opacity(30%)\" }\n    : {};\n\n  const columnContent = columns.map(column => {\n    return (\n      <TableCell key={column.id} align={column.align} padding=\"none\">\n        <Box style={boxStyle}>{column.render(props.name, props.data)}</Box>\n      </TableCell>\n    );\n  });\n\n  return (\n    <TableRow selected={props.selected} onClick={props.onClick}>\n      {columnContent}\n    </TableRow>\n  );\n};\n","import React, { Component } from \"react\";\nimport {\n  Box,\n  useMediaQuery,\n  useTheme,\n  Typography,\n  Toolbar\n} from \"@material-ui/core\";\nimport { useState } from \"react\";\n\nimport { lighten } from \"@material-ui/core/styles\";\nimport { Button, DialogActions, TextField } from \"@material-ui/core\";\n\nimport { Table, TableBody, TableHead } from \"@material-ui/core\";\n\nimport { getXContestInterface } from \"../../location_provider/XContest/XContestInterface\";\nimport SubWindow from \"../../util/SubWindow\";\nimport {\n  PilotSelectorListEntry,\n  PilotSelectorListHeader\n} from \"./PilotSelectorListItems\";\nimport { arraysEqual } from \"../../util/CompareArrays\";\nimport { getGPSProvider } from \"../../common/GPSProvider\";\nimport { getDistance } from \"geolib\";\n\nconst computeDisplayedPilots = (pilotList, pilotInfos, search) => {\n  const matchesSearch = name => {\n    if (search === \"\") {\n      return true;\n    }\n    return name.toLowerCase().includes(search.toLowerCase());\n  };\n\n  // Create virtual pilot if nobody found\n  let filteredPilots = pilotList.filter(pilotId => {\n    return (\n      matchesSearch(pilotInfos[pilotId].info.user.username) ||\n      matchesSearch(pilotInfos[pilotId].info.user.fullname)\n    );\n  });\n\n  // Add dummy pilot if list is empty and search string is valid\n  if (filteredPilots.length === 0 && !/\\s/.test(search) && search.length > 0) {\n    filteredPilots.push(search);\n  }\n\n  return filteredPilots;\n};\n\nconst getSortedPilotList = (pilotInfos, gps) => {\n  if (gps) {\n    // If gps, sort by distance\n    const myPos = { lat: gps.coords.latitude, lng: gps.coords.longitude };\n    let distances = Object.entries(pilotInfos).map(([pilotId, data]) => {\n      const distance = getDistance(myPos, data.lastFix);\n      return [pilotId, distance];\n    });\n    distances.sort((el1, el2) => el1[1] - el2[1]);\n    const pilotIds = distances.map(el => el[0]);\n    return pilotIds;\n  } else {\n    // Else, sort by name\n    let pilotIds = Object.keys(pilotInfos);\n    pilotIds.sort();\n    return pilotIds;\n  }\n};\n\n// The table content\nclass PilotSelectorContent extends Component {\n  constructor(props) {\n    super(props);\n    this.gpsData = getGPSProvider().getData();\n    const pilotInfos = getXContestInterface().pilotInfos.getValue();\n    this.state = {\n      pilotInfos: pilotInfos,\n      sortedPilotList: getSortedPilotList(pilotInfos, this.gpsData)\n    };\n  }\n\n  componentDidMount() {\n    getXContestInterface().pilotInfos.registerCallback(this.onNewPilotInfos);\n    getGPSProvider().registerCallback(this.onNewGpsData);\n  }\n\n  componentWillUnmount() {\n    getXContestInterface().pilotInfos.unregisterCallback(this.onNewPilotInfos);\n    getGPSProvider().unregisterCallback(this.onNewGpsData);\n  }\n\n  updatePilotListIfNecessary = () => {\n    const newPilotList = getSortedPilotList(\n      this.state.pilotInfos,\n      this.gpsData\n    );\n\n    if (!arraysEqual(this.state.sortedPilotList, newPilotList))\n      this.setState({ ...this.state, sortedPilotList: newPilotList });\n  };\n\n  onNewGpsData = gpsData => {\n    // update only if gps position changed pilot list\n    this.gpsData = gpsData;\n    this.updatePilotListIfNecessary();\n  };\n\n  onNewPilotInfos = pilotInfos => {\n    // Always update on new pilot infos\n    this.setState({\n      ...this.state,\n      pilotInfos: pilotInfos,\n      sortedPilotList: getSortedPilotList(pilotInfos, this.gpsData)\n    });\n  };\n\n  render() {\n    const isSelected = name => this.props.selected.indexOf(name) !== -1;\n    const wasAlreadyAdded = name =>\n      this.props.alreadyAdded.indexOf(name) !== -1;\n\n    const displayedPilots = computeDisplayedPilots(\n      this.state.sortedPilotList,\n      this.state.pilotInfos,\n      this.props.search\n    );\n\n    return (\n      <Table stickyHeader size=\"small\">\n        <TableHead>\n          <PilotSelectorListHeader />\n        </TableHead>\n        <TableBody>\n          {displayedPilots.map(pilotId => {\n            const isItemSelected = isSelected(pilotId);\n            const itemDisabled = wasAlreadyAdded(pilotId);\n\n            const pilotData = this.state.pilotInfos[pilotId];\n\n            if (itemDisabled) {\n              return (\n                <PilotSelectorListEntry\n                  key={pilotId}\n                  name={pilotId}\n                  data={pilotData}\n                  disabled\n                />\n              );\n            }\n\n            return (\n              <PilotSelectorListEntry\n                key={pilotId}\n                name={pilotId}\n                data={pilotData}\n                selected={isItemSelected}\n                onClick={() => this.props.onPilotClicked(pilotId)}\n              />\n            );\n          })}\n        </TableBody>\n      </Table>\n    );\n  }\n}\n\n// Base window, without the table\nconst PilotSelector = props => {\n  const theme = useTheme();\n  const fullScreen = useMediaQuery(theme.breakpoints.down(\"xs\"));\n\n  // State\n  const [selected, setSelected] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const numSelected = selected.length;\n\n  const closeWindow = () => {\n    // Reset state\n    setSearch(\"\");\n    setSelected([]);\n    props.onClose();\n  };\n\n  const pilotClicked = name => {\n    const selectedIndex = selected.indexOf(name);\n    let newSelected = [];\n\n    if (selectedIndex === -1) {\n      newSelected = newSelected.concat(selected, name);\n    } else if (selectedIndex === 0) {\n      newSelected = newSelected.concat(selected.slice(1));\n    } else if (selectedIndex === selected.length - 1) {\n      newSelected = newSelected.concat(selected.slice(0, -1));\n    } else if (selectedIndex > 0) {\n      newSelected = newSelected.concat(\n        selected.slice(0, selectedIndex),\n        selected.slice(selectedIndex + 1)\n      );\n    }\n\n    setSelected(newSelected);\n  };\n\n  return (\n    <SubWindow\n      open={props.open}\n      onClose={closeWindow}\n      fullScreen={fullScreen}\n      maxWidth=\"xs\"\n      fullWidth={true}\n    >\n      <Toolbar\n        style={\n          numSelected === 0\n            ? {}\n            : theme.palette.type === \"light\"\n            ? {\n                color: theme.palette.secondary.main,\n                backgroundColor: lighten(theme.palette.secondary.light, 0.85)\n              }\n            : {\n                color: theme.palette.text.primary,\n                backgroundColor: theme.palette.secondary.dark\n              }\n        }\n      >\n        {numSelected > 0 ? (\n          <Typography component=\"div\" color=\"inherit\" variant=\"subtitle1\">\n            {numSelected} selected\n          </Typography>\n        ) : (\n          <Typography component=\"div\" variant=\"h6\" id=\"tableTitle\">\n            Add new pilots:\n          </Typography>\n        )}\n      </Toolbar>\n      <Box paddingLeft=\"1em\" paddingRight=\"1em\" paddingTop=\"4px\">\n        <TextField\n          //autoFocus\n          margin=\"dense\"\n          autoComplete=\"off\"\n          variant=\"outlined\"\n          id=\"search_field\"\n          label=\"Search\"\n          type=\"search\"\n          fullWidth\n          onChange={event => setSearch(event.target.value)}\n        />\n      </Box>\n      <Box flex=\"1 1 auto\" marginY=\"8px\" style={{ overflowY: \"auto\" }}>\n        <PilotSelectorContent\n          alreadyAdded={props.alreadyAdded}\n          selected={selected}\n          onPilotClicked={pilotClicked}\n          search={search}\n        />\n      </Box>\n      <DialogActions>\n        <Button onClick={closeWindow} color=\"primary\">\n          Cancel\n        </Button>\n        <Button\n          disabled={numSelected === 0}\n          onClick={() => {\n            props.onAddPilots(selected);\n            closeWindow();\n          }}\n          color=\"primary\"\n        >\n          Add\n        </Button>\n      </DialogActions>\n    </SubWindow>\n  );\n};\n\nexport default PilotSelector;\n","// attach the .equals method to Array's prototype to call it on any array\nexport function arraysEqual(array1, array2) {\n  // if the other array is a falsy value, return\n  if (!array1 || !array2) return false;\n\n  // compare lengths - can save a lot of time\n  if (array1.length !== array2.length) return false;\n\n  for (var i = 0, l = array1.length; i < l; i++) {\n    /*// Check if we have nested arrays\n    if (array1[i] instanceof Array && array2[i] instanceof Array) {\n      // recurse into the nested arrays\n      if (!array1[i].equals(array2[i])) return false;\n    } else */\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n","import React, { Component } from \"react\";\nimport { Box } from \"@material-ui/core\";\nimport { getXContestInterface } from \"../../location_provider/XContest/XContestInterface\";\nimport { getGPSProvider } from \"../../common/GPSProvider\";\n\nclass AnimatedPilotListEntry extends Component {\n  constructor(props) {\n    super(props);\n\n    // Get initial data\n    const pilotData = getXContestInterface().animation.getData();\n    this.pilotInfo = null;\n    if (props.pilotId in pilotData) {\n      this.pilotInfo = pilotData[props.pilotId];\n    }\n    this.gpsData = getGPSProvider().getData();\n\n    this.state = {\n      online: this.pilotInfo !== null,\n      gps: this.gpsData !== null\n    };\n  }\n\n  onNewGPSDataReceived = gpsData => {\n    this.gpsData = gpsData;\n    const hasGps = this.gpsData !== null;\n\n    // If something major has changed, don't run a microupdate, but a full one\n    if (this.state.gps !== hasGps) {\n      this.setState({ ...this.state, gps: hasGps });\n      return;\n    }\n\n    if (!hasGps) return;\n\n    // TODO replace with a more efficient way\n    this.forceUpdate();\n  };\n\n  onNewDataReceived = pilotData => {\n    if (this.props.pilotId in pilotData) {\n      this.pilotInfo = pilotData[this.props.pilotId];\n    } else {\n      this.pilotInfo = null;\n    }\n\n    const hasPilotInfo = this.pilotInfo !== null;\n\n    // If something major has changed, don't run a microupdate, but a full one\n    if (this.state.online !== hasPilotInfo) {\n      this.setState({ ...this.state, online: true });\n      return;\n    }\n\n    if (!hasPilotInfo) return;\n\n    // TODO update data in a more efficient way, by modifying object dom directly\n    this.forceUpdate();\n  };\n\n  componentDidMount() {\n    getXContestInterface().animation.registerCallback(this.onNewDataReceived);\n    getGPSProvider().registerCallback(this.onNewGPSDataReceived);\n  }\n  componentWillUnmount() {\n    getXContestInterface().animation.unregisterCallback(this.onNewDataReceived);\n    getGPSProvider().unregisterCallback(this.onNewGPSDataReceived);\n  }\n\n  render() {\n    const animatedPilotData = this.pilotInfo;\n    let pilotDebugOutput = [];\n\n    for (const key in animatedPilotData) {\n      const dataElement = animatedPilotData[key];\n      if (isNaN(dataElement)) {\n        if (dataElement.length > 5) continue;\n        for (const subKey in dataElement) {\n          pilotDebugOutput.push(\n            <tr key={key + subKey}>\n              <td>{key + \".\" + subKey}</td>\n              <td>{dataElement[subKey].toString()}</td>\n            </tr>\n          );\n        }\n      } else {\n        pilotDebugOutput.push(\n          <tr key={key}>\n            <td>{key}</td>\n            <td>\n              {(Math.round(100 * animatedPilotData[key]) / 100).toString()}\n            </td>\n          </tr>\n        );\n      }\n    }\n\n    return (\n      <Box margin=\"10px\" onClick={this.props.removePilot}>\n        {this.props.pilotId}\n        <Box>\n          GPS:{\" \"}\n          {this.gpsData === null\n            ? \"NULL\"\n            : this.gpsData.coords.accuracy.toString()}\n        </Box>\n        <Box>\n          GPS time:{\" \"}\n          {this.gpsData === null\n            ? \"NULL\"\n            : Math.round(this.gpsData.timestamp / 1000).toString()}\n        </Box>\n        <table>\n          <tbody>{pilotDebugOutput}</tbody>\n        </table>\n      </Box>\n    );\n  }\n}\n\nexport default AnimatedPilotListEntry;\n","import React, { Component } from \"react\";\nimport { Box } from \"@material-ui/core\";\nimport { getXContestInterface } from \"../../location_provider/XContest/XContestInterface\";\nimport AnimatedPilotListEntry from \"./AnimatedPilotListEntry\";\n\nclass AnimatedPilotList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      onlinePilots: []\n    };\n    this.pilotData = null;\n  }\n\n  onNewDataReceived = pilotData => {\n    this.pilotData = pilotData;\n    let pilotList = Object.keys(pilotData);\n\n    // TODO sort\n\n    let pilotListChanged = false;\n    if (pilotList.length === this.state.onlinePilots.length) {\n      for (let i = 0; i < pilotList.length; i++) {\n        if (pilotList[i] !== this.state.onlinePilots[i]) {\n          pilotListChanged = true;\n          break;\n        }\n      }\n    } else {\n      pilotListChanged = true;\n    }\n\n    if (pilotListChanged) {\n      this.setState({ ...this.state, onlinePilots: pilotList });\n    }\n  };\n\n  componentDidMount() {\n    getXContestInterface().animation.registerCallback(this.onNewDataReceived);\n  }\n  componentWillUnmount() {\n    getXContestInterface().animation.unregisterCallback(this.onNewDataReceived);\n  }\n  render() {\n    let pilotIsOnline = new Set(this.state.onlinePilots);\n\n    // Show online pilots first\n    let pilots = this.state.onlinePilots.filter(\n      pilotId => pilotId in this.props.pilots\n    );\n\n    // Add all offline pilots\n    pilots.push.apply(\n      pilots,\n      Object.keys(this.props.pilots).filter(\n        pilotId => !pilotIsOnline.has(pilotId)\n      )\n    );\n\n    const content = pilots.map(pilotId => (\n      <AnimatedPilotListEntry\n        key={pilotId}\n        pilotId={pilotId}\n        removePilot={() => {\n          this.props.removePilots([pilotId]);\n        }}\n      ></AnimatedPilotListEntry>\n    ));\n\n    return (\n      <Box height=\"100%\" style={{ overflowY: \"auto\" }}>\n        {content}\n      </Box>\n    );\n  }\n}\n\nexport default AnimatedPilotList;\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { Fab } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/core/styles\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport Box from \"@material-ui/core/Box\";\nimport PilotSelector from \"../PilotSelector/PilotSelector\";\nimport { useChosenPilots } from \"../../common/PersistentState/ChosenPilots\";\nimport AnimatedPilotList from \"./AnimatedPilotList\";\n\nconst Pilots = () => {\n  const theme = useTheme();\n  const [pilotSelectorOpen, setPilotSelectorOpen] = useState(false);\n\n  const [pilots, addPilots, removePilots] = useChosenPilots();\n\n  // TODO sort pilots\n\n  return (\n    <React.Fragment>\n      <AnimatedPilotList\n        pilots={pilots}\n        removePilots={removePilots}\n      ></AnimatedPilotList>\n\n      <Box\n        position=\"absolute\"\n        bottom={theme.spacing(2)}\n        right={theme.spacing(2)}\n      >\n        <Fab\n          size=\"small\"\n          color=\"primary\"\n          onClick={() => setPilotSelectorOpen(true)}\n        >\n          <AddIcon />\n        </Fab>\n      </Box>\n      <PilotSelector\n        open={pilotSelectorOpen}\n        onClose={() => setPilotSelectorOpen(false)}\n        onAddPilots={addPilots}\n        alreadyAdded={Object.keys(pilots)}\n      />\n    </React.Fragment>\n  );\n};\n\nexport default Pilots;\n","import React, { Component } from \"react\";\nimport { TextField, InputAdornment } from \"@material-ui/core\";\n\nexport default class NumberInput extends Component {\n  state = {\n    internalUpdate: false,\n    value: null\n  };\n\n  static getDerivedStateFromProps(props, state) {\n    const resultState = { ...state, internalUpdate: false };\n\n    // Overwrite with external value if we got an update from the parent element\n    if (!state.internalUpdate) {\n      resultState.value = props.value;\n    }\n\n    return resultState;\n  }\n\n  render() {\n    return (\n      <TextField\n        onChange={event => {\n          const value = event.target.value;\n          // If the value is too small, send the smallest possible value to the parent,\n          // but keep the incorrect value in the text field.\n          // If the value is too large, send the largest possible value to the parent,\n          // and also set the text field to the largest possible value.\n          // Otherwise, just update.\n\n          if (value < this.props.min) {\n            // If those two messages get delivered out of order, this entire trick will stop working.\n            // But I think setting states will never be done in an incorrect order, that would really break things.\n            this.props.onChange(this.props.min);\n            this.setState({\n              ...this.state,\n              internalUpdate: true,\n              value: value\n            });\n          } else if (value > this.props.max) {\n            this.props.onChange(this.props.max);\n          } else {\n            this.props.onChange(value);\n          }\n        }}\n        variant=\"outlined\"\n        disabled={this.props.disabled}\n        margin=\"dense\"\n        hiddenLabel\n        type=\"number\"\n        value={this.state.value}\n        InputProps={{\n          endAdornment: (\n            <InputAdornment position=\"end\">{this.props.unit}</InputAdornment>\n          )\n        }}\n        inputProps={{\n          min: this.props.min,\n          max: this.props.max\n        }}\n      />\n    );\n  }\n}\n","import React from \"react\";\nimport { getSetting } from \"../../common/PersistentState/Settings\";\nimport {\n  ListItem,\n  ListItemText,\n  ListItemSecondaryAction,\n  Switch\n} from \"@material-ui/core\";\nimport NumberInput from \"../../util/NumberInput\";\n\nexport const BooleanSetting = props => {\n  const [settingValue, setSettingValue] = getSetting(props.setting).use();\n  const flipSetting = () => setSettingValue(!settingValue);\n\n  return (\n    <ListItem button onClick={flipSetting}>\n      <ListItemText\n        primary={props.primaryText}\n        secondary={props.secondaryText}\n      />\n      <ListItemSecondaryAction>\n        <Switch edge=\"end\" onChange={flipSetting} checked={settingValue} />\n      </ListItemSecondaryAction>\n    </ListItem>\n  );\n};\n\nexport const NumberSetting = props => {\n  const [settingValue, setSettingValue] = getSetting(props.setting).use();\n\n  return (\n    <ListItem disabled={props.disabled}>\n      <ListItemText\n        primary={props.primaryText}\n        secondary={props.secondaryText}\n      />\n      <ListItemSecondaryAction>\n        <NumberInput\n          value={settingValue}\n          onChange={setSettingValue}\n          disabled={props.disabled}\n          unit={props.unit}\n          min={props.min}\n          max={props.max}\n        />\n      </ListItemSecondaryAction>\n    </ListItem>\n  );\n};\n","import React, { useState } from \"react\";\nimport {\n  AppBar,\n  Toolbar,\n  IconButton,\n  Box,\n  Typography,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Button\n} from \"@material-ui/core\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport UndoIcon from \"@material-ui/icons/Undo\";\n\nimport SubWindow from \"../../util/SubWindow\";\nimport { resetAllSettings } from \"../../common/PersistentState/Settings\";\n\nconst SettingsPageTitleBar = props => {\n  const [resetAllSettingsDialogOpen, setResetAllSettingsDialogOpen] = useState(\n    false\n  );\n\n  return (\n    <React.Fragment>\n      <AppBar style={{ position: \"static\" }}>\n        <Toolbar>\n          <IconButton edge=\"start\" color=\"inherit\" onClick={props.onClose}>\n            <ArrowBackIcon />\n          </IconButton>\n\n          <Box marginLeft={2} flexGrow={1}>\n            <Typography variant=\"h6\">Settings</Typography>\n          </Box>\n\n          <IconButton\n            edge=\"end\"\n            color=\"inherit\"\n            onClick={() => setResetAllSettingsDialogOpen(true)}\n          >\n            <UndoIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n\n      {/* RESET ALL SETTINGS DIALOG */}\n      <SubWindow\n        open={resetAllSettingsDialogOpen}\n        onClose={() => setResetAllSettingsDialogOpen(false)}\n      >\n        <DialogTitle>{\"Reset all settings?\"}</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            This sets all settings to their default values.\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button\n            onClick={() => {\n              resetAllSettings();\n              setResetAllSettingsDialogOpen(false);\n            }}\n            color=\"primary\"\n          >\n            Yes\n          </Button>\n          <Button\n            onClick={() => setResetAllSettingsDialogOpen(false)}\n            color=\"primary\"\n            autoFocus\n          >\n            No\n          </Button>\n        </DialogActions>\n      </SubWindow>\n    </React.Fragment>\n  );\n};\n\nexport default SettingsPageTitleBar;\n","import React from \"react\";\n\nimport { List, Divider } from \"@material-ui/core\";\nimport { getSetting, Settings } from \"../../common/PersistentState/Settings\";\nimport SubWindow from \"../../util/SubWindow\";\nimport { BooleanSetting, NumberSetting } from \"./SettingsPageEntries\";\nimport SettingsPageTitleBar from \"./SettingsPageTitleBar\";\n\nconst SettingsPage = props => {\n  // Retreive the settings that enable/disable other settings\n  const [settingLimitPaths] = getSetting(Settings.LIMIT_PATHS).use();\n  const [settingFpsLimit] = getSetting(Settings.FPS_LIMIT).use();\n  //const [settingLowLatency] = getSetting(Settings.LOW_LATENCY).use();\n\n  return (\n    <SubWindow fullScreen open={props.open} onClose={props.onClose}>\n      <SettingsPageTitleBar onClose={props.onClose} />\n\n      <List>\n        {/* ANIMATION DELAY */}\n        <BooleanSetting\n          setting={Settings.LOW_LATENCY}\n          primaryText=\"Low Latency Mode\"\n          secondaryText=\"disables animations\"\n        />\n        {/*<NumberSetting\n          primaryText=\"Animation Delay\"\n          secondaryText=\"70-120 sec (default: 80)\"\n          setting={Settings.ANIMATION_DELAY}\n          disabled={settingLowLatency}\n          unit=\"sec\"\n          min={70}\n          max={120}\n        />*/}\n\n        {/* TRACK LENGTH */}\n        <Divider />\n        <BooleanSetting\n          setting={Settings.LIMIT_PATHS}\n          primaryText=\"Limit Track Length\"\n          secondaryText=\"prevents map clutter\"\n        />\n        <NumberSetting\n          primaryText=\"Track Length\"\n          secondaryText=\"Valid: 1-999 min\"\n          setting={Settings.PATH_LENGTH}\n          disabled={!settingLimitPaths}\n          unit=\"min\"\n          min={1}\n          max={999}\n        />\n\n        {/* FRAMERATE */}\n        <Divider />\n        <BooleanSetting\n          setting={Settings.FPS_LIMIT}\n          primaryText=\"Limit Framerate\"\n          secondaryText=\"reduces energy consumption\"\n        />\n        <NumberSetting\n          primaryText=\"Framerate\"\n          secondaryText=\"Valid: 1-60 fps\"\n          setting={Settings.FPS_RATE}\n          disabled={!settingFpsLimit}\n          unit=\"fps\"\n          min={1}\n          max={60}\n        />\n\n        {/* GPS */}\n        <Divider />\n        <BooleanSetting\n          setting={Settings.GPS_ENABLED}\n          primaryText=\"Enable GPS\"\n          secondaryText=\"required for advanced features\"\n        />\n      </List>\n    </SubWindow>\n  );\n};\n\nexport default SettingsPage;\n","import React, { useState } from \"react\";\nimport SwipeableDrawer from \"@material-ui/core/SwipeableDrawer\";\nimport {\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Box,\n  Typography,\n  Toolbar,\n  useTheme\n} from \"@material-ui/core\";\nimport { IconButton } from \"@material-ui/core\";\n\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\n\nimport SettingsPage from \"./SettingsPage/SettingsPage\";\n\nconst MainMenu = props => {\n  const theme = useTheme();\n  const [settingsOpen, setSettingsOpen] = useState(false);\n\n  return (\n    <React.Fragment>\n      <SwipeableDrawer\n        disableSwipeToOpen\n        open={props.open}\n        onOpen={() => {}}\n        onClose={props.onClose}\n      >\n        <Toolbar\n          style={{\n            backgroundColor: theme.palette.primary.light,\n            minWidth: \"200px\"\n          }}\n          onClick={props.onClose}\n        >\n          <Box flexGrow={1} clone>\n            <Typography variant=\"h6\">Menu</Typography>\n          </Box>\n          <IconButton edge=\"end\" color=\"inherit\">\n            <ChevronLeftIcon />\n          </IconButton>\n        </Toolbar>\n\n        <List>\n          <ListItem\n            button\n            onClick={() => {\n              props.onClose();\n              setSettingsOpen(true);\n            }}\n          >\n            <ListItemIcon>\n              <SettingsIcon />\n            </ListItemIcon>\n            <ListItemText primary=\"Settings\" />\n          </ListItem>\n        </List>\n      </SwipeableDrawer>\n      <SettingsPage\n        open={settingsOpen}\n        onClose={() => setSettingsOpen(false)}\n      ></SettingsPage>\n    </React.Fragment>\n  );\n};\n\nexport default MainMenu;\n","import React from \"react\";\nimport { useState } from \"react\";\n\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Popover from \"@material-ui/core/Popover\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Box from \"@material-ui/core/Box\";\nimport Badge from \"@material-ui/core/Badge\";\n\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport ErrorIcon from \"@material-ui/icons/ErrorRounded\";\nimport SignalCellular4BarIcon from \"@material-ui/icons/SignalCellular4Bar\";\nimport SignalCellularConnectedNoInternet4BarIcon from \"@material-ui/icons/SignalCellularConnectedNoInternet4Bar\";\nimport SignalCellularNullIcon from \"@material-ui/icons/SignalCellularNull\";\n\nimport { useXContestConnectionState } from \"../location_provider/XContest/XContestInterface\";\nimport { ConnectionState } from \"../location_provider/XContest/XContestInterface\";\nimport { CircularProgress } from \"@material-ui/core\";\nimport MainMenu from \"./MainMenu\";\n\nconst useStyles = makeStyles(theme => ({\n  popover: {\n    padding: theme.spacing(1),\n    align: \"right\"\n  }\n}));\n\nconst LoadingBadge = props => {\n  return (\n    <Badge\n      //overlap=\"circle\"\n      anchorOrigin={{\n        vertical: \"bottom\",\n        horizontal: \"right\"\n      }}\n      badgeContent={\n        <CircularProgress\n          disableShrink={props.disableShrink}\n          color=\"secondary\"\n          size={15}\n          thickness={10}\n        />\n      }\n    >\n      {props.children}\n    </Badge>\n  );\n};\n\nconst TitleBar = () => {\n  const classes = useStyles();\n  const connectionState = useXContestConnectionState();\n\n  const popoverActions = React.useRef();\n  const [connectionPopAnchor, setConnectionPopAnchor] = useState(null);\n\n  const [mainMenuOpen, setMainMenuOpen] = useState(false);\n\n  React.useLayoutEffect(() => {\n    if (popoverActions.current) {\n      popoverActions.current.updatePosition();\n    }\n  }, [connectionState, connectionPopAnchor]);\n\n  const renderConnectionIcon = () => {\n    switch (connectionState) {\n      case ConnectionState.ACTIVE:\n        return <SignalCellular4BarIcon />;\n      case ConnectionState.CONNECTING:\n        return (\n          <LoadingBadge>\n            <SignalCellularNullIcon />\n          </LoadingBadge>\n        );\n      case ConnectionState.ERROR:\n        return <ErrorIcon color=\"error\" />;\n      case ConnectionState.ESTABLISHED:\n        return (\n          <LoadingBadge disableShrink>\n            <SignalCellularNullIcon />\n          </LoadingBadge>\n        );\n      case ConnectionState.INACTIVE:\n        return <SignalCellularConnectedNoInternet4BarIcon />;\n      case ConnectionState.NO_CONNECTION:\n        return <SignalCellularNullIcon />;\n      default:\n        return <SignalCellularNullIcon />;\n    }\n  };\n\n  return (\n    <div>\n      <AppBar position=\"static\">\n        <Toolbar>\n          <IconButton\n            edge=\"start\"\n            color=\"inherit\"\n            onClick={() => setMainMenuOpen(true)}\n          >\n            <MenuIcon />\n          </IconButton>\n\n          <Box marginLeft={2} flexGrow={1}>\n            <Typography variant=\"h6\">XC Live Viewer</Typography>\n          </Box>\n\n          <IconButton\n            edge=\"end\"\n            color=\"inherit\"\n            onClick={event => setConnectionPopAnchor(event.currentTarget)}\n          >\n            {renderConnectionIcon()}\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <Popover\n        open={Boolean(connectionPopAnchor)}\n        anchorEl={connectionPopAnchor}\n        onClose={() => setConnectionPopAnchor(null)}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"right\"\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"right\"\n        }}\n        action={popoverActions}\n      >\n        <Box className={classes.popover}>\n          <Typography>{connectionState}</Typography>\n        </Box>\n      </Popover>\n      <MainMenu\n        open={mainMenuOpen}\n        onClose={() => setMainMenuOpen(false)}\n      ></MainMenu>\n    </div>\n  );\n};\n\nexport default TitleBar;\n","import React from \"react\";\nimport Box from \"@material-ui/core/Box\";\nimport SwipeableViews from \"react-swipeable-views\";\nimport { BottomNavigation, BottomNavigationAction } from \"@material-ui/core\";\n\nimport LocationOnIcon from \"@material-ui/icons/LocationOn\";\nimport PeopleIcon from \"@material-ui/icons/People\";\nimport MapIcon from \"@material-ui/icons/Map\";\n\nimport \"./MainPage.css\";\n\n// TODO import LazyLoading from \"./util/LazyLoading\";\n\nimport LiveMap from \"./pages/LiveMap\";\nimport Pilots from \"./pages/PilotList/Pilots\";\nimport TitleBar from \"./pages/TitleBar\";\n\nconst MainPage = () => {\n  const [tabId, setTabId] = React.useState(1);\n  const [windowHeight, setWindowHeight] = React.useState(0);\n\n  // Workaround for mobile screens reporting an incorrect window height\n  const updateWindowHeight = () => {\n    setWindowHeight(window.innerHeight);\n  };\n  React.useLayoutEffect(() => {\n    updateWindowHeight();\n    window.addEventListener(\"resize\", updateWindowHeight);\n    return () => window.removeEventListener(\"resize\", updateWindowHeight);\n  }, []);\n\n  // Callbacks for changing the current page\n  const handleNavigationButton = (_event, newValue) => setTabId(newValue);\n\n  return (\n    <Box height={windowHeight} display=\"flex\" flexDirection=\"column\">\n      <Box zIndex={100}>\n        <TitleBar></TitleBar>\n      </Box>\n      <Box flexGrow={1} clone>\n        <SwipeableViews disabled index={tabId}>\n          <Box width=\"100%\" height=\"100%\" position=\"relative\">\n            <LiveMap></LiveMap>\n          </Box>\n          <Box width=\"100%\" height=\"100%\" position=\"relative\">\n            <Pilots></Pilots>\n          </Box>\n          <Box width=\"100%\" height=\"100%\" position=\"relative\">\n            Item Three\n          </Box>\n        </SwipeableViews>\n      </Box>\n      <Box zIndex={100} boxShadow={3}>\n        <BottomNavigation\n          value={tabId}\n          onChange={handleNavigationButton}\n          showLabels\n        >\n          <BottomNavigationAction label=\"Map\" icon={<MapIcon />} />\n          <BottomNavigationAction label=\"Pilots\" icon={<PeopleIcon />} />\n          <BottomNavigationAction label=\"Nearby\" icon={<LocationOnIcon />} />\n        </BottomNavigation>\n      </Box>\n    </Box>\n  );\n};\n\nexport default MainPage;\n","import React from \"react\";\nimport MainPage from \"./MainPage\";\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <MainPage />\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nimport \"flag-icon-css/css/flag-icon.min.css\";\n\nimport * as serviceWorker from \"./serviceWorker\";\n\n// Read the .env file\nrequire(\"dotenv\").config();\n\n// Render the page\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}