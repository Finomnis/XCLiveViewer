(window["webpackJsonpxc-live-viewer"]=window["webpackJsonpxc-live-viewer"]||[]).push([[0],{104:function(t){t.exports=JSON.parse('[{"featureType":"all","stylers":[{"visibility":"simplified"},{"saturation":-40}]},{"featureType":"administrative.land_parcel","stylers":[{"visibility":"off"}]},{"featureType":"administrative.neighborhood","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text","stylers":[{"visibility":"off"}]}]')},134:function(t,e,n){t.exports=n(197)},161:function(t,e,n){},191:function(t,e,n){},192:function(t,e,n){},197:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(11),o=n.n(i),l=n(7),s=n(258),c=n(101),u=n.n(c),p=n(23),f=n(235),h=n(255),d=n(256),g=n(120),m=n.n(g),b=n(119),v=n.n(b),y=(n(161),n(102)),O=null;var k=function(){var t=Object(a.useState)({ready:!1,error:!1}),e=Object(l.a)(t,2),n=e[0],r=e[1];return Object(a.useEffect)((function(){null===O&&(O=new y.a({apiKey:"AIzaSyBCrP5uoEJXfEvz8f_y1HgzQnqUGHz0Aak"}).load());var t={gotCanceled:!1};return O.then((function(){t.gotCanceled||(console.log("Google Maps API loaded."),r({ready:!0,error:!1}))})).catch((function(e){t.gotCanceled||(console.log("Error: Cannot load Google Maps API:",e),r({ready:!1,error:!0}))})),function(){t.gotCanceled=!0}}),[]),[n.ready,n.error,n.ready?window.google:null]},E=n(229),w=n(45),P=n(233),_=n(103),j=n.n(_),S=Object(E.a)((function(t){return{progress:{margin:t.spacing(2)}}})),C=function(t){var e=t.message,n=t.hideIf,a=t.subRef,i=S();return r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center",ref:a},r.a.createElement(s.a,{textAlign:"center"},r.a.createElement(P.a,{className:i.progress}),r.a.createElement(w.a,null,e)))},T=function(t){var e=t.message,n=t.hideIf,a=S();return r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center"},r.a.createElement(s.a,{textAlign:"center"},r.a.createElement(j.a,{fontSize:"large",color:"error",className:a.progress}),r.a.createElement(w.a,{color:"error"},e)))},A=n(104),I=n(8),D=n(10),x=function t(e,n){var r=this;Object(I.a)(this,t),this.getValue=function(){var t=localStorage.getItem(r.key);r.locallyCachedJson!==t&&(r.locallyCachedJson=t,r.locallyCachedValue=JSON.parse(t));var e=r.locallyCachedValue;return null===e?r.initialValue:e},this._notifyAll=function(){var t=r.getValue(),e=!0,n=!1,a=void 0;try{for(var i,o=r.callbacks[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){(0,i.value)(t)}}catch(l){n=!0,a=l}finally{try{e||null==o.return||o.return()}finally{if(n)throw a}}},this.registerCallback=function(t){r.callbacks.includes(t)||r.callbacks.push(t)},this.unregisterCallback=function(t){var e=r.callbacks.indexOf(t);e>=0&&r.callbacks.splice(e,1)},this.setValue=function(t){null==t?localStorage.removeItem(r.key):localStorage.setItem(r.key,JSON.stringify(t)),r._notifyAll()},this.use=function(){var t=Object(a.useState)(r.getValue),e=Object(l.a)(t,2),n=e[0],i=e[1];return Object(a.useEffect)((function(){var t=function(t){i(t)};return r.registerCallback(t),function(){return r.unregisterCallback(t)}}),[]),[n,r.setValue]},this.key=e,this.initialValue=n,this.callbacks=[],this.locallyCachedJson=null,this.locallyCachedValue=null},L=function(t,e){return new x(t,e)},M={PATH_LENGTH:"PATH_LENGTH",LIMIT_PATHS:"LIMIT_PATHS",LOW_LATENCY:"LOW_LATENCY",ANIMATION_DELAY:"ANIMATION_DELAY",FPS_LIMIT:"FPS_LIMIT",FPS_RATE:"FPS_RATE",GPS_ENABLED:"GPS_ENABLED"},N=function(t,e){return L("SETTINGS_"+t,e)},F={PATH_LENGTH:N(M.PATH_LENGTH,15),LIMIT_PATHS:N(M.LIMIT_PATHS,!1),LOW_LATENCY:N(M.LOW_LATENCY,!1),ANIMATION_DELAY:N(M.ANIMATION_DELAY,80),FPS_LIMIT:N(M.FPS_LIMIT,!0),FPS_RATE:N(M.FPS_RATE,10),GPS_ENABLED:N(M.GPS_ENABLED,!0)},R=function(t){return F[t]},V=function(){function t(e,n,a,r){var i=this;Object(I.a)(this,t),this.formatSubscribedFlights=function(){return i.subscribedFlights.map((function(t){var e=Object(l.a)(t,2),n=e[0],a=e[1];return{flightUuid:n,start:null===a?null:new Date(1e3*a).toISOString()}}))},this.refreshSubscribedFlights=function(){if(i.sock.readyState===WebSocket.OPEN&&i.connected){var t=i.formatSubscribedFlights();i.sock.send(JSON.stringify({tag:"WebFollow",contents:t}))}},this.setSubscribedFlights=function(t){i.subscribedFlights=t,i.refreshSubscribedFlights()},this.onOpen=function(){i.handleReset(),console.debug("WebSocket: Open!"),i.setConnectionState(ft.ESTABLISHED),i.connected=!0,i.sock.send(JSON.stringify({tag:"WebFilterArea",area:[{lat:-90,lon:-180},{lat:90,lon:180}]})),i.sock.send(JSON.stringify({tag:"WebFilterContest",contents:"alpha9999"}));var t=i.formatSubscribedFlights();i.sock.send(JSON.stringify({tag:"WebFollow",contents:t}))},this.onMessage=function(t){console.debug("WebSocket: Message!"),i.setConnectionState(ft.ACTIVE);var e=JSON.parse(t.data);clearTimeout(i.watchdog),i.watchdog=setTimeout((function(){i.setConnectionState(ft.INACTIVE)}),7e4),i.processMessage(e)},this.onClose=function(t){i.connected=!1,console.debug("WebSocket: Close!"),i.setConnectionState(ft.NO_CONNECTION),setTimeout(i.connect.bind(i),1e3)},this.onError=function(t){i.connected=!1,console.debug("WebSocket: Error!")},this.handleReset=function(){console.log("TODO: handle reset!")},this.processMessage=function(t){if("tag"in t)switch(t.tag){case"LiveFlightInfos":i.dispatchInfoMessage(t.contents);break;case"LiveFlightChunk":i.dispatchTracklogMessage(t);break;case"LiveFlightLanded":i.dispatchFlightLandedMessage(t.flightUuid);break;default:console.warn("Warning: Unknown message tag '".concat(t.tag,"'!"),t)}else console.warn("Warning: Invalid message format!",t)},this.setConnectionState=e,this.dispatchInfoMessage=n,this.dispatchTracklogMessage=a,this.dispatchFlightLandedMessage=r,this.subscribedFlights=[],this.connect(),this.connected=!1,R(M.PATH_LENGTH).registerCallback(this.refreshSubscribedFlights),R(M.LIMIT_PATHS).registerCallback(this.refreshSubscribedFlights)}return Object(D.a)(t,[{key:"connect",value:function(){"WebSocket"in window?(this.connected=!1,this.setConnectionState(ft.CONNECTING),this.sock=new WebSocket("wss://live.xcontest.org/websock/webclient"),this.sock.onopen=this.onOpen,this.sock.onmessage=this.onMessage,this.sock.onclose=this.onClose,this.sock.onerror=this.onError):(this.setConnectionState(ft.ERROR),alert("WebSocket NOT supported by your Browser!"))}}]),t}(),W=n(9);function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z=L("chosen-pilots",{}),B=function(){return z};function U(){return z.getValue()}function Y(t){console.log("Selected pilots updated: ",t),z.setValue(t)}function J(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!0;null===t&&(t=H({},U()),e=!1);var n=gt().getPilotInfos();for(var a in t)if(a in n){var r=n[a].info.user.fullname;r!==t[a]&&(t[a]=r,e=!0)}e&&Y(t)}var q=function(t){var e=H({},U()),n=!1,a=!0,r=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;s in e||(e[s]=s,n=!0)}}catch(c){r=!0,i=c}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}n&&J(e)},Z=function(t){var e=H({},U()),n=!1,a=!0,r=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;s in e&&(delete e[s],n=!0)}}catch(c){r=!0,i=c}finally{try{a||null==l.return||l.return()}finally{if(r)throw i}}n&&Y(e)};var K=function(t,e,n){return null===e?t:null===t?e:(1-n)*t+n*e},X=function(t,e,n,a,r,i,o,l,s){i-=e,l-=e;var c=((n-t)*(s-=e)+t*(a-=e)-n*(e=0))/(a-e),u=((r-n)*s+n*i-r*a)/(i-a),p=((o-r)*s+r*l-o*i)/(l-i),f=((u-c)*s+c*i-u*e)/(i-e),h=((p-u)*s+u*l-p*a)/(l-a);return((h-f)*s+f*i-h*a)/(i-a)},$=function(t,e,n,a,r,i,o,l,s){i-=e,l-=e;var c=((n-t)*(s-=e)+t*(a-=e)-n*(e=0))/(a-e),u=((r-n)*s+n*i-r*a)/(i-a),p=((o-r)*s+r*l-o*i)/(l-i),f=(n-t)/(a-e),h=(r-n)/(i-a),d=(o-r)/(l-i),g=(h*s+u-f*s-c+f*i-h*e)/(i-e),m=(d*s+p-h*s-u+h*l-d*a)/(l-a);return(m*s+((p-u)*s+u*l-p*a)/(l-a)-g*s-((u-c)*s+c*i-u*e)/(i-e)+g*i-m*a)/(i-a)},Q=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return e-t},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return null===t};Object(I.a)(this,t),this.computeDiff=n,this.isInvalid=a,this.old_val=null,this.old_t=null,this.running_avg=null,this.smoothingFactor=e}return Object(D.a)(t,[{key:"update",value:function(t,e){if(null===this.old_val||null===t||null===this.old_t||null===e||this.isInvalid(this.old_val)||this.isInvalid(t)||this.old_t===this.new_t)return this.old_val=t,this.old_t=e,null;var n=e-this.old_t,a=this.computeDiff(this.old_val,t)/n,r=Math.pow(this.smoothingFactor,n);return null===this.running_avg?this.running_avg=a:this.running_avg=r*this.running_avg+(1-r)*a,this.old_val=t,this.old_t=e,this.running_avg}},{key:"reset",value:function(){this.old_val=null,this.old_t=null,this.running_avg=null}}]),t}(),tt=n(31),et=function(t,e,n){if(e<1)return 0;for(var a=-1,r=e,i=0;a<r-1;)n(i=(a+r)/2|0)<t?a=i:r=i;return r},nt=function(t){return Math.round(Date.parse(t)/1e3)},at=function(){function t(){var e=this;Object(I.a)(this,t),this.at=function(t){return e.data[t]},this.findBisect=function(t){return et(t,e.data.length,(function(t){return e.data[t].t}))},this.findForwardSwipe=function(t,n){for(var a=n;a<e.data.length&&e.data[a].t<t;)a+=1;return a},this.getNewestTimestamp=function(){return e.data.length<1?null:e.data[e.data.length-1].t},this.data=[],this.counter_gpsVario=new Q(.7),this.counter_baroVarion=new Q(.7),this.counter_velocity=new Q(.7,(function(t,e){return Object(tt.getDistance)(t,e,.01)}),(function(){return!1}))}return Object(D.a)(t,[{key:"clear",value:function(){this.data=[],this.counter_gpsVario=new Q(.7),this.counter_baroVarion=new Q(.7),this.counter_velocity=new Q(.7,(function(t,e){return Object(tt.getDistance)(t,e,.01)}),(function(){return!1}))}},{key:"isAfterLastElement",value:function(t){return this.data.length<=0||this.data[this.data.length-1].t<t}},{key:"append",value:function(t){var e=!0,n=!1,a=void 0;try{for(var r,i=t[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,l=nt(o.timestamp),s={lat:o.lat,lng:o.lon},c=0===o.baroAlt?null:o.baroAlt,u=0===o.gpsAlt?null:o.gpsAlt,p=this.counter_gpsVario.update(u,l),f=this.counter_baroVarion.update(c,l),h=this.counter_velocity.update(s,l),d={baroAlt:c,gpsAlt:u,elevation:o.elevation,pos:s,gpsVario:p,baroVario:f,velocity:h,t:l};this.data.push(d)}}catch(g){n=!0,a=g}finally{try{e||null==i.return||i.return()}finally{if(n)throw a}}}},{key:"replace",value:function(t){this.clear(),this.append(t)}},{key:"insert",value:function(t){var e=[],n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value,s=nt(l.timestamp),c={lat:l.lat,lng:l.lon},u={baroAlt:0===l.baroAlt?null:l.baroAlt,gpsAlt:0===l.gpsAlt?null:l.gpsAlt,elevation:l.elevation,pos:c,gpsVario:null,baroVario:null,velocity:null,t:s};e.push(u)}}catch(_){a=!0,r=_}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}var p=this.data;this.data=[];for(var f=0,h=0;!(f>=p.length&&h>=e.length);)if(f>=p.length)this.data.push(e[h]),h+=1;else if(h>=e.length)this.data.push(p[f]),f+=1;else{var d=p[f],g=e[h];g.t<d.t?(this.data.push(g),h+=1):d.t<g.t?(this.data.push(d),f+=1):(this.data.push(g),f+=1,h+=1)}this.counter_gpsVario.reset(),this.counter_baroVarion.reset(),this.counter_velocity.reset();var m=!0,b=!1,v=void 0;try{for(var y,O=this.data[Symbol.iterator]();!(m=(y=O.next()).done);m=!0){var k=y.value,E=this.counter_gpsVario.update(k.gpsAlt,k.t),w=this.counter_baroVarion.update(k.baroAlt,k.t),P=this.counter_velocity.update(k.pos,k.t);k.gpsVario=E,k.baroVario=w,k.velocity=P}}catch(_){b=!0,v=_}finally{try{m||null==O.return||O.return()}finally{if(b)throw v}}}},{key:"length",get:function(){return this.data.length}}]),t}();function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ot=function t(){var e=this;Object(I.a)(this,t),this.reset=function(){e.currentArrayPos=null,e.mapsPath=[],e.mapsPathNewestPos=0},this.currentArrayPos=null,this.mapsPath=[],this.mapsPathNewestPos=0},lt=function(){function t(){Object(I.a)(this,t)}return Object(D.a)(t,null,[{key:"takeData",value:function(t){return{baroAlt:t.baroAlt,gpsAlt:t.gpsAlt,elevation:t.elevation,pos:{lat:t.pos.lat,lng:t.pos.lng},gpsVario:t.gpsVario,baroVario:t.baroVario,velocity:t.velocity}}},{key:"blendData",value:function(t,e,n){var a=(n-t.t)/(e.t-t.t);return{baroAlt:K(t.baroAlt,e.baroAlt,a),gpsAlt:K(t.gpsAlt,e.gpsAlt,a),elevation:K(t.elevation,e.elevation,a),pos:{lat:K(t.pos.lat,e.pos.lat,a),lng:K(t.pos.lng,e.pos.lng,a)},gpsVario:K(t.gpsVario,e.gpsVario,a),baroVario:K(t.baroVario,e.baroVario,a),velocity:K(t.velocity,e.velocity,a)}}},{key:"blendDataSpline",value:function(t,e,n,a,r){var i=(r-e.t)/(n.t-e.t);return{baroAlt:K(e.baroAlt,n.baroAlt,i),gpsAlt:K(e.gpsAlt,n.gpsAlt,i),elevation:K(e.elevation,n.elevation,i),pos:{lat:X(t.pos.lat,t.t,e.pos.lat,e.t,n.pos.lat,n.t,a.pos.lat,a.t,r),lng:X(t.pos.lng,t.t,e.pos.lng,e.t,n.pos.lng,n.t,a.pos.lng,a.t,r)},gpsVario:K(e.gpsVario,n.gpsVario,i),baroVario:K(e.baroVario,n.baroVario,i),velocity:K(e.velocity,n.velocity,i)}}},{key:"computeLinearVelocity",value:function(t,e){var n=t.t,a=e.t;if(n===a)return null;var r=a-n,i=t.pos,o=e.pos;return{lat:(o.lat-i.lat)/r,lng:(o.lng-i.lng)/r}}},{key:"computeSplineVelocity",value:function(t,e,n,a,r){var i=t.t,o=e.t,l=n.t,s=a.t,c=t.pos,u=e.pos,p=n.pos,f=a.pos;return{lat:$(c.lat,i,u.lat,o,p.lat,l,f.lat,s,r),lng:$(c.lng,i,u.lng,o,p.lng,l,f.lng,s,r)}}}]),t}();lt.fallbackData=function(t){return{baroAlt:t.lastFix.baroAlt,gpsAlt:t.lastFix.gpsAlt,elevation:t.lastFix.elevation,pos:{lat:t.lastFix.lat,lng:t.lastFix.lon},gpsVario:null,baroVario:null,velocity:null}};var st=function t(e){var n=this;Object(I.a)(this,t),this.destroy=function(){R(M.ANIMATION_DELAY).unregisterCallback(n.updateSettings),R(M.LOW_LATENCY).unregisterCallback(n.updateSettings),R(M.PATH_LENGTH).unregisterCallback(n.updateSettings),R(M.LIMIT_PATHS).unregisterCallback(n.updateSettings)},this.updateSettings=function(){n.settings={timeOffsetSeconds:R(M.ANIMATION_DELAY).getValue(),lowLatencyMode:R(M.LOW_LATENCY).getValue(),trackLengthMinutes:R(M.PATH_LENGTH).getValue(),limitTracks:R(M.LIMIT_PATHS).getValue()},n.liveDataCache.reset(),n.flightInfoDataCache.reset()},this.updateInfos=function(t){n.landed|=t.landed,n.flightInfos=t,n.flightInfoData.replace(t.track),n.flightInfoDataCache.reset()},this.updateData=function(t){if(!(t.length<1)){var e=nt(t[0].timestamp);n.liveData.isAfterLastElement(e)?n.liveData.append(t):(n.liveData.insert(t),n.liveDataCache.reset())}},this.updateLanded=function(){console.log("Received flight landed message!"),n.landed=!0},this.getInterpolatedData=function(t,e,n){if(t.length<1)return null;null===e.currentArrayPos?e.currentArrayPos=t.findBisect(n):e.currentArrayPos=t.findForwardSwipe(n,e.currentArrayPos);var a=null,r=!1,i=!1,o=null;if(e.currentArrayPos<=0)a=lt.takeData(t.at(0)),t.length>=2&&(o=lt.computeLinearVelocity(t.at(0),t.at(1))),i=!0;else if(e.currentArrayPos>=t.length)a=lt.takeData(t.at(t.length-1)),t.length>=2&&(o=lt.computeLinearVelocity(t.at(t.length-2),t.at(t.length-1))),r=!0;else{var l=t.at(e.currentArrayPos-1),s=t.at(e.currentArrayPos),c=e.currentArrayPos-2>=0?t.at(e.currentArrayPos-2):it({},l,{t:l.t-1}),u=e.currentArrayPos+1<t.length?t.at(e.currentArrayPos+1):it({},s,{t:s.t+1});a=lt.blendDataSpline(c,l,s,u,n),o=lt.computeSplineVelocity(c,l,s,u,n)}return[a,i,r,t.at(t.length-1).t,o]},this.getFallbackData=function(){return[lt.fallbackData(n.flightInfos),!1,!0,nt(n.flightInfos.lastFix.timestamp),null]},this.computeTrack=function(t,e,a){if(t.length<1)return null;for(var r=a-60*n.settings.trackLengthMinutes,i=e.mapsPath;e.mapsPathNewestPos<t.length&&t.at(e.mapsPathNewestPos).t<a;){var o=t.at(e.mapsPathNewestPos);i.push({lat:o.pos.lat,lng:o.pos.lng,timestamp:o.t,elevation:o.gpsAlt}),e.mapsPathNewestPos+=1}if(n.settings.limitTracks){for(var l=0;l+32-1<i.length&&i[l+32-1].timestamp<r;)l+=32;l>0&&(i=i.slice(l),e.mapsPath=i)}return i},this.updateAnimation=function(t){var e=n.settings.lowLatencyMode?t/1e3:t/1e3-n.settings.timeOffsetSeconds,a=n.getInterpolatedData(n.liveData,n.liveDataCache,e);a||(a=n.getInterpolatedData(n.flightInfoData,n.flightInfoDataCache,e)),a||(a=n.getFallbackData());var r=n.computeTrack(n.liveData,n.liveDataCache,e);r||(r=n.computeTrack(n.flightInfoData,n.flightInfoDataCache,e)),r||(r=[]);var i=a,o=Object(l.a)(i,5),s=o[0],c=o[1],u=o[2],p=o[3],f=o[4];return n.settings.lowLatencyMode&&(u=!!n.landed||p<e-80),it({},s,{startOfTrack:c,endOfTrack:u,landed:n.landed,name:n.flightInfos.info.user.fullname,newestDataTimestamp:p,track:r,velocityVec:f})},this.getNewestTimestamp=function(){return n.liveData.getNewestTimestamp()},this.liveData=new at,this.liveDataCache=new ot,this.flightInfos=null,this.flightInfoData=new at,this.flightInfoDataCache=new ot,this.landed=e.landed,this.updateInfos(e),this.settings={},this.updateSettings(),R(M.ANIMATION_DELAY).registerCallback(this.updateSettings),R(M.LOW_LATENCY).registerCallback(this.updateSettings),R(M.PATH_LENGTH).registerCallback(this.updateSettings),R(M.LIMIT_PATHS).registerCallback(this.updateSettings)},ct=function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;Object(I.a)(this,t),this.get=function(t,n){var a=t+e.offset,r=a-n;return(r>e.tolerance||r<-e.tolerance)&&(e.offset-=r,a=t+e.offset),a},this.offset=0,this.tolerance=n};var ut=function t(e){var n=this;Object(I.a)(this,t),this._nextUpdate=Date.now(),this.animationLoop=function(){var t=Date.now(),e=1e3/n._setting_fps;if(!n._setting_limitFps||t>=n._nextUpdate){n._setting_limitFps&&(n._nextUpdate+=e,t>n._nextUpdate&&(n._nextUpdate=t));var a={};Object.keys(n._subscribedPilots).forEach((function(e){if(e in n._pilotInfos){var r=n._pilotInfos[e].flightId;if(r in n._flightAnimations){var i=n._flightAnimations[r];a[e]=i.updateAnimation(t)}}})),n._submitAnimationFrame(a)}requestAnimationFrame(n.animationLoop)},this._submitAnimationFrame=function(t){n._currentAnimationData=t;var e=!0,a=!1,r=void 0;try{for(var i,o=n._callbacks[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){(0,i.value)(t)}}catch(l){a=!0,r=l}finally{try{e||null==o.return||o.return()}finally{if(a)throw r}}},this.setSubscribedPilots=function(t){n._subscribedPilots=t,n._updateImportantFlights()},this.pushNewInfo=function(t){console.log("newInfo: ",t),n._pilotInfos=t,n._updateImportantFlights(),Object.values(t).forEach((function(t){var e=t.flightId;e in n._flightAnimations&&n._flightAnimations[e].updateInfos(t)}))},this.pushNewData=function(t,e){console.log("newTrackdata: ",t,e),t in n._flightAnimations&&n._flightAnimations[t].updateData(e)},this.pushFlightLanded=function(t){t in n._flightAnimations&&n._flightAnimations[t].updateLanded()},this.registerCallback=function(t){n._callbacks.includes(t)||n._callbacks.push(t),t(n._currentAnimationData)},this.unregisterCallback=function(t){var e=n._callbacks.indexOf(t);e>=0&&n._callbacks.splice(e,1)},this.getData=function(){return n._currentAnimationData},this._updateImportantFlights=function(){var t={};Object.values(n._pilotInfos).filter((function(t){return t.info.user.username in n._subscribedPilots})).forEach((function(e){t[e.flightId]=e}));var e=new Set(Object.keys(t)),a=[];for(var r in n._flightAnimations)r in t||a.push(r);for(var i=0,o=a;i<o.length;i++){var s=o[i];console.log("Removing flightAnimation of '"+s+"' ..."),n._flightAnimations[s].destroy(),delete n._flightAnimations[s]}if(Object.entries(t).forEach((function(t){var e=Object(l.a)(t,2),a=e[0],r=e[1];a in n._flightAnimations||(n._flightAnimations[a]=new st(r))})),!function(t,e){if(t.size!==e.size)return!1;var n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value;if(!e.has(l))return!1}}catch(s){a=!0,r=s}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return!0}(e,n._subscribedFlights)){n._subscribedFlights=e;var c=[];console.log(n._flightAnimations),e.forEach((function(t){console.log(t,n._flightAnimations[t]),c.push([t,n._flightAnimations[t].getNewestTimestamp()])})),console.log("Changing flight subscribtion: ",n._subscribedFlights,e),n._setSubscribedFlightsCallback(c)}},this._currentAnimationData={},this._callbacks=[],this._subscribedPilots=U(),this._subscribedFlights=new Set,this._pilotInfos={},this._flightAnimations={},this._highPrecisionTimeSync=new ct;var a=R(M.FPS_LIMIT),r=R(M.FPS_RATE);this._setting_limitFps=a.getValue(),this._setting_fps=r.getValue(),a.registerCallback((function(t){n._setting_limitFps=t})),r.registerCallback((function(t){n._setting_fps=t})),this._setSubscribedFlightsCallback=function(t){e(Array.from(t))},B().registerCallback(this.setSubscribedPilots),requestAnimationFrame(this.animationLoop)},pt=function t(e){var n=this;Object(I.a)(this,t),this.set=function(t){n._callbackData=t;var e=!0,a=!1,r=void 0;try{for(var i,o=n._callbacks[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){(0,i.value)(t)}}catch(l){a=!0,r=l}finally{try{e||null==o.return||o.return()}finally{if(a)throw r}}},this.getValue=function(){return n._callbackData},this.registerCallback=function(t){n._callbacks.includes(t)||n._callbacks.push(t)},this.unregisterCallback=function(t){var e=n._callbacks.indexOf(t);e>=0&&n._callbacks.splice(e,1)},this.use=function(){var t=Object(a.useState)(n._callbackData),e=Object(l.a)(t,2),r=e[0],i=e[1];return Object(a.useEffect)((function(){return n.registerCallback(i),function(){return n.unregisterCallback(i)}}),[]),r},this._callbacks=[],this._callbackData=e},ft={CONNECTING:"connecting",ERROR:"error",ESTABLISHED:"established",ACTIVE:"active",INACTIVE:"inactive",NO_CONNECTION:"no connection",NO_INFORMATION:"no information"},ht=function t(){var e=this;Object(I.a)(this,t),this.setSubscribedFlights=function(t){e.socket.setSubscribedFlights(t)},this.getPilotInfos=function(){return e.pilots},this.onConnectionStateChanged=function(t){e.connectionState.set(t)},this.onInfoMessageReceived=function(t){e.pilots={};var n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,c=Object(l.a)(s,2),u=c[0],p=c[1];p.overriden||(p.flightId=u,e.pilots[p.info.user.username]=p)}}catch(f){a=!0,r=f}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}e.animation.pushNewInfo(e.pilots),e.pilotInfos.set(e.pilots),J()},this.onTracklogMessageReceived=function(t){e.animation.pushNewData(t.flightUuid,t.trackChunk)},this.onFlightLandedMessageReceived=function(t){e.animation.pushFlightLanded(t)},this.pilots=[],this.connectionState=new pt(ft.NO_INFORMATION),this.pilotInfos=new pt([]),this.socket=new V(this.onConnectionStateChanged,this.onInfoMessageReceived,this.onTracklogMessageReceived,this.onFlightLandedMessageReceived),this.animation=new ut(this.setSubscribedFlights)},dt=null,gt=function(){return dt||(dt=new ht),dt};function mt(t){var e,n,a,r,i=function(t){for(var e=0,n=1779033703^t.length;e<t.length;e++)n=(n=Math.imul(n^t.charCodeAt(e),3432918353))<<13|n>>>19;return function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}}(t);return e=i(),n=i(),a=i(),r=i(),function(){var t=(e>>>=0)+(n>>>=0)|0;return e=n^n>>>9,n=(a>>>=0)+(a<<3)|0,a=(a=a<<21|a>>>11)+(t=t+(r=1+(r>>>=0)|0)|0)|0,(t>>>0)/4294967296}}var bt=n(105),vt=n.n(bt);function yt(t,e){var n=mt(t),a=Math.min(Math.max(360*n(),0),360);return"#"+vt.a.hsl.hex(a,100,e)}var Ot=function(t){return yt(t,70)},kt=function(t,e,n,a,r,i){return e?n?{path:"m 12.66,19.78 6.46,-4.61 C 19.67,14.78 20,14.15 20,13.48 20,11.77 18.08,10.79 16.7,11.77 L 12,15.12 7.3,11.77 c -1.38,-0.99 -3.3,0 -3.3,1.71 0,0.67 0.33,1.31 0.88,1.7 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z m 0,-8 6.46,-4.6 C 19.67,6.78 20,6.15 20,5.48 20,3.77 18.08,2.78 16.7,3.77 L 12,7.12 7.3,3.77 C 5.92,2.78 4,3.77 4,5.48 4,6.15 4.33,6.79 4.88,7.18 l 6.46,4.62 c 0.4,0.27 0.93,0.27 1.33,-0.01 z",fillColor:i,fillOpacity:1,anchor:{x:12,y:20},strokeWeight:1,scale:1.2}:{path:"M 12.747,2 C 12.492,1.998 12.234,2.006 11.973,2.023 8.105,2.256 6.071,4.458 5.904,8.427 H 9.806 C 9.839,7.06 10.64,6.025 12.041,5.859 c 1.401,-0.133 2.735,0.2 3.135,1.134 0.434,1.034 -0.534,2.234 -1.001,2.734 -0.867,0.934 -2.268,1.634 -3.002,2.635 -0.7,1.001 -0.834,2.302 -0.901,3.902 h 3.435 c 0.033,-1.034 0.1,-2.001 0.567,-2.635 0.767,-1.034 1.901,-1.501 2.835,-2.335 0.9,-0.767 1.868,-1.701 2.001,-3.168 C 19.642,4.093 16.568,2.023 12.747,2 Z M 12.074,17.731 A 2.168,2.134 0 0 0 9.906,19.865 2.168,2.134 0 0 0 12.074,22 2.168,2.134 0 0 0 14.242,19.865 2.168,2.134 0 0 0 12.074,17.731 Z",fillColor:i,fillOpacity:1,anchor:{x:12,y:12},strokeWeight:1,scale:1.2}:t?{path:"M 12,2 C 8.13,2 5,5.13 5,9 c 0,5.25 7,13 7,13 0,0 7,-7.75 7,-13 0,-3.87 -3.13,-7 -7,-7",fillColor:i,fillOpacity:1,anchor:{x:12,y:22},strokeWeight:1,scale:1.2}:{path:"M12.93 4.26l6.15 14.99c.34.83-.51 1.66-1.33 1.29l-5.34-2.36c-.26-.11-.55-.11-.81 0l-5.34 2.36c-.82.36-1.67-.46-1.33-1.29l6.15-14.99c.33-.83 1.51-.83 1.85 0z",fillColor:i,fillOpacity:1,anchor:{x:12,y:12},strokeWeight:1,scale:1.2,rotation:null===r?0:Object(tt.getRhumbLineBearing)(a,{lat:a.lat+r.lat,lng:a.lng+r.lng})}},Et=function t(e,n,a,r,i){var o=this;Object(I.a)(this,t),this.setMap=function(t){o.marker.setMap(t),o.track.setMap(t),o.newestTrackSegment.setMap(t)},this._updateTrack=function(t){if(t&&!(t.length<1)){var e=t.length,n=t[0].timestamp,a=t[e-1].timestamp;n===o.currentTrackVersion.startTime&&a===o.currentTrackVersion.endTime&&e===o.currentTrackVersion.length||(o.currentTrackVersion.startTime=n,o.currentTrackVersion.endTime=a,o.currentTrackVersion.length=e,o.track.setPath(t))}},this.updateData=function(t){o.marker.setPosition(t.pos);var e=o.marker.getIcon(),n=kt(t.startOfTrack,t.endOfTrack,t.landed,t.pos,t.velocityVec,o.pilotColor);(function(t,e){for(var n in t)if(!(n in e))return!0;for(var a in e){if(!(a in t))return!0;if("anchor"===a){if(t[a].x!==e[a].x||t[a].y!==e[a].y)return!0}else if(t[a]!==e[a])return!0}return!1})(e,n)&&o.marker.setIcon(n),t.track.length>0&&o.newestTrackSegment.setPath([t.track[t.track.length-1],t.pos]),o._updateTrack(t.track)},this.google=e,this.pilotInfoWindow=i,this.pilotColor=Ot(a.info.user.username),this.trackColor=yt(a.info.user.username,40),this.pilotIcon=kt(r.startOfTrack,r.endOfTrack,r.landed,r.pos,r.velocityVec,this.pilotColor),this.marker=new this.google.maps.Marker({map:n,position:r.pos,title:a.info.user.fullname,icon:this.pilotIcon}),this.marker.addListener("click",(function(){o.pilotInfoWindow.open(o.map,o.marker,a.info.user.username)})),this.track=new this.google.maps.Polyline({map:n,path:[],strokeColor:this.trackColor}),this.currentTrackVersion={startTime:null,endTime:null,length:null},this.newestTrackSegment=new this.google.maps.Polyline({map:n,path:[],strokeColor:this.trackColor})},wt=function t(e){var n=this;Object(I.a)(this,t),this.open=function(t,e,a){n.currentPilot=a,n.infoWindow.open(t,e),n.updateContent()},this.update=function(t){n.data=t,n.updateContent()},this.updateContent=function(){if(null!=n.infoWindow.anchor){if(null!==n.currentPilot){if(!(n.currentPilot in n.data))return n.currentPilot=null,void n.infoWindow.close();var t=n.data[n.currentPilot],e=null===t.gpsAlt?t.baroAlt:t.gpsAlt,a=Math.max(e-t.elevation,0),r="";if(r+="<b>"+t.name+"</b><br>",r+=Math.round(e)+"m (",r+=Math.round(a)+"m)<br>",null!==t.baroVario&&!t.landed){var i=Math.round(10*t.baroVario),o=Math.abs(i);o>99&&(o=99),r+="<span>"+((i>=0?"&plus;":"&minus;")+Math.floor(o/10)+"."+o%10+"m/s")+"</span>&nbsp;&nbsp;"}null===t.velocity||t.landed||(r+=Math.round(3.6*t.velocity)+"km/h"),n.infoWindow.getContent()!==r&&n.infoWindow.setContent(r)}}else n.currentPilot=null},this.google=e,this.infoWindow=new e.maps.InfoWindow({content:"- ERROR -",pixelOffset:new e.maps.Size(0,-5),disableAutoPan:!0}),this.data={},this.currentPilot=null},Pt=function t(e,n){var a=this;Object(I.a)(this,t),this.cleanupOldTracks=function(t){var e=[];for(var n in a.tracks)n in t||e.push(n);for(var r=0,i=e;r<i.length;r++){var o=i[r];a.tracks[o].setMap(null),delete a.tracks[o]}},this.update=function(t){var e=gt().getPilotInfos();a.cleanupOldTracks(t),Object.entries(t).forEach((function(t){var n=Object(l.a)(t,2),r=n[0],i=n[1];if(r in e){var o=e[r];r in a.tracks||(a.tracks[r]=new Et(a.google,a.map,o,i,a.infoWindow)),a.tracks[r].updateData(i)}})),a.infoWindow.update(t)},this.map=e,this.google=n,this.tracks={},this.infoWindow=new wt(n)},_t=n(34),jt=(n(191),n(18)),St=n(19),Ct=n(16),Tt=n(20);var At=Object(_t.a)((function(){var t=k(),e=Object(l.a)(t,3),n=e[0],i=e[1],o=e[2],c=Object(a.useRef)(),u=Object(a.useState)(null),p=Object(l.a)(u,2),f=p[0],h=p[1];return Object(a.useLayoutEffect)((function(){n&&!f&&h(new o.maps.Map(c.current,{center:{lat:46.509012,lng:11.827984},mapTypeId:"terrain",zoom:12,maxZoom:15,disableDefaultUI:!0,scaleControl:!0,fullscreenControl:!0,styles:A}))}),[n,f,o,c]),Object(a.useEffect)((function(){if(f&&o){var t=new Pt(f,o).update;return gt().animation.registerCallback(t),function(t,e){var n=function(e){function n(e,a,r,i){var o;Object(I.a)(this,n),(o=Object(jt.a)(this,Object(St.a)(n).call(this))).outerMarker_=null,o.marker_=null,o.circle_=null,o.watchId_=-1;var l={clickable:!1,cursor:"pointer",draggable:!1,flat:!0,icon:{path:t.maps.SymbolPath.CIRCLE,fillColor:"#C8D6EC",fillOpacity:.7,scale:12,strokeWeight:0},position:new t.maps.LatLng(0,0),title:"Current location",zIndex:2},s={clickable:!1,cursor:"pointer",draggable:!1,flat:!0,icon:{path:t.maps.SymbolPath.CIRCLE,fillColor:"#4285F4",fillOpacity:1,scale:6,strokeColor:"white",strokeWeight:2},optimized:!1,position:new t.maps.LatLng(0,0),title:"Current location",zIndex:3};a&&(l=o.copyOptions_(l,a)),r&&(s=o.copyOptions_(s,r));var c={clickable:!1,radius:0,strokeColor:"1bb6ff",strokeOpacity:.4,fillColor:"61a0bf",fillOpacity:.4,strokeWeight:1,zIndex:1};return i&&(c=o.copyOptions_(c,i)),o.outerMarker_=new t.maps.Marker(l),o.marker_=new t.maps.Marker(s),o.circle_=new t.maps.Circle(c),t.maps.MVCObject.prototype.set.call(Object(Ct.a)(o),"accuracy",null),t.maps.MVCObject.prototype.set.call(Object(Ct.a)(o),"position",null),t.maps.MVCObject.prototype.set.call(Object(Ct.a)(o),"map",null),o.set("minimum_accuracy",null),o.set("position_options",{enableHighAccuracy:!0,maximumAge:1e3}),o.circle_.bindTo("map",o.outerMarker_),o.circle_.bindTo("map",o.marker_),e&&o.setMap(e),o}return Object(Tt.a)(n,e),Object(D.a)(n,[{key:"set",value:function(e,a){if(n.invalidPropertiesExpr_.test(e))throw new Error("'"+e+"' is a read-only property.");"map"===e?this.setMap(a):t.maps.MVCObject.prototype.set.call(this,e,a)}},{key:"getMap",value:function(){return this.get("map")}},{key:"getPositionOptions",value:function(){return this.get("position_options")}},{key:"setPositionOptions",value:function(t){this.set("position_options",t)}},{key:"getPosition",value:function(){return this.get("position")}},{key:"getBounds",value:function(){return this.get("position")?this.circle_.getBounds():null}},{key:"getAccuracy",value:function(){return this.get("accuracy")}},{key:"getMinimumAccuracy",value:function(){return this.get("minimum_accuracy")}},{key:"setMinimumAccuracy",value:function(t){this.set("minimum_accuracy",t)}},{key:"setMap",value:function(e){t.maps.MVCObject.prototype.set.call(this,"map",e),e?this.watchPosition_():(this.outerMarker_.unbind("position"),this.marker_.unbind("position"),this.circle_.unbind("center"),this.circle_.unbind("radius"),t.maps.MVCObject.prototype.set.call(this,"accuracy",null),t.maps.MVCObject.prototype.set.call(this,"position",null),navigator.geolocation.clearWatch(this.watchId_),this.watchId_=-1,this.outerMarker_.setMap(e),this.marker_.setMap(e))}},{key:"setOuterMarkerOptions",value:function(t){this.outerMarker_.setOptions(this.copyOptions_({},t))}},{key:"setMarkerOptions",value:function(t){this.marker_.setOptions(this.copyOptions_({},t))}},{key:"setCircleOptions",value:function(t){this.circle_.setOptions(this.copyOptions_({},t))}},{key:"updatePosition_",value:function(e){var n=new t.maps.LatLng(e.coords.latitude,e.coords.longitude),a=null==this.marker_.getMap();if(a){if(null!=this.getMinimumAccuracy()&&e.coords.accuracy>this.getMinimumAccuracy())return;this.outerMarker_.setMap(this.getMap()),this.marker_.setMap(this.getMap()),this.outerMarker_.bindTo("position",this),this.marker_.bindTo("position",this),this.circle_.bindTo("center",this,"position"),this.circle_.bindTo("radius",this,"accuracy")}this.getAccuracy()!==e.coords.accuracy&&t.maps.MVCObject.prototype.set.call(this,"accuracy",e.coords.accuracy),!a&&null!=this.getPosition()&&this.getPosition().equals(n)||t.maps.MVCObject.prototype.set.call(this,"position",n)}},{key:"watchPosition_",value:function(){navigator.geolocation&&(this.watchId_=navigator.geolocation.watchPosition(this.updatePosition_.bind(this),this.geolocationError_.bind(this),this.getPositionOptions()))}},{key:"geolocationError_",value:function(e){t.maps.event.trigger(this,"geolocation_error",e)}},{key:"copyOptions_",value:function(t,e){for(var a in e)!0!==n.DISALLOWED_OPTIONS[a]&&(t[a]=e[a]);return t}}]),n}(t.maps.MVCObject);return n.DISALLOWED_OPTIONS={map:!0,position:!0,radius:!0},n.invalidPropertiesExpr_=/^(?:position|accuracy)$/i,new n(e)}(o,f).setPositionOptions({enableHighAccuracy:!0}),function(){gt().animation.unregisterCallback(t)}}}),[f,o]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"block":"none",ref:c}),r.a.createElement(C,{message:"Loading Maps ...",hideIf:n||i}),r.a.createElement(T,{message:"Unable to load map!",hideIf:!i}))})),It=n(243),Dt=n(110),xt=n.n(Dt),Lt=n(236),Mt=n(14),Nt=n(257),Ft=n(238),Rt=n(239),Vt=n(234),Wt=[];window.addEventListener("popstate",(function(){0===Wt.length&&console.warn("History was already 0!");var t=Wt.pop();console.debug("- History size:",Wt.length),Wt.length>0&&window.history.pushState({},""),t&&t()}),{passive:!0});var Gt=function(t){var e=Object(a.useState)(!1),n=Object(l.a)(e,2),i=n[0],o=n[1],s=Object(a.useState)(!1),c=Object(l.a)(s,2),u=c[0],p=c[1],f={push:function(t){var e=Wt.length;Wt.push(t),console.debug("+ History size:",Wt.length),0===e&&window.history.pushState({},"")},pop:function(){window.history.back()}};return t.open&&!i&&(u?t.onClose():(f.push((function(){o(!1),t.onClose()})),o(!0),p(!0))),!u||i||t.open||p(!1),i&&!t.open&&f.pop(),r.a.createElement(Vt.a,{open:i,onClose:function(){t.onClose()},fullScreen:t.fullScreen,maxWidth:t.maxWidth,fullWidth:t.fullWidth,classes:t.classes},t.children)};var Ht=function t(){var e=this;Object(I.a)(this,t),this._updateGPSState=function(){var t=R(M.GPS_ENABLED).getValue(),n=e._callbacks.length>0,a=t&&n;null===e._watchId&&a&&navigator.geolocation&&(e._watchId=navigator.geolocation.watchPosition(e._onNewGPSData,e._onGPSError,{enableHighAccuracy:!0}),console.log("GPS: On")),null===e._watchId||a||(navigator.geolocation.clearWatch(e._watchId),e._watchId=null,e._setGPSData(null),console.log("GPS: Off"))},this._setGPSData=function(t){console.log("GPS DATA:",t),e._gpsData=t;var n=!0,a=!1,r=void 0;try{for(var i,o=e._callbacks[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(t)}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}},this._onNewGPSData=function(t){e._setGPSData(t)},this._onGPSError=function(){e._setGPSData(null)},this.registerCallback=function(t){e._callbacks.includes(t)||e._callbacks.push(t),e._updateGPSState(),t(e._gpsData)},this.unregisterCallback=function(t){var n=e._callbacks.indexOf(t);n>=0&&e._callbacks.splice(n,1),e._updateGPSState()},this.getData=function(){return e._gpsData},this._callbacks=[],this._watchId=null,this._gpsData=null,R(M.GPS_ENABLED).registerCallback(this._updateGPSState),this._updateGPSState()},zt=null,Bt=function(){return zt||(zt=new Ht),zt},Ut=n(260),Yt=function(t){var e="rotate("+t.toString()+"deg)";return{transform:e,WebkitTransform:e,MozTransform:e,msTransform:e,OTransform:e}};function Jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jt(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Zt=function(t){function e(t){var n;return Object(I.a)(this,e),(n=Object(jt.a)(this,Object(St.a)(e).call(this,t))).getMessage=function(t){var e=t.timestamp,n=t.endOfTrack,a=t.landed,r=t.relative,i=t.showLastFix;if(null==e)return["","never"];var o=new Date(e).getTime()-Date.now(),l="";return l=r?function(t){var e="";t<0&&(t=-t,e="-");var n=Math.floor(t/1e3);if(n<90)return e+n+" sec";var a=Math.floor(n/60);if(a<60)return e+a+" min";var r=Math.floor(a/60);if(a-=60*r,r<24)return e+r+":"+a.toString().padStart(2,"0")+" h";var i=Math.floor(r/24);return e+i+"d "+(r-=24*i)+":"+a.toString().padStart(2,"0")+" h"}(o):function(t){return new Date(t).toLocaleTimeString()}(e),n&&a?["#346B8F","\u2714 "+l]:-o<12e4&&!n?r?i?["green","\u26ab LIVE ("+l+")"]:["green","\u26ab LIVE"]:["green","\u26ab "+l]:r?["red","! LIVE ("+l+")"]:["red","! "+l]},n.shallowRerender=function(t){if(null!==n.msgRef.current){var e=n.msgRef.current,a=n.getMessage(t),r=Object(l.a)(a,2),i=r[0],o=r[1];Object.assign(e.style,{color:i}),e.innerHTML!==o&&(e.innerHTML=o)}},n.msgRef=r.a.createRef(),n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"render",value:function(){var t=this.getMessage(this.props),e=Object(l.a)(t,2),n=e[0],a=e[1];return r.a.createElement("span",{style:{color:n},ref:this.msgRef},a)}}]),e}(r.a.PureComponent),Kt=function(t){function e(t){var n;return Object(I.a)(this,e),(n=Object(jt.a)(this,Object(St.a)(e).call(this,t))).onNewGPSDataReceived=function(t){n.gpsData=t,n.updateThroughRef()},n.setFix=function(t){n.lastFix=t,n.updateThroughRef()},n.updateThroughRef=function(){if(n.arrowRef.current){var t=e.getArrowRotationStyle(n.gpsData,n.lastFix);Object.assign(n.arrowRef.current.style,t)}if(n.distanceRef.current){var a=e.getDistance(n.gpsData,n.lastFix);a!==n.distanceRef.current.innerHTML&&(n.distanceRef.current.innerHTML=a)}},n.gpsData=Bt().getData(),n.distanceRef=r.a.createRef(),n.arrowRef=r.a.createRef(),n.lastFix=n.props.lastFix,n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"componentDidMount",value:function(){Bt().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function(){Bt().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function(){return this.lastFix=this.props.lastFix,r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{ref:this.distanceRef},e.getDistance(this.gpsData,this.lastFix))," ",r.a.createElement("div",{ref:this.arrowRef,style:qt({display:"inline-block"},e.getArrowRotationStyle(this.gpsData,this.lastFix))},"\u2191"))}}],[{key:"getDistance",value:function(t,e){if(null===t||null===e)return"--km";var n=Object(tt.getDistance)({lat:t.coords.latitude,lng:t.coords.longitude},e);return(Math.round(n/100)/10).toString()+"km"}},{key:"getArrowRotationStyle",value:function(t,e){if(null===t||null===e)return Yt(0);var n=Object(tt.getRhumbLineBearing)({lat:t.coords.latitude,lng:t.coords.longitude},e);return Yt(n)}}]),e}(r.a.PureComponent);function Xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function $t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xt(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qt=function(){return r.a.createElement(Ut.a,{component:"div",variant:"head",className:"MuiTableCell-stickyHeader",style:{height:37,display:"flex",alignItems:"center",boxSizing:"border-box"}},r.a.createElement("div",{style:{flex:"1"}},"Name"),r.a.createElement("div",{style:{width:"25%",textAlign:"right"}},"State"),r.a.createElement("div",{style:{width:"27%",textAlign:"right"}},"Country"))},te=function(t){function e(){return Object(I.a)(this,e),Object(jt.a)(this,Object(St.a)(e).apply(this,arguments))}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"render",value:function(){var t=this.props,e=t.fullname,n=t.username,a=t.lastFix,i=t.timestamp,o=t.landed,l=t.iso,c=t.disabled;return r.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",boxSizing:"border-box",filter:c?"grayscale(100%) opacity(30%)":void 0}},r.a.createElement(s.a,{flex:"1",paddingLeft:1,paddingTop:1,paddingBottom:1},r.a.createElement(w.a,{variant:"body2"},e),r.a.createElement(w.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"[",n,"]")),r.a.createElement("div",{style:{width:"25%",textAlign:"right"}},r.a.createElement("div",null,r.a.createElement(w.a,{variant:"caption"},r.a.createElement(Zt,{timestamp:i,landed:o,endOfTrack:o,relative:!0}))),r.a.createElement("div",null,r.a.createElement(w.a,{variant:"caption"},r.a.createElement(Kt,{lastFix:a})))),r.a.createElement("div",{style:{width:"27%",textAlign:"right"}},r.a.createElement(s.a,{paddingRight:1,paddingLeft:1},l,r.a.createElement(s.a,{fontSize:"large",marginLeft:"4px",boxShadow:1,style:{verticalAlign:"middle"},className:"flag-icon flag-icon-"+l.toLowerCase()}))))}}]),e}(r.a.PureComponent),ee=function(t){var e=t.data,n=t.index,a=t.style,i=e.keys[n],o=e.data[i],l=o?o.info.user.fullname:"Offline User",s=o?o.info.user.username:i,c=o?o.lastFix:null,u=o?o.lastFix.timestamp:null,p=o?o.landed:null,f=o?o.info.user.nationality.iso:"--",h=-1!==e.selected.indexOf(i),d=-1!==e.alreadyAdded.indexOf(i);return r.a.createElement(Ut.a,{component:"div",variant:"body",padding:"none",style:$t({},a,{backgroundColor:h&&!d?"rgba(0, 0, 0, 0.04)":void 0}),onClick:function(){d||e.onPilotClicked(i)}},r.a.createElement(te,{fullname:l,username:s,lastFix:c,timestamp:u,landed:p,iso:f,disabled:d}))},ne=n(121),ae=n(108);function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var oe=function(t,e){if(e){var n={lat:e.coords.latitude,lng:e.coords.longitude},a=Object.entries(t).map((function(t){var e=Object(l.a)(t,2),a=e[0],r=e[1];return[a,Object(tt.getDistance)(n,r.lastFix)]}));return a.sort((function(t,e){return t[1]-e[1]})),a.map((function(t){return t[0]}))}var r=Object.keys(t);return r.sort(),r},le=function(t){function e(t){var n;Object(I.a)(this,e),(n=Object(jt.a)(this,Object(St.a)(e).call(this,t))).startRendering=function(){n.setState((function(t){return ie({},t,{didMount:!0})}))},n.updatePilotListIfNecessary=function(){var t=oe(n.state.pilotInfos,n.gpsData);(function(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,a=t.length;n<a;n++)if(t[n]!==e[n])return!1;return!0})(n.state.sortedPilotList,t)||n.setState((function(e){return ie({},e,{sortedPilotList:t})}))},n.onNewGpsData=function(t){n.gpsData=t,n.updatePilotListIfNecessary()},n.onNewPilotInfos=function(t){n.setState((function(e){return ie({},e,{pilotInfos:t,sortedPilotList:oe(t,n.gpsData)})}))},n.onPilotClicked=function(t){n.props.onPilotClicked&&n.props.onPilotClicked(t)},n.state={didMount:!1},n.gpsData=Bt().getData();var a=gt().pilotInfos.getValue();return n.state={pilotInfos:a,sortedPilotList:oe(a,n.gpsData)},n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"componentDidMount",value:function(){gt().pilotInfos.registerCallback(this.onNewPilotInfos),Bt().registerCallback(this.onNewGpsData),setTimeout(this.startRendering)}},{key:"componentWillUnmount",value:function(){gt().pilotInfos.unregisterCallback(this.onNewPilotInfos),Bt().unregisterCallback(this.onNewGpsData)}},{key:"render",value:function(){var t=this;if(!this.state.didMount)return r.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center",overflow:"hidden"}},r.a.createElement(P.a,{disableShrink:!0,style:{margin:"2em"}}));var e=function(t,e,n){var a=function(t){return""===n||t.toLowerCase().includes(n.toLowerCase())},r=t.filter((function(t){return a(e[t].info.user.username)||a(e[t].info.user.fullname)}));return 0===r.length&&!/\s/.test(n)&&n.length>0&&r.push(n),r}(this.state.sortedPilotList,this.state.pilotInfos,this.props.search);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Qt,null),r.a.createElement("div",{style:{flex:"1"}},r.a.createElement(ae.a,null,(function(n){var a=n.height,i=n.width;return r.a.createElement(ne.a,{width:i,height:a,itemCount:e.length,itemSize:57,itemData:{keys:e,data:t.state.pilotInfos,selected:t.props.selected,alreadyAdded:t.props.alreadyAdded,onPilotClicked:t.onPilotClicked},itemKey:function(t,e){return e.keys[t]}},ee)}))))}}]),e}(r.a.PureComponent),se=Object(E.a)({fullHeightWindow:{height:"100%"}}),ce=Object(_t.a)((function(t){var e=se(),n=Object(p.a)(),i=Object(f.a)(n.breakpoints.down("xs")),o=Object(a.useState)([]),c=Object(l.a)(o,2),u=c[0],h=c[1],d=Object(a.useState)(""),g=Object(l.a)(d,2),m=g[0],b=g[1],v=u.length,y=function(){b(""),h([]),t.onClose()};return r.a.createElement(Gt,{open:t.open,onClose:y,fullScreen:i,maxWidth:"xs",fullWidth:!0,classes:{paper:e.fullHeightWindow}},r.a.createElement(Lt.a,{style:0===v?{}:"light"===n.palette.type?{color:n.palette.secondary.main,backgroundColor:Object(Mt.d)(n.palette.secondary.light,.85)}:{color:n.palette.text.primary,backgroundColor:n.palette.secondary.dark}},v>0?r.a.createElement(w.a,{component:"div",color:"inherit",variant:"subtitle1"},v," selected"):r.a.createElement(w.a,{component:"div",variant:"h6",id:"tableTitle"},"Add new pilots:")),r.a.createElement(s.a,{paddingLeft:"1em",paddingRight:"1em",paddingTop:"4px"},r.a.createElement(Nt.a,{margin:"dense",autoComplete:"off",variant:"outlined",id:"search_field",label:"Search",type:"search",fullWidth:!0,onChange:function(t){return b(t.target.value)}})),r.a.createElement(s.a,{flex:"1 1 auto",marginY:"8px",display:"flex",flexDirection:"column",alignItems:"stretch"},r.a.createElement(le,{alreadyAdded:t.alreadyAdded,selected:u,onPilotClicked:function(t){var e=u.indexOf(t),n=[];-1===e?n=n.concat(u,t):0===e?n=n.concat(u.slice(1)):e===u.length-1?n=n.concat(u.slice(0,-1)):e>0&&(n=n.concat(u.slice(0,e),u.slice(e+1))),h(n)},search:m})),r.a.createElement(Ft.a,null,r.a.createElement(Rt.a,{onClick:y,color:"primary"},"Cancel"),r.a.createElement(Rt.a,{disabled:0===v,onClick:function(){t.onAddPilots(u),y()},color:"primary"},"Add")))})),ue=n(241),pe=n(261),fe=n(242),he=n(109),de=n.n(he),ge=n(232),me=n(198);function be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?be(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):be(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ye=Object(ge.a)(w.a)({overflow:"hidden",flex:"1"}),Oe=Object(ge.a)(w.a)({marginRight:".2em",marginLeft:".5em"}),ke=Object(ge.a)(w.a)({display:"flex",justifyContent:"space-between",paddingLeft:".5em"}),Ee=Object(me.a)({root:{paddingLeft:"12px"},content:{overflow:"hidden",alignItems:"center",whiteSpace:"nowrap"}})(ue.a),we=function(t){function e(t){var n;return Object(I.a)(this,e),(n=Object(jt.a)(this,Object(St.a)(e).call(this,t))).extractImportantProps=function(t){return{height:null!==t.gpsAlt?t.gpsAlt:t.baroAlt,elevation:t.elevation,vario:t.baroVario,startOfTrack:t.startOfTrack,endOfTrack:t.endOfTrack,landed:t.landed,newestDataTimestamp:t.newestDataTimestamp,lat:t.pos.lat,lng:t.pos.lng,velocityLat:null===t.velocityVec?null:t.velocityVec.lat,velocityLng:null===t.velocityVec?null:t.velocityVec.lng,velocity:t.velocity}},n.propsChanged=function(t){var e=n.pilotProps;for(var a in e)if(!(a in t))return!0;for(var r in t){if(!(r in e))return!0;if(e[r]!==t[r])return!0}return!1},n.onNewGPSDataReceived=function(t){n.gpsData=t},n.onNewDataReceived=function(t){if(n.props.pilotId in t){var e=t[n.props.pilotId],a=n.extractImportantProps(e);n.propsChanged(a)?(n.pilotProps=a,n.shallowRerender(!0)):n.shallowRerender(!1)}},n.shallowRerender=function(t){if(null!==n.heightRef.current&&t){var a=e.renderHeight(n.pilotProps);a!==n.heightRef.current.innerHTML&&(n.heightRef.current.innerHTML=a)}if(null!==n.lastFixRef.current&&t&&n.lastFixRef.current.setFix({lat:n.pilotProps.lat,lng:n.pilotProps.lng}),null!==n.iconRef.current&&t){var r=n.iconRef.current,i=kt(n.pilotProps.startOfTrack,n.pilotProps.endOfTrack,n.pilotProps.landed,{lat:n.pilotProps.lat,lng:n.pilotProps.lng},{lat:n.pilotProps.velocityLat,lng:n.pilotProps.velocityLng});if(r.childNodes.length>0){var o=r.childNodes[0];o.getAttribute("d")!==i.path&&o.setAttribute("d",i.path)}var l=void 0===i.rotation?0:i.rotation;Object.assign(r.style,Yt(l))}null!==n.liveStateRef.current&&n.liveStateRef.current.shallowRerender({timestamp:1e3*n.pilotProps.newestDataTimestamp,landed:n.pilotProps.landed,endOfTrack:n.pilotProps.endOfTrack,relative:!0,showLastFix:R(M.LOW_LATENCY).getValue()})},n.gpsData=Bt().getData(),n.pilotColor=Ot(n.props.pilotId),n.lastFixRef=r.a.createRef(),n.heightRef=r.a.createRef(),n.liveStateRef=r.a.createRef(),n.iconRef=r.a.createRef(),n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"componentDidMount",value:function(){gt().animation.registerCallback(this.onNewDataReceived),Bt().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function(){gt().animation.unregisterCallback(this.onNewDataReceived),Bt().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function(){var t=gt().animation.getData(),n=this.props.pilotId in t?t[this.props.pilotId]:null;this.pilotProps=this.extractImportantProps(n),console.log("RENDER ",this.props.pilotId,this.state,this.props,this.pilotProps);var a=kt(this.pilotProps.startOfTrack,this.pilotProps.endOfTrack,this.pilotProps.landed,{lat:this.pilotProps.lat,lng:this.pilotProps.lng},{lat:this.pilotProps.velocityLat,lng:this.pilotProps.velocityLng}),i=void 0===a.rotation?0:a.rotation;return r.a.createElement(pe.a,{TransitionProps:{unmountOnExit:!0}},r.a.createElement(Ee,{expandIcon:r.a.createElement(de.a,null)},r.a.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 24 24",display:"block",style:ve({flex:"0 0 auto"},Yt(i)),ref:this.iconRef},r.a.createElement("path",{d:a.path,fill:this.pilotColor,stroke:"black"})),r.a.createElement("div",{style:{flex:"1 1 auto",overflow:"hidden",marginLeft:"10px"}},r.a.createElement("div",{style:{width:"100%",display:"flex",overflow:"hidden"}},r.a.createElement(ye,{variant:"body2"},this.props.pilotName),r.a.createElement(Oe,{variant:"caption"},r.a.createElement(Kt,{ref:this.lastFixRef,lastFix:{lat:this.pilotProps.lat,lng:this.pilotProps.lng}}))),r.a.createElement(ke,{variant:"caption"},r.a.createElement(Zt,{timestamp:1e3*this.pilotProps.newestDataTimestamp,landed:this.pilotProps.landed,endOfTrack:this.pilotProps.endOfTrack,relative:!0,ref:this.liveStateRef,showLastFix:R(M.LOW_LATENCY).getValue()}),r.a.createElement("span",{ref:this.heightRef},e.renderHeight(this.pilotProps))))),r.a.createElement(fe.a,null,r.a.createElement(w.a,null,"TODO: Details")))}}],[{key:"renderHeight",value:function(t){var e=t.height;return Math.round(e)+"m ("+Math.round(Math.max(0,e-t.elevation))+"m)"}}]),e}(r.a.PureComponent);function Pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}var _e=function(t){function e(t){var n;return Object(I.a)(this,e),(n=Object(jt.a)(this,Object(St.a)(e).call(this,t))).getSortedPilotList=function(t){if(null===n.gpsData)return Object.keys(t);var e={lat:n.gpsData.coords.latitude,lng:n.gpsData.coords.longitude},a=Object.entries(t).map((function(t){var n=Object(l.a)(t,2),a=n[0],r=n[1];return[a,Object(tt.getDistance)(e,r.pos)]}));return a.sort((function(t,e){return t[1]-e[1]})),a.map((function(t){return t[0]}))},n.onAnimationFrame=function(t){var e=n.getSortedPilotList(t),a=e.filter((function(e){return t[e].endOfTrack&&t[e].landed})),r=e.filter((function(e){return!(t[e].endOfTrack&&t[e].landed)})).concat(a),i=!1;if(r.length===n.state.onlinePilots.length){for(var o=0;o<r.length;o++)if(r[o]!==n.state.onlinePilots[o]){i=!0;break}}else i=!0;i&&n.setState((function(t){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pe(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pe(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{onlinePilots:r})}))},n.onNewGPSDataReceived=function(t){n.gpsData=t},n.removePilot=function(t){n.props.removePilots([t])},n.state={onlinePilots:[]},n.gpsData=Bt().getData(),n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"componentDidMount",value:function(){gt().animation.registerCallback(this.onAnimationFrame),Bt().registerCallback(this.onNewGPSDataReceived)}},{key:"componentWillUnmount",value:function(){gt().animation.unregisterCallback(this.onAnimationFrame),Bt().unregisterCallback(this.onNewGPSDataReceived)}},{key:"render",value:function(){var t=this,e=new Set(this.state.onlinePilots),n=this.state.onlinePilots.filter((function(e){return e in t.props.pilots})),a=Object.keys(this.props.pilots).filter((function(t){return!e.has(t)})),i=function(e){var n=t.props.pilots[e];return void 0===n||null===n?e:n};return r.a.createElement(s.a,{height:"100%",bgcolor:"#eeeef5",overflow:"auto"},r.a.createElement(s.a,{margin:1},n.map((function(e){return r.a.createElement(we,{key:e,pilotId:e,pilotName:i(e),removePilot:t.removePilot})}))),r.a.createElement(s.a,{margin:1},a.map((function(e){return r.a.createElement(s.a,{key:e,onClick:function(){t.removePilot(e)},display:"flex"},r.a.createElement(w.a,{variant:"body2"},i(e)),r.a.createElement(w.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"[",e,"]"))}))))}}]),e}(r.a.PureComponent);function je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?je(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):je(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ce=function(t){function e(t){var n;return Object(I.a)(this,e),(n=Object(jt.a)(this,Object(St.a)(e).call(this,t))).openPilotSelector=function(){!1===n.state.pilotSelectorOpen&&n.setState((function(t){return Se({},t,{pilotSelectorOpen:!0})}))},n.closePilotSelector=function(){!0===n.state.pilotSelectorOpen&&n.setState((function(t){return Se({},t,{pilotSelectorOpen:!1})}))},n.chosenPilotsChanged=function(t){n.setState((function(e){return Se({},e,{chosenPilots:t})}))},n.state={pilotSelectorOpen:!1,chosenPilots:U()},n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"componentDidMount",value:function(){B().registerCallback(this.chosenPilotsChanged)}},{key:"componentWillUnmount",value:function(){B().unregisterCallback(this.chosenPilotsChanged)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(_e,{pilots:this.state.chosenPilots,removePilots:Z}),r.a.createElement(s.a,{position:"absolute",bottom:"16px",right:"16px"},r.a.createElement(It.a,{size:"small",color:"primary",onClick:this.openPilotSelector},r.a.createElement(xt.a,null))),r.a.createElement(ce,{open:this.state.pilotSelectorOpen,onClose:this.closePilotSelector,onAddPilots:q,alreadyAdded:Object.keys(this.state.chosenPilots)}))}}]),e}(r.a.Component),Te=n(248),Ae=n(200),Ie=n(262),De=n(254),xe=n(118),Le=n.n(xe),Me=n(116),Ne=n.n(Me),Fe=n(115),Re=n.n(Fe),Ve=n(117),We=n.n(Ve),Ge=n(55),He=n.n(Ge),ze=n(259),Be=n(237),Ue=n(245),Ye=n(253),Je=n(246),qe=n(113),Ze=n.n(qe),Ke=n(114),Xe=n.n(Ke),$e=n(252),Qe=n(247),tn=n(263),en=n(244);function nn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function an(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nn(n,!0).forEach((function(e){Object(W.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nn(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var rn=function(t){function e(){var t,n;Object(I.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(jt.a)(this,(t=Object(St.a)(e)).call.apply(t,[this].concat(r)))).state={internalUpdate:!1,value:null},n}return Object(Tt.a)(e,t),Object(D.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement(Nt.a,{onChange:function(e){var n=e.target.value;n<t.props.min?(t.props.onChange(t.props.min),t.setState((function(t){return an({},t,{internalUpdate:!0,value:n})}))):n>t.props.max?t.props.onChange(t.props.max):t.props.onChange(n)},variant:"outlined",disabled:this.props.disabled,margin:"dense",hiddenLabel:!0,type:"number",value:this.state.value,InputProps:{endAdornment:r.a.createElement(en.a,{position:"end"},this.props.unit)},inputProps:{min:this.props.min,max:this.props.max}})}}],[{key:"getDerivedStateFromProps",value:function(t,e){var n=an({},e,{internalUpdate:!1});return e.internalUpdate||(n.value=t.value),n}}]),e}(r.a.PureComponent),on=Object(_t.a)((function(t){var e=R(t.setting).use(),n=Object(l.a)(e,2),a=n[0],i=n[1],o=function(){return i(!a)};return r.a.createElement(Ue.a,{button:!0,onClick:o},r.a.createElement(Je.a,{primary:t.primaryText,secondary:t.secondaryText}),r.a.createElement(Qe.a,null,r.a.createElement(tn.a,{edge:"end",onChange:o,checked:a})))})),ln=Object(_t.a)((function(t){var e=R(t.setting).use(),n=Object(l.a)(e,2),a=n[0],i=n[1];return r.a.createElement(Ue.a,{disabled:t.disabled},r.a.createElement(Je.a,{primary:t.primaryText,secondary:t.secondaryText}),r.a.createElement(Qe.a,null,r.a.createElement(rn,{value:a,onChange:i,disabled:t.disabled,unit:t.unit,min:t.min,max:t.max})))})),sn=n(249),cn=n(250),un=n(251),pn=n(111),fn=n.n(pn),hn=n(112),dn=n.n(hn),gn=Object(_t.a)((function(t){var e=Object(a.useState)(!1),n=Object(l.a)(e,2),i=n[0],o=n[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Te.a,{style:{position:"static"}},r.a.createElement(Lt.a,null,r.a.createElement(Ae.a,{edge:"start",color:"inherit",onClick:t.onClose},r.a.createElement(fn.a,null)),r.a.createElement(s.a,{marginLeft:2,flexGrow:1},r.a.createElement(w.a,{variant:"h6"},"Settings")),r.a.createElement(Ae.a,{edge:"end",color:"inherit",onClick:function(){return o(!0)}},r.a.createElement(dn.a,null)))),r.a.createElement(Gt,{open:i,onClose:function(){return o(!1)}},r.a.createElement(sn.a,null,"Reset all settings?"),r.a.createElement(cn.a,null,r.a.createElement(un.a,null,"This sets all settings to their default values.")),r.a.createElement(Ft.a,null,r.a.createElement(Rt.a,{onClick:function(){Object.values(F).forEach((function(t){return t.setValue(null)})),o(!1)},color:"primary"},"Yes"),r.a.createElement(Rt.a,{onClick:function(){return o(!1)},color:"primary",autoFocus:!0},"No"))))})),mn=function(t){var e=R(M.LIMIT_PATHS).use(),n=Object(l.a)(e,1)[0],a=R(M.FPS_LIMIT).use(),i=Object(l.a)(a,1)[0];return r.a.createElement(Gt,{fullScreen:!0,open:t.open,onClose:t.onClose},r.a.createElement(gn,{onClose:t.onClose}),r.a.createElement(Be.a,null,r.a.createElement(on,{setting:M.LOW_LATENCY,primaryText:"Low Latency Mode",secondaryText:"disables animations"}),r.a.createElement($e.a,null),r.a.createElement(on,{setting:M.LIMIT_PATHS,primaryText:"Limit Track Length",secondaryText:"prevents map clutter"}),r.a.createElement(ln,{primaryText:"Track Length",secondaryText:"Valid: 1-999 min",setting:M.PATH_LENGTH,disabled:!n,unit:"min",min:1,max:999}),r.a.createElement($e.a,null),r.a.createElement(on,{setting:M.FPS_LIMIT,primaryText:"Limit Framerate",secondaryText:"reduces energy consumption"}),r.a.createElement(ln,{primaryText:"Framerate",secondaryText:"Valid: 1-60 fps",setting:M.FPS_RATE,disabled:!i,unit:"fps",min:1,max:60}),r.a.createElement($e.a,null),r.a.createElement(on,{setting:M.GPS_ENABLED,primaryText:"Enable GPS",secondaryText:"required for advanced features"})))},bn=function(t){var e=Object(p.a)(),n=Object(a.useState)(!1),i=Object(l.a)(n,2),o=i[0],c=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ze.a,{disableSwipeToOpen:!0,open:t.open,onOpen:function(){},onClose:t.onClose},r.a.createElement(Lt.a,{style:{backgroundColor:e.palette.primary.light,minWidth:"200px"},onClick:t.onClose},r.a.createElement(s.a,{flexGrow:1,clone:!0},r.a.createElement(w.a,{variant:"h6"},"Menu")),r.a.createElement(Ae.a,{edge:"end",color:"inherit"},r.a.createElement(Ze.a,null))),r.a.createElement(Be.a,null,r.a.createElement(Ue.a,{button:!0,onClick:function(){t.onClose(),c(!0)}},r.a.createElement(Ye.a,null,r.a.createElement(Xe.a,null)),r.a.createElement(Je.a,{primary:"Settings"})))),r.a.createElement(mn,{open:o,onClose:function(){return c(!1)}}))},vn=Object(E.a)((function(t){return{popover:{padding:t.spacing(1),align:"right"}}})),yn=function(t){return r.a.createElement(De.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(P.a,{disableShrink:t.disableShrink,color:"secondary",size:15,thickness:10})},t.children)},On=Object(_t.a)((function(){var t=vn(),e=gt().connectionState.use(),n=r.a.useRef(),i=Object(a.useState)(null),o=Object(l.a)(i,2),c=o[0],u=o[1],p=Object(a.useState)(!1),f=Object(l.a)(p,2),h=f[0],d=f[1];r.a.useLayoutEffect((function(){n.current&&n.current.updatePosition()}),[e,c]);return r.a.createElement("div",null,r.a.createElement(Te.a,{position:"static"},r.a.createElement(Lt.a,null,r.a.createElement(Ae.a,{edge:"start",color:"inherit",onClick:function(){return d(!0)}},r.a.createElement(Le.a,null)),r.a.createElement(s.a,{marginLeft:2,flexGrow:1},r.a.createElement(w.a,{variant:"h6"},"XC Live Viewer")),r.a.createElement(Ae.a,{edge:"end",color:"inherit",onClick:function(t){return u(t.currentTarget)}},function(){switch(e){case ft.ACTIVE:return r.a.createElement(Re.a,null);case ft.CONNECTING:return r.a.createElement(yn,null,r.a.createElement(He.a,null));case ft.ERROR:return r.a.createElement(Ne.a,{color:"error"});case ft.ESTABLISHED:return r.a.createElement(yn,{disableShrink:!0},r.a.createElement(He.a,null));case ft.INACTIVE:return r.a.createElement(We.a,null);case ft.NO_CONNECTION:default:return r.a.createElement(He.a,null)}}()))),r.a.createElement(Ie.a,{open:Boolean(c),anchorEl:c,onClose:function(){return u(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},action:n},r.a.createElement(s.a,{className:t.popover},r.a.createElement(w.a,null,e))),r.a.createElement(bn,{open:h,onClose:function(){return d(!1)}}))})),kn=function(){var t=r.a.useState(1),e=Object(l.a)(t,2),n=e[0],a=e[1],i=r.a.useState(0),o=Object(l.a)(i,2),c=o[0],g=o[1],b=Object(p.a)(),y=Object(f.a)(b.breakpoints.down("sm")),O=function(){g(window.innerHeight)};r.a.useLayoutEffect((function(){return O(),window.addEventListener("resize",O),function(){return window.removeEventListener("resize",O)}}),[]);var k=y?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{flexGrow:1,clone:!0,bgcolor:"blue",display:"flex"},r.a.createElement(u.a,{disabled:!0,index:n},r.a.createElement(s.a,{width:"100%",height:"100%",bgcolor:"red"},r.a.createElement(At,null)),r.a.createElement(s.a,{width:"100%",height:"100%"},r.a.createElement(Ce,null)))),r.a.createElement(s.a,{zIndex:100,boxShadow:3},r.a.createElement(h.a,{value:n,onChange:function(t,e){return a(e)},showLabels:!0},r.a.createElement(d.a,{label:"Map",icon:r.a.createElement(v.a,null)}),r.a.createElement(d.a,{label:"Pilots",icon:r.a.createElement(m.a,null)})))):r.a.createElement(s.a,{width:"100%",flexGrow:1,display:"flex"},r.a.createElement(s.a,{flexGrow:1,height:"100%"},r.a.createElement(At,null)),r.a.createElement(s.a,{width:"450px",height:"100%",zIndex:50,boxShadow:3},r.a.createElement(Ce,null)));return r.a.createElement(s.a,{height:c,display:"flex",flexDirection:"column"},r.a.createElement(s.a,{zIndex:100},r.a.createElement(On,null)),k)},En=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(kn,null))};n(192),n(193),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(194).config(),o.a.render(r.a.createElement(En,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[134,1,2]]]);
//# sourceMappingURL=main.70ad46c4.chunk.js.map