(window["webpackJsonpxc-live-viewer"]=window["webpackJsonpxc-live-viewer"]||[]).push([[0],{112:function(e,t,n){},116:function(e,t,n){},121:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),i=n.n(o),l=n(8),c=n(173),s=n(61),u=n.n(s),m=n(170),d=n(171),f=n(75),g=n.n(f),h=n(74),p=n.n(h),E=n(73),b=n.n(E),v=(n(112),null);var y=function(){var e=Object(a.useState)({ready:!1,error:!1}),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){null===v&&(v=new Promise((function(e,t){console.log("Loading Google Maps API ...");var n=document.createElement("script");n.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBCrP5uoEJXfEvz8f_y1HgzQnqUGHz0Aak",n.async=!0,n.addEventListener("load",(function(){return e(!0)})),n.addEventListener("error",(function(){return e(!1)})),document.body.appendChild(n)}))),v.then((function(e){e?(console.log("Google Maps API loaded."),r({ready:!0,error:!1})):(console.log("Error: Cannot load Google Maps API."),r({ready:!1,error:!0}))}))}),[]),[n.ready,n.error,n.ready?window.google:null]},O=n(153),w=n(156),C=n(155),k=n(63),S=n.n(k),j=Object(O.a)((function(e){return{progress:{margin:e.spacing(2)}}})),I=function(e){var t=e.message,n=e.hideIf,a=e.subRef,o=j();return r.a.createElement(c.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center",ref:a},r.a.createElement(c.a,{textAlign:"center"},r.a.createElement(C.a,{className:o.progress}),r.a.createElement(w.a,null,t)))},T=function(e){var t=e.message,n=e.hideIf,a=j();return r.a.createElement(c.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center"},r.a.createElement(c.a,{textAlign:"center"},r.a.createElement(S.a,{fontSize:"large",color:"error",className:a.progress}),r.a.createElement(w.a,{color:"error"},t)))},N=n(64),x=function(){var e=y(),t=Object(l.a)(e,3),n=t[0],o=t[1],i=t[2],s=Object(a.useRef)(),u=Object(a.useState)(null),m=Object(l.a)(u,2),d=m[0],f=m[1];return Object(a.useLayoutEffect)((function(){n&&!d&&f(new i.maps.Map(s.current,{center:{lat:46.509012,lng:11.827984},mapTypeId:"terrain",zoom:12,disableDefaultUI:!0,scaleControl:!0,fullscreenControl:!0,styles:N}))}),[n,d,i,s]),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{width:"100%",height:"100%",display:n?"block":"none",ref:s}),r.a.createElement(I,{message:"Loading Maps ...",hideIf:n||o}),r.a.createElement(T,{message:"Unable to load map!",hideIf:!o}))},A=n(166),L=n(20),M=n(68),R=n.n(M),W=n(157),z=n(158),P=n(10),F=n(175),B=n(172),D=n(164),G=n(165),J=n(159),_=n(160),H=n(161),V=n(162),U=n(163),Y=n(30),X=n(65);function q(e,t,n){return function(){var r=Object(a.useState)(n),o=Object(l.a)(r,2),i=o[0],c=o[1];return Object(a.useEffect)((function(){var n=e instanceof Function?e():e,a=function(e){c(e)};return n.addListener(t,a),function(){n.removeListener(t,a)}}),[]),i}}var Q=n(23),$=function(){function e(t,n,a){var r=this;Object(Y.a)(this,e),this.onOpen=function(){r.handleReset(),console.log("WebSocket: Open!"),r.setConnectionState(K.ESTABLISHED),r.sock.send(JSON.stringify({tag:"WebFilterArea",area:[{lat:-90,lon:-180},{lat:90,lon:180}]})),r.sock.send(JSON.stringify({tag:"WebFilterContest",contents:"alpha9999"})),r.sock.send(JSON.stringify({tag:"WebFollow",contents:[]}))},this.onMessage=function(e){console.log("WebSocket: Message!"),r.setConnectionState(K.ACTIVE);var t=JSON.parse(e.data);clearTimeout(r.watchdog),r.watchdog=setTimeout((function(){r.setConnectionState(K.INACTIVE)}),7e4),r.processMessage(t)},this.onClose=function(e){console.log("WebSocket: Close!"),r.setConnectionState(K.NO_CONNECTION),setTimeout(r.connect.bind(r),1e3)},this.onError=function(e){console.log("WebSocket: Error!")},this.handleReset=function(){console.log("TODO: handle reset!")},this.processMessage=function(e){if("tag"in e)switch(e.tag){case"LiveFlightInfos":r.dispatchInfoMessage(e.contents);break;case"LiveFlightChunk":r.dispatchTracklogMessage(e);break;default:console.log("Warning: Unknown message tag '".concat(e.tag,"'!"),e)}else console.log("Warning: Invalid message format!",e)},this.setConnectionState=t,this.dispatchInfoMessage=n,this.dispatchTracklogMessage=a,this.connect()}return Object(Q.a)(e,[{key:"connect",value:function(){"WebSocket"in window?(this.setConnectionState(K.CONNECTING),this.sock=new WebSocket("wss://live.xcontest.org/websock/webclient"),this.sock.onopen=this.onOpen,this.sock.onmessage=this.onMessage,this.sock.onclose=this.onClose,this.sock.onerror=this.onError):(this.setConnectionState(K.ERROR),alert("WebSocket NOT supported by your Browser!"))}}]),e}(),K={CONNECTING:"connecting",ERROR:"error",ESTABLISHED:"established",ACTIVE:"active",INACTIVE:"inactive",NO_CONNECTION:"no connection",NO_INFORMATION:"no information"},Z=function e(){var t=this;Object(Y.a)(this,e),this.onConnectionStateChanged=function(e){t.eventEmitter.emit("connectionStateChanged",e)},this.onInfoMessageReceived=function(e){console.log(e),t.pilots=[];var n=!0,a=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var c=o.value,s=Object(l.a)(c,2),u=s[0],m=s[1];m.overriden||(t.pilots.push({user:m.info.user,flightId:u}),t.shortTracks[u]={track:m})}}catch(d){a=!0,r=d}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}t.eventEmitter.emit("pilotStateChanged",t.pilots),t.eventEmitter.emit("shortTracksChanged",t.shortTracks)},this.onTracklogMessageReceived=function(e){console.log("Trackog Message: ",e)},this.pilots=[],this.shortTracks={},this.eventEmitter=new X.EventEmitter,this.socket=new $(this.onConnectionStateChanged,this.onInfoMessageReceived,this.onTracklogMessageReceived)},ee=null,te=function(){return ee||(ee=new Z),ee},ne=q((function(){return te().eventEmitter}),"pilotStateChanged",[]),ae=q((function(){return te().eventEmitter}),"connectionStateChanged",K.NO_INFORMATION),re=(q((function(){return te().eventEmitter}),"shortTracksChanged",{}),[{id:"name",label:"Name",minWidth:0,render:function(e){return r.a.createElement(r.a.Fragment,null,e.user.fullname,r.a.createElement(w.a,{component:"span",variant:"caption",color:"textSecondary",style:{paddingLeft:".3em"}},"[",e.user.username,"]"))}},{id:"country",label:"Country",minWidth:"4em",align:"right",render:function(e){return r.a.createElement(r.a.Fragment,null,e.user.nationality.iso,r.a.createElement(c.a,{fontSize:"large",marginLeft:"4px",boxShadow:1,style:{verticalAlign:"middle"},className:"flag-icon flag-icon-"+e.user.nationality.iso.toLowerCase()}))}}]);var oe=function(e){var t=Object(L.a)(),n=ne(),o=Object(a.useState)([]),i=Object(l.a)(o,2),s=i[0],u=i[1],m=Object(a.useState)(""),d=Object(l.a)(m,2),f=d[0],g=d[1],h=s.length,p=function(){g(""),u([]),e.onClose()},E=Object(W.a)(t.breakpoints.down("xs")),b=function(e){return""===f||e.toLowerCase().includes(f.toLowerCase())},v=n.filter((function(e){return b(e.user.username)||b(e.user.fullname)}));return 0===v.length&&!/\s/.test(f)&&f.length>0&&v.push({user:{login:null,username:f,fullname:"Offline User",gender:"-",nationality:{iso:"--",name:"--"}},flightId:null}),r.a.createElement(F.a,{open:e.open,onClose:p,fullScreen:E},r.a.createElement(z.a,{style:0===h?{}:"light"===t.palette.type?{color:t.palette.secondary.main,backgroundColor:Object(P.d)(t.palette.secondary.light,.85)}:{color:t.palette.text.primary,backgroundColor:t.palette.secondary.dark}},h>0?r.a.createElement(w.a,{component:"div",color:"inherit",variant:"subtitle1"},h," selected"):r.a.createElement(w.a,{component:"div",variant:"h6",id:"tableTitle"},"Add new pilots:")),r.a.createElement(c.a,{paddingLeft:"1em",paddingRight:"1em",paddingTop:"4px"},r.a.createElement(B.a,{autoFocus:!0,margin:"dense",autoComplete:"off",variant:"outlined",id:"search_field",label:"Search",type:"search",fullWidth:!0,onChange:function(e){return g(e.target.value)}})),r.a.createElement(c.a,{flex:"1 1 auto",marginY:"8px",style:{overflowY:"auto"}},r.a.createElement(J.a,{stickyHeader:!0,size:"small"},r.a.createElement(_.a,null,r.a.createElement(H.a,null,re.map((function(e){return r.a.createElement(V.a,{key:e.id,align:e.align,style:{minWidth:e.minWidth},component:"th"},e.label)})))),r.a.createElement(U.a,null,v.map((function(t){var n=function(e){return-1!==s.indexOf(e)}(t.user.username),a=function(t){return-1!==e.alreadyAdded.indexOf(t)}(t.user.username),o=a?{filter:"grayscale(100%) opacity(30%)"}:{},i=re.map((function(e){return r.a.createElement(V.a,{key:e.id,align:e.align},r.a.createElement(c.a,{style:o},e.render(t)))}));return a?r.a.createElement(H.a,{key:t.user.username},i):r.a.createElement(H.a,{key:t.user.username,selected:n,onClick:function(e){return function(e,t){var n=s.indexOf(t),a=[];-1===n?a=a.concat(s,t):0===n?a=a.concat(s.slice(1)):n===s.length-1?a=a.concat(s.slice(0,-1)):n>0&&(a=a.concat(s.slice(0,n),s.slice(n+1))),u(a)}(0,t.user.username)}},i)}))))),r.a.createElement(D.a,null,r.a.createElement(G.a,{onClick:p,color:"primary"},"Cancel"),r.a.createElement(G.a,{disabled:0===h,onClick:function(){e.onAddPilots(s),p()},color:"primary"},"Add")))},ie=n(11),le=n(66);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(n,!0).forEach((function(t){Object(ie.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=Object(le.a)("chosen-pilots");var me=function(){var e=Object(L.a)(),t=Object(a.useState)(!1),n=Object(l.a)(t,2),o=n[0],i=n[1],s=function(){var e=ue({}),t=Object(l.a)(e,2),n=t[0],a=t[1];return[n,function(e){var t=se({},n),r=!1,o=!0,i=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;u in t||(t[u]=null,r=!0)}}catch(m){i=!0,l=m}finally{try{o||null==s.return||s.return()}finally{if(i)throw l}}r&&a(t)},function(e){var t=se({},n),r=!1,o=!0,i=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;u in t&&(delete t[u],r=!0)}}catch(m){i=!0,l=m}finally{try{o||null==s.return||s.return()}finally{if(i)throw l}}r&&a(t)}]}(),u=Object(l.a)(s,3),m=u[0],d=u[1],f=u[2],g=Object.entries(m).map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1],o=a;return null===a&&(o=n),r.a.createElement(c.a,{key:n,onClick:function(){return f([n])}},o)}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{height:"100%",style:{overflowY:"auto"}},g),r.a.createElement(c.a,{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},r.a.createElement(A.a,{size:"small",color:"primary",onClick:function(){return i(!0)}},r.a.createElement(R.a,null))),r.a.createElement(oe,{open:o,onClose:function(){return i(!1)},onAddPilots:d,alreadyAdded:Object.keys(m)}))},de=n(168),fe=n(169),ge=n(177),he=n(167),pe=n(72),Ee=n.n(pe),be=n(70),ve=n.n(be),ye=n(69),Oe=n.n(ye),we=n(71),Ce=n.n(we),ke=n(34),Se=n.n(ke),je=Object(O.a)((function(e){return{menuButton:{marginRight:e.spacing(2)},popover:{padding:e.spacing(1),align:"right"}}})),Ie=function(e){return r.a.createElement(he.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(C.a,{disableShrink:e.disableShrink,color:"secondary",size:15,thickness:10})},e.children)},Te=function(){var e=je(),t=ae(),n=Object(a.useState)(null),o=Object(l.a)(n,2),i=o[0],s=o[1];return r.a.createElement("div",null,r.a.createElement(de.a,{position:"static"},r.a.createElement(z.a,null,r.a.createElement(c.a,{clone:!0},r.a.createElement(fe.a,{className:e.menuButton,edge:"start",color:"inherit"},r.a.createElement(Ee.a,null))),r.a.createElement(c.a,{flexGrow:1,clone:!0},r.a.createElement(w.a,{variant:"h6"},"XC Live Viewer")),r.a.createElement(fe.a,{edge:"end",color:"inherit",onClick:function(e){return s(e.currentTarget)}},function(){switch(t){case K.ACTIVE:return r.a.createElement(Oe.a,null);case K.CONNECTING:return r.a.createElement(Ie,null,r.a.createElement(Se.a,null));case K.ERROR:return r.a.createElement(ve.a,{color:"error"});case K.ESTABLISHED:return r.a.createElement(Ie,{disableShrink:!0},r.a.createElement(Se.a,null));case K.INACTIVE:return r.a.createElement(Ce.a,null);case K.NO_CONNECTION:default:return r.a.createElement(Se.a,null)}}()))),r.a.createElement(ge.a,{open:Boolean(i),anchorEl:i,onClose:function(){return s(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement(c.a,{className:e.popover},r.a.createElement(w.a,null,t))))};function Ne(){var e=r.a.useState(1),t=Object(l.a)(e,2),n=t[0],a=t[1],o=r.a.useState(0),i=Object(l.a)(o,2),s=i[0],f=i[1],h=function(){f(window.innerHeight)};r.a.useLayoutEffect((function(){return h(),window.addEventListener("resize",h),function(){return window.removeEventListener("resize",h)}}),[]);return r.a.createElement(c.a,{height:s,display:"flex",flexDirection:"column"},r.a.createElement(c.a,{zIndex:100},r.a.createElement(Te,null)),r.a.createElement(c.a,{flexGrow:1,clone:!0},r.a.createElement(u.a,{disabled:!0,index:n},r.a.createElement(c.a,{width:"100%",height:"100%",position:"relative"},r.a.createElement(x,null)),r.a.createElement(c.a,{width:"100%",height:"100%",position:"relative"},r.a.createElement(me,null)),r.a.createElement(c.a,{width:"100%",height:"100%",position:"relative"},"Item Three"))),r.a.createElement(c.a,{zIndex:100,boxShadow:3},r.a.createElement(m.a,{value:n,onChange:function(e,t){return a(t)},showLabels:!0},r.a.createElement(d.a,{label:"Map",icon:r.a.createElement(b.a,null)}),r.a.createElement(d.a,{label:"Pilots",icon:r.a.createElement(p.a,null)}),r.a.createElement(d.a,{label:"Nearby",icon:r.a.createElement(g.a,null)}))))}var xe=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Ne,null))};n(116),n(117),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(118).config(),i.a.render(r.a.createElement(xe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},64:function(e){e.exports=JSON.parse('[{"featureType":"all","stylers":[{"visibility":"simplified"}]},{"featureType":"administrative.land_parcel","stylers":[{"visibility":"off"}]},{"featureType":"administrative.neighborhood","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text","stylers":[{"visibility":"off"}]}]')},85:function(e,t,n){e.exports=n(121)}},[[85,1,2]]]);
//# sourceMappingURL=main.3fe22a0b.chunk.js.map