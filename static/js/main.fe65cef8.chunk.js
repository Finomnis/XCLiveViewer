(window["webpackJsonpxc-live-viewer"]=window["webpackJsonpxc-live-viewer"]||[]).push([[0],{118:function(e,t,n){e.exports=n(174)},145:function(e,t,n){},169:function(e,t,n){},174:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(9),l=n.n(i),o=n(7),s=n(237),c=n(86),u=n.n(c),f=n(234),h=n(235),d=n(103),g=n.n(d),m=n(102),p=n.n(m),b=n(101),v=n.n(b),y=(n(145),null);var E=function(){var e=Object(a.useState)({ready:!1,error:!1}),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){null===y&&(y=new Promise((function(e,t){console.log("Loading Google Maps API ...");var n=document.createElement("script");n.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBCrP5uoEJXfEvz8f_y1HgzQnqUGHz0Aak",n.async=!0,n.addEventListener("load",(function(){return e(!0)})),n.addEventListener("error",(function(){return e(!1)})),document.body.appendChild(n)}))),y.then((function(e){e?(console.log("Google Maps API loaded."),r({ready:!0,error:!1})):(console.log("Error: Cannot load Google Maps API."),r({ready:!1,error:!0}))}))}),[]),[n.ready,n.error,n.ready?window.google:null]},O=n(206),k=n(40),_=n(208),w=n(88),A=n.n(w),S=Object(O.a)((function(e){return{progress:{margin:e.spacing(2)}}})),C=function(e){var t=e.message,n=e.hideIf,a=e.subRef,i=S();return r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center",ref:a},r.a.createElement(s.a,{textAlign:"center"},r.a.createElement(_.a,{className:i.progress}),r.a.createElement(k.a,null,t)))},j=function(e){var t=e.message,n=e.hideIf,a=S();return r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"none":"flex",alignItems:"center",justifyContent:"center"},r.a.createElement(s.a,{textAlign:"center"},r.a.createElement(A.a,{fontSize:"large",color:"error",className:a.progress}),r.a.createElement(k.a,{color:"error"},t)))},I=n(89),T=n(10),P=n(15),L=function e(t,n){var r=this;Object(T.a)(this,e),this.getValue=function(){var e=JSON.parse(localStorage.getItem(r.key));return null===e?r.initialValue:e},this._notifyAll=function(){var e=r.getValue(),t=!0,n=!1,a=void 0;try{for(var i,l=r.callbacks[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){(0,i.value)(e)}}catch(o){n=!0,a=o}finally{try{t||null==l.return||l.return()}finally{if(n)throw a}}},this.registerCallback=function(e){r.callbacks.includes(e)||r.callbacks.push(e)},this.unregisterCallback=function(e){var t=r.callbacks.indexOf(e);t>=0&&r.callbacks.splice(t,1)},this.setValue=function(e){null==e?localStorage.removeItem(r.key):localStorage.setItem(r.key,JSON.stringify(e)),r._notifyAll()},this.use=function(){var e=Object(a.useState)(r.getValue),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(a.useEffect)((function(){var e=function(e){i(e)};return r.registerCallback(e),function(){return r.unregisterCallback(e)}}),[]),[n,r.setValue]},this.key=t,this.initialValue=n,this.callbacks=[]},D=function(e,t){return new L(e,t)},N={PATH_LENGTH:"PATH_LENGTH",LIMIT_PATHS:"LIMIT_PATHS",LOW_LATENCY:"LOW_LATENCY",ANIMATION_DELAY:"ANIMATION_DELAY",FPS_LIMIT:"FPS_LIMIT",FPS_RATE:"FPS_RATE"},F=function(e,t){return D("SETTINGS_"+e,t)},x={PATH_LENGTH:F(N.PATH_LENGTH,15),LIMIT_PATHS:F(N.LIMIT_PATHS,!0),LOW_LATENCY:F(N.LOW_LATENCY,!1),ANIMATION_DELAY:F(N.ANIMATION_DELAY,80),FPS_LIMIT:F(N.FPS_LIMIT,!0),FPS_RATE:F(N.FPS_RATE,10)},M=function(e){return x[e]},V=function(){function e(t,n,a,r){var i=this;Object(T.a)(this,e),this.formatSubscribedFlights=function(){var e=M(N.PATH_LENGTH).getValue(),t=M(N.LIMIT_PATHS).getValue(),n=null;if(t){var a=new Date(Date.now()-6e4*e);a.setMilliseconds(0),n=a.toISOString()}return i.subscribedFlights.map((function(e){return{flightUuid:e,start:n}}))},this.refreshSubscribedFlights=function(){i.sock.readyState===WebSocket.OPEN&&i.connected&&i.sock.send(JSON.stringify({tag:"WebFollow",contents:i.formatSubscribedFlights()}))},this.setSubscribedFlights=function(e){i.subscribedFlights=e,i.refreshSubscribedFlights()},this.onOpen=function(){i.handleReset(),console.debug("WebSocket: Open!"),i.setConnectionState(ne.ESTABLISHED),i.connected=!0,i.sock.send(JSON.stringify({tag:"WebFilterArea",area:[{lat:-90,lon:-180},{lat:90,lon:180}]})),i.sock.send(JSON.stringify({tag:"WebFilterContest",contents:"alpha9999"})),i.sock.send(JSON.stringify({tag:"WebFollow",contents:i.formatSubscribedFlights()}))},this.onMessage=function(e){console.debug("WebSocket: Message!"),i.setConnectionState(ne.ACTIVE);var t=JSON.parse(e.data);clearTimeout(i.watchdog),i.watchdog=setTimeout((function(){i.setConnectionState(ne.INACTIVE)}),7e4),i.processMessage(t)},this.onClose=function(e){i.connected=!1,console.debug("WebSocket: Close!"),i.setConnectionState(ne.NO_CONNECTION),setTimeout(i.connect.bind(i),1e3)},this.onError=function(e){i.connected=!1,console.debug("WebSocket: Error!")},this.handleReset=function(){console.log("TODO: handle reset!")},this.processMessage=function(e){if("tag"in e)switch(e.tag){case"LiveFlightInfos":i.dispatchInfoMessage(e.contents);break;case"LiveFlightChunk":i.dispatchTracklogMessage(e);break;case"LiveFlightLanded":i.dispatchFlightLandedMessage(e.flightUuid);break;default:console.warn("Warning: Unknown message tag '".concat(e.tag,"'!"),e)}else console.warn("Warning: Invalid message format!",e)},this.setConnectionState=t,this.dispatchInfoMessage=n,this.dispatchTracklogMessage=a,this.dispatchFlightLandedMessage=r,this.subscribedFlights=[],this.connect(),this.connected=!1,M(N.PATH_LENGTH).registerCallback(this.refreshSubscribedFlights),M(N.LIMIT_PATHS).registerCallback(this.refreshSubscribedFlights)}return Object(P.a)(e,[{key:"connect",value:function(){"WebSocket"in window?(this.connected=!1,this.setConnectionState(ne.CONNECTING),this.sock=new WebSocket("wss://live.xcontest.org/websock/webclient"),this.sock.onopen=this.onOpen,this.sock.onmessage=this.onMessage,this.sock.onclose=this.onClose,this.sock.onerror=this.onError):(this.setConnectionState(ne.ERROR),alert("WebSocket NOT supported by your Browser!"))}}]),e}(),R=n(11);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=D("chosen-pilots",{});var G=function(e,t,n){return null===t?e:null===e?t:(1-n)*e+n*t},U=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return t-e},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return null===e};Object(T.a)(this,e),this.computeDiff=n,this.isInvalid=a,this.old_val=null,this.old_t=null,this.running_avg=null,this.smoothingFactor=t}return Object(P.a)(e,[{key:"update",value:function(e,t){if(null===this.old_val||null===e||null===this.old_t||null===t||this.isInvalid(this.old_val)||this.isInvalid(e)||this.old_t===this.new_t)return this.old_val=e,this.old_t=t,null;var n=t-this.old_t,a=this.computeDiff(this.old_val,e)/n,r=Math.pow(this.smoothingFactor,n);return null===this.running_avg?this.running_avg=a:this.running_avg=r*this.running_avg+(1-r)*a,this.old_val=e,this.old_t=t,this.running_avg}},{key:"reset",value:function(){this.old_val=null,this.old_t=null,this.running_avg=null}}]),e}(),Y=n(66),B=function(e,t,n){if(t<1)return 0;for(var a=-1,r=t,i=0;a<r-1;)n(i=(a+r)/2|0)<e?a=i:r=i;return r},J=function(e){return Math.round(Date.parse(e)/1e3)},q=function(){function e(){var t=this;Object(T.a)(this,e),this.at=function(e){return t.data[e]},this.findBisect=function(e){return B(e,t.data.length,(function(e){return t.data[e].t}))},this.findForwardSwipe=function(e,n){for(var a=n;a<t.data.length&&t.data[a].t<e;)a+=1;return a},this.data=[],this.counter_gpsVario=new U(.7),this.counter_baroVarion=new U(.7),this.counter_velocity=new U(.7,(function(e,t){return Object(Y.getDistance)(e,t,.01)}),(function(){return!1}))}return Object(P.a)(e,[{key:"clear",value:function(){this.data=[],this.counter_gpsVario=new U(.7),this.counter_baroVarion=new U(.7),this.counter_velocity=new U(.7,(function(e,t){return Object(Y.getDistance)(e,t,.01)}),(function(){return!1}))}},{key:"isAfterLastElement",value:function(e){return this.data.length<=0||this.data[this.data.length-1].t<e}},{key:"append",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var l=r.value,o=J(l.timestamp),s={lat:l.lat,lng:l.lon},c=0===l.baroAlt?null:l.baroAlt,u=0===l.gpsAlt?null:l.gpsAlt,f=this.counter_gpsVario.update(u,o),h=this.counter_baroVarion.update(c,o),d=this.counter_velocity.update(s,o),g={baroAlt:c,gpsAlt:u,elevation:l.elevation,pos:s,gpsVario:f,baroVario:h,velocity:d,t:o};this.data.push(g)}}catch(m){n=!0,a=m}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}},{key:"replace",value:function(e){this.clear(),this.append(e)}},{key:"insert",value:function(e){var t=[],n=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var o=i.value,s=J(o.timestamp),c={lat:o.lat,lng:o.lon},u={baroAlt:0===o.baroAlt?null:o.baroAlt,gpsAlt:0===o.gpsAlt?null:o.gpsAlt,elevation:o.elevation,pos:c,gpsVario:null,baroVario:null,velocity:null,t:s};t.push(u)}}catch(A){a=!0,r=A}finally{try{n||null==l.return||l.return()}finally{if(a)throw r}}var f=this.data;this.data=[];for(var h=0,d=0;!(h>=f.length&&d>=t.length);)if(h>=f.length)this.data.push(t[d]),d+=1;else if(d>=t.length)this.data.push(f[h]),h+=1;else{var g=f[h],m=t[d];m.t<g.t?(this.data.push(m),d+=1):g.t<m.t?(this.data.push(g),h+=1):(this.data.push(m),h+=1,d+=1)}this.counter_gpsVario.reset(),this.counter_baroVarion.reset(),this.counter_velocity.reset();var p=!0,b=!1,v=void 0;try{for(var y,E=this.data[Symbol.iterator]();!(p=(y=E.next()).done);p=!0){var O=y.value,k=this.counter_gpsVario.update(O.gpsAlt,O.t),_=this.counter_baroVarion.update(O.baroAlt,O.t),w=this.counter_velocity.update(O.pos,O.t);O.gpsVario=k,O.baroVario=_,O.velocity=w}}catch(A){b=!0,v=A}finally{try{p||null==E.return||E.return()}finally{if(b)throw v}}}},{key:"length",get:function(){return this.data.length}}]),e}();function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Q=function e(){var t=this;Object(T.a)(this,e),this.reset=function(){t.currentArrayPos=null,t.mapsPath=[]},this.currentArrayPos=null,this.mapsPath=[]},Z=function(){function e(){Object(T.a)(this,e)}return Object(P.a)(e,null,[{key:"takeData",value:function(e){return{baroAlt:e.baroAlt,gpsAlt:e.gpsAlt,elevation:e.elevation,pos:{lat:e.pos.lat,lng:e.pos.lng},gpsVario:e.gpsVario,baroVario:e.baroVario,velocity:e.velocity}}},{key:"blendData",value:function(e,t,n){return{baroAlt:G(e.baroAlt,t.baroAlt,n),gpsAlt:G(e.gpsAlt,t.gpsAlt,n),elevation:G(e.elevation,t.elevation,n),pos:{lat:G(e.pos.lat,t.pos.lat,n),lng:G(e.pos.lng,t.pos.lng,n)},gpsVario:G(e.gpsVario,t.gpsVario,n),baroVario:G(e.baroVario,t.baroVario,n),velocity:G(e.velocity,t.velocity,n)}}},{key:"blendDataSpline",value:function(e,t,n,a,r){return null}}]),e}();Z.fallbackData=function(e){return{baroAlt:e.lastFix.baroAlt,gpsAlt:e.lastFix.gpsAlt,elevation:e.lastFix.elevation,pos:{lat:e.lastFix.lat,lng:e.lastFix.lon},gpsVario:null,baroVario:null,velocity:null}};var $=function e(t){var n=this;Object(T.a)(this,e),this.updateInfos=function(e){n.landed|=e.landed,n.flightInfos=e,n.flightInfoData.replace(e.track),n.flightInfoDataCache.reset()},this.updateData=function(e){if(!(e.length<1)){var t=J(e[0].timestamp);n.liveData.isAfterLastElement(t)?n.liveData.append(e):(n.liveData.insert(e),n.liveDataCache.reset())}},this.updateLanded=function(){console.log("Received flight landed message!"),n.landed=!0},this.getInterpolatedData=function(e,t,n){if(e.length<1)return null;null===t.currentArrayPos?t.currentArrayPos=e.findBisect(n):t.currentArrayPos=e.findForwardSwipe(n,t.currentArrayPos);var a=null,r=!1,i=!1;if(t.currentArrayPos<=0)a=Z.takeData(e.at(0)),i=!0;else if(t.currentArrayPos>=e.length)a=Z.takeData(e.at(e.length-1)),r=!0;else{var l=e.at(t.currentArrayPos-1),o=e.at(t.currentArrayPos),s=(n-l.t)/(o.t-l.t);a=Z.blendData(l,o,s)}return[a,i,r]},this.getFallbackData=function(){return[Z.fallbackData(n.flightInfos),!1,n.flightInfos.landed]},this.updateAnimation=function(e,t){var a=e/1e3,r=n.getInterpolatedData(n.liveData,n.liveDataCache,a);r||(r=n.getInterpolatedData(n.flightInfoData,n.flightInfoDataCache,a)),r||(r=n.getFallbackData());var i=r,l=Object(o.a)(i,3);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},l[0],{startOfTrack:l[1],endOfTrack:l[2],landed:n.landed})},this.liveData=new q,this.liveDataCache=new Q,this.flightInfos=null,this.flightInfoData=new q,this.flightInfoDataCache=new Q,this.landed=t.landed,this.updateInfos(t)},K=function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;Object(T.a)(this,e),this.get=function(e,n){var a=e+t.offset,r=a-n;return(r>t.tolerance||r<-t.tolerance)&&(t.offset-=r,a=e+t.offset),a},this.offset=0,this.tolerance=n};var ee=function e(t){var n=this;Object(T.a)(this,e),this._nextUpdate=Date.now(),this.animationLoop=function(){var e=Date.now(),t=1e3/n._setting_fps;if(!n._setting_limitFps||e>=n._nextUpdate){n._nextUpdate=n._nextUpdate+t,n._nextUpdate<e&&(n._nextUpdate=e);var a=e-1e3*n._setting_timeOffset,r={};Object.keys(n._subscribedPilots).forEach((function(e){if(e in n._pilotInfos){var t=n._pilotInfos[e].flightId;if(t in n._flightAnimations){var i=n._flightAnimations[t];r[e]=i.updateAnimation(a,n._setting_lowLatencyMode)}}})),n._submitAnimationFrame(r)}requestAnimationFrame(n.animationLoop)},this._submitAnimationFrame=function(e){n._currentAnimationData=e;var t=!0,a=!1,r=void 0;try{for(var i,l=n._callbacks[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){(0,i.value)(e)}}catch(o){a=!0,r=o}finally{try{t||null==l.return||l.return()}finally{if(a)throw r}}},this.setSubscribedPilots=function(e){n._subscribedPilots=e,n._updateImportantFlights()},this.pushNewInfo=function(e){console.log("newInfo: ",e),n._pilotInfos=e,n._updateImportantFlights(),Object.values(e).forEach((function(e){var t=e.flightId;t in n._flightAnimations&&n._flightAnimations[t].updateInfos(e)}))},this.pushNewData=function(e,t){console.log("newTrackdata: ",e,t),e in n._flightAnimations&&n._flightAnimations[e].updateData(t)},this.pushFlightLanded=function(e){e in n._flightAnimations&&n._flightAnimations[e].updateLanded()},this.registerCallback=function(e){n._callbacks.includes(e)||n._callbacks.push(e)},this.unregisterCallback=function(e){var t=n._callbacks.indexOf(e);t>=0&&n._callbacks.splice(t,1)},this.useAnimatedData=function(){var e=Object(a.useState)(n._currentAnimationData),t=Object(o.a)(e,2),r=t[0],i=t[1];return Object(a.useEffect)((function(){var e=function(e){i(e)};return n.registerCallback(e),function(){return n.unregisterCallback(e)}}),[]),r},this._updateImportantFlights=function(){var e={};Object.values(n._pilotInfos).filter((function(e){return e.info.user.username in n._subscribedPilots})).forEach((function(t){e[t.flightId]=t}));var t=new Set(Object.keys(e)),a=[];for(var r in n._flightAnimations)r in e||a.push(r);for(var i=0,l=a;i<l.length;i++){var s=l[i];console.log("Removing flightAnimation of '"+s+"' ..."),delete n._flightAnimations[s]}Object.entries(e).forEach((function(e){var t=Object(o.a)(e,2),a=t[0],r=t[1];a in n._flightAnimations||(n._flightAnimations[a]=new $(r))})),function(e,t){if(e.size!==t.size)return!1;var n=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var o=i.value;if(!t.has(o))return!1}}catch(s){a=!0,r=s}finally{try{n||null==l.return||l.return()}finally{if(a)throw r}}return!0}(t,n._subscribedFlights)||(console.log("Changing flight subscribtion: ",n._subscribedFlights,t),n._setSubscribedFlightsCallback(t))},this._currentAnimationData={},this._callbacks=[],this._subscribedPilots=z.getValue(),this._subscribedFlights=new Set,this._pilotInfos={},this._flightAnimations={},this._highPrecisionTimeSync=new K;var r=M(N.ANIMATION_DELAY),i=M(N.LOW_LATENCY),l=M(N.FPS_LIMIT),s=M(N.FPS_RATE);this._setting_timeOffset=r.getValue(),this._setting_lowLatencyMode=i.getValue(),this._setting_limitFps=l.getValue(),this._setting_fps=s.getValue(),r.registerCallback((function(e){n._setting_timeOffset=e})),i.registerCallback((function(e){n._setting_lowLatencyMode=e})),l.registerCallback((function(e){n._setting_limitFps=e})),s.registerCallback((function(e){n._setting_fps=e})),this._setSubscribedFlightsCallback=function(e){n._subscribedFlights=e,t(Array.from(e))},z.registerCallback(this.setSubscribedPilots),requestAnimationFrame(this.animationLoop)},te=function e(t){var n=this;Object(T.a)(this,e),this.set=function(e){n._callbackData=e;var t=!0,a=!1,r=void 0;try{for(var i,l=n._callbacks[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){(0,i.value)(e)}}catch(o){a=!0,r=o}finally{try{t||null==l.return||l.return()}finally{if(a)throw r}}},this.getValue=function(){return n._callbackData},this.registerCallback=function(e){n._callbacks.includes(e)||n._callbacks.push(e)},this.unregisterCallback=function(e){var t=n._callbacks.indexOf(e);t>=0&&n._callbacks.splice(t,1)},this.use=function(){var e=Object(a.useState)(n._callbackData),t=Object(o.a)(e,2),r=t[0],i=t[1];return Object(a.useEffect)((function(){return n.registerCallback(i),function(){return n.unregisterCallback(i)}}),[]),r},this._callbacks=[],this._callbackData=t},ne={CONNECTING:"connecting",ERROR:"error",ESTABLISHED:"established",ACTIVE:"active",INACTIVE:"inactive",NO_CONNECTION:"no connection",NO_INFORMATION:"no information"},ae=function e(){var t=this;Object(T.a)(this,e),this.setSubscribedFlights=function(e){t.socket.setSubscribedFlights(e)},this.getPilotInfos=function(){return t.pilots},this.onConnectionStateChanged=function(e){t.connectionState.set(e)},this.onInfoMessageReceived=function(e){t.pilots={};var n=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value,c=Object(o.a)(s,2),u=c[0],f=c[1];f.overriden||(f.flightId=u,t.pilots[f.info.user.username]=f)}}catch(h){a=!0,r=h}finally{try{n||null==l.return||l.return()}finally{if(a)throw r}}t.animation.pushNewInfo(t.pilots),t.pilotInfos.set(t.pilots)},this.onTracklogMessageReceived=function(e){t.animation.pushNewData(e.flightUuid,e.trackChunk)},this.onFlightLandedMessageReceived=function(e){t.animation.pushFlightLanded(e)},this.pilots=[],this.connectionState=new te(ne.NO_INFORMATION),this.pilotInfos=new te([]),this.socket=new V(this.onConnectionStateChanged,this.onInfoMessageReceived,this.onTracklogMessageReceived,this.onFlightLandedMessageReceived),this.animation=new ee(this.setSubscribedFlights)},re=null,ie=function(){return re||(re=new ae),re},le=function e(t,n,a,r){var i=this;Object(T.a)(this,e),this.setMap=function(e){i.marker.setMap(e)},this.updateData=function(e){i.marker.setPosition(e.pos)},this.google=t,this.marker=new this.google.maps.Marker({map:n,position:r.pos,title:a.info.user.fullname})},oe=function e(t,n){var a=this;Object(T.a)(this,e),this.cleanupOldTracks=function(e){var t=[];for(var n in a.tracks)n in e||t.push(n);for(var r=0,i=t;r<i.length;r++){var l=i[r];a.tracks[l].setMap(null),delete a.tracks[l]}},this.update=function(e){var t=ie().getPilotInfos();a.cleanupOldTracks(e),Object.entries(e).forEach((function(e){var n=Object(o.a)(e,2),r=n[0],i=n[1];if(r in t){var l=t[r];r in a.tracks||(a.tracks[r]=new le(a.google,a.map,l,i)),a.tracks[r].updateData(i)}}))},this.map=t,this.google=n,this.tracks={}},se=function(){var e=E(),t=Object(o.a)(e,3),n=t[0],i=t[1],l=t[2],c=Object(a.useRef)(),u=Object(a.useState)(null),f=Object(o.a)(u,2),h=f[0],d=f[1];return Object(a.useLayoutEffect)((function(){n&&!h&&d(new l.maps.Map(c.current,{center:{lat:46.509012,lng:11.827984},mapTypeId:"terrain",zoom:12,maxZoom:15,disableDefaultUI:!0,scaleControl:!0,fullscreenControl:!0,styles:I}))}),[n,h,l,c]),Object(a.useEffect)((function(){if(h&&l){var e=new oe(h,l).update;return ie().animation.registerCallback(e),function(){ie().animation.unregisterCallback(e)}}}),[h,l]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{width:"100%",height:"100%",display:n?"block":"none",ref:c}),r.a.createElement(C,{message:"Loading Maps ...",hideIf:n||i}),r.a.createElement(j,{message:"Unable to load map!",hideIf:!i}))},ce=n(221),ue=n(19),fe=n(90),he=n.n(fe),de=n(209),ge=n(211),me=n(12),pe=n(210),be=n(236),ve=n(218),ye=n(219),Ee=n(213),Oe=n(214),ke=n(215),_e=n(216),we=n(217);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=function(e){return r.a.createElement("span",null,"1.7km ",r.a.createElement("div",{style:Se({display:"inline-block"},{transform:"rotate(-90deg)",webkitTransform:"rotate(-90deg)","-moz-transform":"rotate(-90deg)","-ms-transform":"rotate(-90deg)","-o-transform":"rotate(-90deg)"})},"\u2191"))},je=function(e){var t=e.timestamp,n=e.landed,a=e.relative;if(null==t)return r.a.createElement("span",null,"never");var i=Date.parse(t)-Date.now(),l="";return l=a?function(e){var t="";e<0&&(e=-e,t="-");var n=Math.floor(e/1e3);if(n<60)return t+n+" sec";var a=Math.floor(n/60);if(a<60)return t+a+" min";var r=Math.floor(a/60);if(a-=60*r,r<24)return t+r+":"+a.toString().padStart(2,"0")+" h";var i=Math.floor(r/24);return t+i+"d "+(r-=24*i)+":"+a.toString().padStart(2,"0")+" h"}(i):function(e){return new Date(e).toLocaleTimeString()}(t),n?r.a.createElement("span",{style:{color:"#346B8F"}},"\u2714 ",l):-i<12e4?a?r.a.createElement("span",{style:{color:"green"}},r.a.createElement("span",{role:"img","aria-hidden":!0},"\u26ab")," ","LIVE"):r.a.createElement("span",{style:{color:"green"}},r.a.createElement("span",{role:"img","aria-hidden":!0},"\u26ab")," ",l):a?r.a.createElement("span",{style:{color:"red"}},"! LIVE (",l,")"):r.a.createElement("span",{style:{color:"red"}},"! ",l)},Ie=[{id:"name",label:"Name",render:function(e){return r.a.createElement(s.a,{paddingLeft:1,paddingTop:1,paddingBottom:1},r.a.createElement(k.a,{variant:"body2"},e.info.user.fullname),r.a.createElement(k.a,{variant:"caption",color:"textSecondary",style:{paddingLeft:".5em"}},"[",e.info.user.username,"]"))}},{id:"state",label:"State",align:"right",render:function(e){return r.a.createElement(s.a,null,r.a.createElement(s.a,null,r.a.createElement(k.a,{variant:"caption"},r.a.createElement(je,{timestamp:e.lastFix.timestamp,landed:e.landed,relative:!0}))),r.a.createElement(s.a,null,r.a.createElement(k.a,{variant:"caption"},r.a.createElement(Ce,null))))}},{id:"country",label:"Country",align:"right",render:function(e){return r.a.createElement(s.a,{paddingRight:1,paddingLeft:1},e.info.user.nationality.iso,r.a.createElement(s.a,{fontSize:"large",marginLeft:"4px",boxShadow:1,style:{verticalAlign:"middle"},className:"flag-icon flag-icon-"+e.info.user.nationality.iso.toLowerCase()}))}}];var Te=function(e){var t=Object(ue.a)(),n=ie().pilotInfos.use(),i=Object(a.useState)([]),l=Object(o.a)(i,2),c=l[0],u=l[1],f=Object(a.useState)(""),h=Object(o.a)(f,2),d=h[0],g=h[1],m=c.length,p=function(){g(""),u([]),e.onClose()},b=Object(de.a)(t.breakpoints.down("xs")),v=function(e){return""===d||e.toLowerCase().includes(d.toLowerCase())},y=Object.values(n).filter((function(e){return v(e.info.user.username)||v(e.info.user.fullname)}));return 0===y.length&&!/\s/.test(d)&&d.length>0&&y.push({info:{user:{login:null,username:d,fullname:"Offline User",gender:"-",nationality:{iso:"--",name:"--"}},flightId:null}}),r.a.createElement(pe.a,{open:e.open,onClose:p,fullScreen:b},r.a.createElement(ge.a,{style:0===m?{}:"light"===t.palette.type?{color:t.palette.secondary.main,backgroundColor:Object(me.d)(t.palette.secondary.light,.85)}:{color:t.palette.text.primary,backgroundColor:t.palette.secondary.dark}},m>0?r.a.createElement(k.a,{component:"div",color:"inherit",variant:"subtitle1"},m," selected"):r.a.createElement(k.a,{component:"div",variant:"h6",id:"tableTitle"},"Add new pilots:")),r.a.createElement(s.a,{paddingLeft:"1em",paddingRight:"1em",paddingTop:"4px"},r.a.createElement(be.a,{margin:"dense",autoComplete:"off",variant:"outlined",id:"search_field",label:"Search",type:"search",fullWidth:!0,onChange:function(e){return g(e.target.value)}})),r.a.createElement(s.a,{flex:"1 1 auto",marginY:"8px",style:{overflowY:"auto"}},r.a.createElement(Ee.a,{stickyHeader:!0,size:"small"},r.a.createElement(Oe.a,null,r.a.createElement(ke.a,null,Ie.map((function(e){return r.a.createElement(_e.a,{key:e.id,align:e.align,style:{width:e.width},component:"th"},e.label)})))),r.a.createElement(we.a,null,y.map((function(t){var n=t.info.user.username,a=function(e){return-1!==c.indexOf(e)}(n),i=function(t){return-1!==e.alreadyAdded.indexOf(t)}(n),l=i?{filter:"grayscale(100%) opacity(30%)"}:{},o=Ie.map((function(e){return r.a.createElement(_e.a,{key:e.id,align:e.align,padding:"none"},r.a.createElement(s.a,{style:l},e.render(t)))}));return i?r.a.createElement(ke.a,{key:n},o):r.a.createElement(ke.a,{key:n,selected:a,onClick:function(e){return function(e,t){var n=c.indexOf(t),a=[];-1===n?a=a.concat(c,t):0===n?a=a.concat(c.slice(1)):n===c.length-1?a=a.concat(c.slice(0,-1)):n>0&&(a=a.concat(c.slice(0,n),c.slice(n+1))),u(a)}(0,n)}},o)}))))),r.a.createElement(ve.a,null,r.a.createElement(ye.a,{onClick:p,color:"primary"},"Cancel"),r.a.createElement(ye.a,{disabled:0===m,onClick:function(){e.onAddPilots(c),p()},color:"primary"},"Add")))},Pe=function(e){var t=ie().animation.useAnimatedData(),n=Object.entries(e.pilots).map((function(n){var a=Object(o.a)(n,2),i=a[0],l=a[1],c=l;null===l&&(c=i);var u=[];if(i in t){var f=t[i];for(var h in f)u.push(r.a.createElement("tr",{key:h},r.a.createElement("td",null,h),r.a.createElement("td",null,(Math.round(100*f[h])/100).toString())))}return r.a.createElement(s.a,{margin:"10px",key:i,onClick:function(){return e.removePilots([i])}},c,r.a.createElement("table",null,r.a.createElement("tbody",null,u)))}));return r.a.createElement(s.a,{height:"100%",style:{overflowY:"auto"}},n)},Le=function(){var e=Object(ue.a)(),t=Object(a.useState)(!1),n=Object(o.a)(t,2),i=n[0],l=n[1],c=function(){var e=z.use(),t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,function(e){var t=W({},n),r=!1,i=!0,l=!1,o=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;u in t||(t[u]=null,r=!0)}}catch(f){l=!0,o=f}finally{try{i||null==c.return||c.return()}finally{if(l)throw o}}r&&a(t)},function(e){var t=W({},n),r=!1,i=!0,l=!1,o=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;u in t&&(delete t[u],r=!0)}}catch(f){l=!0,o=f}finally{try{i||null==c.return||c.return()}finally{if(l)throw o}}r&&a(t)}]}(),u=Object(o.a)(c,3),f=u[0],h=u[1],d=u[2];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe,{pilots:f,removePilots:d}),r.a.createElement(s.a,{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},r.a.createElement(ce.a,{size:"small",color:"primary",onClick:function(){return l(!0)}},r.a.createElement(he.a,null))),r.a.createElement(Te,{open:i,onClose:function(){return l(!1)},onAddPilots:h,alreadyAdded:Object.keys(f)}))},De=n(223),Ne=n(224),Fe=n(239),xe=n(233),Me=n(100),Ve=n.n(Me),Re=n(98),He=n.n(Re),We=n(97),ze=n.n(We),Ge=n(99),Ue=n.n(Ge),Ye=n(45),Be=n.n(Ye),Je=n(238),qe=n(212),Xe=n(228),Qe=n(232),Ze=n(229),$e=n(95),Ke=n.n($e),et=n(96),tt=n.n(et),nt=n(225),at=n(226),rt=n(227),it=n(230),lt=n(240),ot=n(231),st=n(94),ct=n.n(st),ut=n(93),ft=n.n(ut),ht=n(91),dt=n(92),gt=n(104),mt=n(222);function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(n,!0).forEach((function(t){Object(R.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vt=function(e){function t(){var e,n;Object(T.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={internalUpdate:!1,value:null},n}return Object(gt.a)(t,e),Object(P.a)(t,[{key:"render",value:function(){var e=this;return console.log(localStorage),r.a.createElement(be.a,{onChange:function(t){var n=t.target.value;n<e.props.min?(e.props.onChange(e.props.min),e.setState(bt({},e.state,{internalUpdate:!0,value:n}))):n>e.props.max?e.props.onChange(e.props.max):e.props.onChange(n)},variant:"outlined",disabled:this.props.disabled,margin:"dense",hiddenLabel:!0,type:"number",value:this.state.value,InputProps:{endAdornment:r.a.createElement(mt.a,{position:"end"},this.props.unit)},inputProps:{min:this.props.min,max:this.props.max}})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=bt({},t,{internalUpdate:!1});return t.internalUpdate||(n.value=e.value),n}}]),t}(a.Component),yt=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),i=n[0],l=n[1],c=M(N.PATH_LENGTH).use(),u=Object(o.a)(c,2),f=u[0],h=u[1],d=M(N.LIMIT_PATHS).use(),g=Object(o.a)(d,2),m=g[0],p=g[1],b=M(N.LOW_LATENCY).use(),v=Object(o.a)(b,2),y=v[0],E=v[1],O=M(N.ANIMATION_DELAY).use(),_=Object(o.a)(O,2),w=_[0],A=_[1],S=M(N.FPS_LIMIT).use(),C=Object(o.a)(S,2),j=C[0],I=C[1],T=M(N.FPS_RATE).use(),P=Object(o.a)(T,2),L=P[0],D=P[1],F=function(){return p(!m)},V=function(){return E(!y)},R=function(){return I(!j)};return r.a.createElement(pe.a,{fullScreen:!0,open:e.open,onClose:e.onClose},r.a.createElement(De.a,{style:{position:"static"}},r.a.createElement(ge.a,null,r.a.createElement(Ne.a,{edge:"start",color:"inherit",onClick:e.onClose},r.a.createElement(ft.a,null)),r.a.createElement(s.a,{marginLeft:2,flexGrow:1},r.a.createElement(k.a,{variant:"h6"},"Settings")),r.a.createElement(Ne.a,{edge:"end",color:"inherit",onClick:function(){return l(!0)}},r.a.createElement(ct.a,null)))),r.a.createElement(pe.a,{open:i,onClose:function(){return l(!1)}},r.a.createElement(nt.a,null,"Reset all settings?"),r.a.createElement(at.a,null,r.a.createElement(rt.a,null,"This sets all settings to their default values.")),r.a.createElement(ve.a,null,r.a.createElement(ye.a,{onClick:function(){Object.values(x).forEach((function(e){return e.setValue(null)})),l(!1)},color:"primary"},"Yes"),r.a.createElement(ye.a,{onClick:function(){return l(!1)},color:"primary",autoFocus:!0},"No"))),r.a.createElement(qe.a,null,r.a.createElement(Xe.a,{button:!0,onClick:R},r.a.createElement(Ze.a,{primary:"Limit Framerate",secondary:"reduces energy consumption"}),r.a.createElement(it.a,null,r.a.createElement(lt.a,{edge:"end",onChange:R,checked:j}))),r.a.createElement(Xe.a,{disabled:!j},r.a.createElement(Ze.a,{primary:"Framerate",secondary:"Valid: 1-60 fps"}),r.a.createElement(it.a,null,r.a.createElement(vt,{value:L,onChange:D,disabled:!j,unit:"fps",min:1,max:60}))),r.a.createElement(ot.a,null),r.a.createElement(Xe.a,{button:!0,onClick:F},r.a.createElement(Ze.a,{primary:"Limit Track Length",secondary:"reduces data consumption"}),r.a.createElement(it.a,null,r.a.createElement(lt.a,{edge:"end",onChange:F,checked:m}))),r.a.createElement(Xe.a,{disabled:!m},r.a.createElement(Ze.a,{primary:"Track Length",secondary:"Valid: 1-999 min"}),r.a.createElement(it.a,null,r.a.createElement(vt,{disabled:!m,value:f,onChange:h,unit:"min",min:1,max:999}))),r.a.createElement(ot.a,null),r.a.createElement(Xe.a,{button:!0,onClick:V},r.a.createElement(Ze.a,{primary:"Low Latency Mode",secondary:"disables animations"}),r.a.createElement(it.a,null,r.a.createElement(lt.a,{edge:"end",onChange:V,checked:y}))),r.a.createElement(Xe.a,{disabled:y},r.a.createElement(Ze.a,{primary:"Animation Delay",secondary:"70-120 sec (default: 80)"}),r.a.createElement(it.a,null,r.a.createElement(vt,{disabled:y,value:w,onChange:A,unit:"sec",min:70,max:120})))))},Et=function(e){var t=Object(ue.a)(),n=Object(a.useState)(!1),i=Object(o.a)(n,2),l=i[0],c=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Je.a,{disableSwipeToOpen:!0,open:e.open,onOpen:function(){},onClose:e.onClose},r.a.createElement(ge.a,{style:{backgroundColor:t.palette.primary.light,minWidth:"200px"},onClick:e.onClose},r.a.createElement(s.a,{flexGrow:1,clone:!0},r.a.createElement(k.a,{variant:"h6"},"Menu")),r.a.createElement(Ne.a,{edge:"end",color:"inherit"},r.a.createElement(Ke.a,null))),r.a.createElement(qe.a,null,r.a.createElement(Xe.a,{button:!0,onClick:function(){e.onClose(),c(!0)}},r.a.createElement(Qe.a,null,r.a.createElement(tt.a,null)),r.a.createElement(Ze.a,{primary:"Settings"})))),r.a.createElement(yt,{open:l,onClose:function(){return c(!1)}}))},Ot=Object(O.a)((function(e){return{popover:{padding:e.spacing(1),align:"right"}}})),kt=function(e){return r.a.createElement(xe.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(_.a,{disableShrink:e.disableShrink,color:"secondary",size:15,thickness:10})},e.children)},_t=function(){var e=Ot(),t=ie().connectionState.use(),n=r.a.useRef(),i=Object(a.useState)(null),l=Object(o.a)(i,2),c=l[0],u=l[1],f=Object(a.useState)(!1),h=Object(o.a)(f,2),d=h[0],g=h[1];r.a.useLayoutEffect((function(){n.current&&n.current.updatePosition()}),[t,c]);return r.a.createElement("div",null,r.a.createElement(De.a,{position:"static"},r.a.createElement(ge.a,null,r.a.createElement(Ne.a,{edge:"start",color:"inherit",onClick:function(){return g(!0)}},r.a.createElement(Ve.a,null)),r.a.createElement(s.a,{marginLeft:2,flexGrow:1},r.a.createElement(k.a,{variant:"h6"},"XC Live Viewer")),r.a.createElement(Ne.a,{edge:"end",color:"inherit",onClick:function(e){return u(e.currentTarget)}},function(){switch(t){case ne.ACTIVE:return r.a.createElement(ze.a,null);case ne.CONNECTING:return r.a.createElement(kt,null,r.a.createElement(Be.a,null));case ne.ERROR:return r.a.createElement(He.a,{color:"error"});case ne.ESTABLISHED:return r.a.createElement(kt,{disableShrink:!0},r.a.createElement(Be.a,null));case ne.INACTIVE:return r.a.createElement(Ue.a,null);case ne.NO_CONNECTION:default:return r.a.createElement(Be.a,null)}}()))),r.a.createElement(Fe.a,{open:Boolean(c),anchorEl:c,onClose:function(){return u(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},action:n},r.a.createElement(s.a,{className:e.popover},r.a.createElement(k.a,null,t))),r.a.createElement(Et,{open:d,onClose:function(){return g(!1)}}))},wt=function(){var e=r.a.useState(1),t=Object(o.a)(e,2),n=t[0],a=t[1],i=r.a.useState(0),l=Object(o.a)(i,2),c=l[0],d=l[1],m=function(){d(window.innerHeight)};r.a.useLayoutEffect((function(){return m(),window.addEventListener("resize",m),function(){return window.removeEventListener("resize",m)}}),[]);return r.a.createElement(s.a,{height:c,display:"flex",flexDirection:"column"},r.a.createElement(s.a,{zIndex:100},r.a.createElement(_t,null)),r.a.createElement(s.a,{flexGrow:1,clone:!0},r.a.createElement(u.a,{disabled:!0,index:n},r.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},r.a.createElement(se,null)),r.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},r.a.createElement(Le,null)),r.a.createElement(s.a,{width:"100%",height:"100%",position:"relative"},"Item Three"))),r.a.createElement(s.a,{zIndex:100,boxShadow:3},r.a.createElement(f.a,{value:n,onChange:function(e,t){return a(t)},showLabels:!0},r.a.createElement(h.a,{label:"Map",icon:r.a.createElement(v.a,null)}),r.a.createElement(h.a,{label:"Pilots",icon:r.a.createElement(p.a,null)}),r.a.createElement(h.a,{label:"Nearby",icon:r.a.createElement(g.a,null)}))))},At=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(wt,null))};n(169),n(170),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(171).config(),l.a.render(r.a.createElement(At,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},89:function(e){e.exports=JSON.parse('[{"featureType":"all","stylers":[{"visibility":"simplified"}]},{"featureType":"administrative.land_parcel","stylers":[{"visibility":"off"}]},{"featureType":"administrative.neighborhood","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels.text","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text","stylers":[{"visibility":"off"}]}]')}},[[118,1,2]]]);
//# sourceMappingURL=main.fe65cef8.chunk.js.map